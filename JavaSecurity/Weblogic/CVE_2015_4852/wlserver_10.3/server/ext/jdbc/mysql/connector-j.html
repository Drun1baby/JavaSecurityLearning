<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>MySQL Connector/J</title><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><meta name="description" content="
        This manual describes MySQL Connector/J, the JDBC implementation
        for communicating with MySQL servers.
       
        Document generated on:

        2011-07-01



        (revision: 26690)
      "><script language="javascript" type="text/javascript">
    function datecheck() {
        var base = new Date(1309539040*1000);
        var now = new Date();
        var diff = ((now-base)/1000)/(24*3600);

        if (diff > 90) {
            var nodes = document.getElementsByClassName('titlepage');
            nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
                'This copy of the manual is more than 90 days old. We encourage you to download a ' +
                'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
        }
}
</script>
<noscript></noscript>
</head><body onLoad="datecheck();"  bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="connectors"></a>MySQL Connector/J</h1></div><div><div class="legalnotice"><a name="legalnotice"></a><p>
    Copyright © 1997, 2011, Oracle and/or its affiliates. All
    rights reserved.
  </p><p>
    This software and related documentation are provided under a license
    agreement containing restrictions on use and disclosure and are
    protected by intellectual property laws. Except as expressly
    permitted in your license agreement or allowed by law, you may not
    use, copy, reproduce, translate, broadcast, modify, license,
    transmit, distribute, exhibit, perform, publish, or display any
    part, in any form, or by any means. Reverse engineering,
    disassembly, or decompilation of this software, unless required by
    law for interoperability, is prohibited.
  </p><p>
    The information contained herein is subject to change without notice
    and is not warranted to be error-free. If you find any errors,
    please report them to us in writing.
  </p><p>
    If this software or related documentation is delivered to the U.S.
    Government or anyone licensing it on behalf of the U.S. Government,
    the following notice is applicable:
  </p><p>
    U.S. GOVERNMENT RIGHTS Programs, software, databases, and related
    documentation and technical data delivered to U.S. Government
    customers are "commercial computer software" or "commercial
    technical data" pursuant to the applicable Federal Acquisition
    Regulation and agency-specific supplemental regulations. As such,
    the use, duplication, disclosure, modification, and adaptation shall
    be subject to the restrictions and license terms set forth in the
    applicable Government contract, and, to the extent applicable by the
    terms of the Government contract, the additional rights set forth in
    FAR 52.227-19, Commercial Computer Software License (December 2007).
    Oracle USA, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
  </p><p>
    This software is developed for general use in a variety of
    information management applications. It is not developed or intended
    for use in any inherently dangerous applications, including
    applications which may create a risk of personal injury. If you use
    this software in dangerous applications, then you shall be
    responsible to take all appropriate fail-safe, backup, redundancy,
    and other measures to ensure the safe use of this software. Oracle
    Corporation and its affiliates disclaim any liability for any
    damages caused by use of this software in dangerous applications.
  </p><p>
    Oracle is a registered trademark of Oracle Corporation and/or its
    affiliates. MySQL is a trademark of Oracle Corporation and/or its
    affiliates, and shall not be used without Oracle's express written
    authorization. Other names may be trademarks of their respective
    owners.
  </p><p>
    This software and documentation may provide access to or information
    on content, products, and services from third parties. Oracle
    Corporation and its affiliates are not responsible for and expressly
    disclaim all warranties of any kind with respect to third-party
    content, products, and services. Oracle Corporation and its
    affiliates will not be responsible for any loss, costs, or damages
    incurred due to your access to or use of third-party content,
    products, or services.
  </p><p>
    This document in any form, software or printed matter, contains
    proprietary information that is the exclusive property of Oracle.
    Your access to and use of this material is subject to the terms and
    conditions of your Oracle Software License and Service Agreement,
    which has been executed and with which you agree to comply. This
    document and information contained herein may not be disclosed,
    copied, reproduced, or distributed to anyone outside Oracle without
    prior written consent of Oracle or as specifically provided below.
    This document is not part of your license agreement nor can it be
    incorporated into any contractual agreement with Oracle or its
    subsidiaries or affiliates.
  </p><p>
    This documentation is NOT distributed under a GPL license. Use of
    this documentation is subject to the following terms:
  </p><p>
    You may create a printed copy of this documentation solely for your
    own personal use. Conversion to other formats is allowed as long as
    the actual content is not altered or edited in any way. You shall
    not publish or distribute this documentation in any form or on any
    media, except if you distribute the documentation in a manner
    similar to how Oracle disseminates it (that is, electronically for
    download on a Web site with the software) or on a CD-ROM or similar
    medium, provided however that the documentation is disseminated
    together with the software on the same medium. Any other use, such
    as any dissemination of printed copies or use of this documentation,
    in whole or in part, in another publication, requires the prior
    written consent from an authorized representative of Oracle. Oracle
    and/or its affiliates reserve any and all rights to this
    documentation not expressly granted above.
  </p><p>
    For more information on the terms of this license, for details on
    how the MySQL documentation is built and produced, or if you are
    interested in doing a translation, please visit
    <a href="http://dev.mysql.com/contact/" target="_top">MySQL Contact &amp;
    Questions</a>.
  </p><p>
    For additional licensing information, including licenses for
    third-party libraries used by MySQL products, see
    <a href="http://dev.mysql.com/doc/refman/5.5/en/preface.html" target="_top">Preface and Notes</a>.
  </p><p>
    If you want help with using MySQL, please visit either the
    <a href="http://forums.mysql.com" target="_top">MySQL Forums</a> or
    <a href="http://lists.mysql.com" target="_top">MySQL Mailing Lists</a>
    where you can discuss your issues with other MySQL users.
  </p><p>
    For additional documentation on MySQL products, including
    translations of the documentation into other languages, and
    downloadable versions in variety of formats, including HTML and PDF
    formats, see the <a href="http://dev.mysql.com/doc" target="_top">MySQL
    Documentation Library</a>.
  </p></div></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
        This manual describes MySQL Connector/J, the JDBC implementation
        for communicating with MySQL servers.
      </p><p>
        Document generated on:

        2011-07-01



        (revision: 26690)
      </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="preface"><a href="#connector-j">MySQL Connector/J</a></span></dt><dt><span class="chapter"><a href="#connector-j-versions">1. Connector/J Versions</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-versions-java">1.1. Java Versions Supported</a></span></dt></dl></dd><dt><span class="chapter"><a href="#connector-j-installing">2. Connector/J Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-binary-installation">2.1. Installing Connector/J from a Binary Distribution</a></span></dt><dt><span class="section"><a href="#connector-j-installing-classpath">2.2. Installing the Driver and Configuring the <code class="literal">CLASSPATH</code></a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading">2.3. Upgrading from an Older Version</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-installing-upgrading-3-0-to-3-1">2.3.1. Upgrading from MySQL Connector/J 3.0 to 3.1</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-5-1">2.3.2. Upgrading to MySQL Connector/J 5.1.x</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-issues">2.3.3. JDBC-Specific Issues When Upgrading to MySQL Server 4.1 or Newer</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-installing-source">2.4. Installing from the Development Source Tree</a></span></dt></dl></dd><dt><span class="chapter"><a href="#connector-j-examples">3. Connector/J Examples</a></span></dt><dt><span class="chapter"><a href="#connector-j-reference">4. Connector/J (JDBC) Reference</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-reference-configuration-properties">4.1. Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J</a></span></dt><dt><span class="section"><a href="#connector-j-reference-implementation-notes">4.2. JDBC API Implementation Notes</a></span></dt><dt><span class="section"><a href="#connector-j-reference-type-conversions">4.3. Java, JDBC and MySQL Types</a></span></dt><dt><span class="section"><a href="#connector-j-reference-charsets">4.4. Using Character Sets and Unicode</a></span></dt><dt><span class="section"><a href="#connector-j-reference-using-ssl">4.5. Connecting Securely Using SSL</a></span></dt><dt><span class="section"><a href="#connector-j-reference-replication-connection">4.6. Using Master/Slave Replication with ReplicationConnection</a></span></dt><dt><span class="section"><a href="#connector-j-reference-error-sqlstates">4.7. Mapping MySQL Error Numbers to SQLStates</a></span></dt></dl></dd><dt><span class="chapter"><a href="#connector-j-usagenotes">5. Connector/J Notes and Tips</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-usagenotes-basic">5.1. Basic JDBC Concepts</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-usagenotes-connect-drivermanager">5.1.1. Connecting to MySQL Using the <code class="literal">DriverManager</code> Interface</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements">5.1.2. Using Statements to Execute SQL</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements-callable">5.1.3. Using <code class="literal">CallableStatements</code> to Execute Stored Procedures</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-last-insert-id">5.1.4. Retrieving <code class="literal">AUTO_INCREMENT</code> Column Values</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-usagenotes-j2ee">5.2. Using Connector/J with J2EE and Other Java Frameworks</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts">5.2.1. General J2EE Concepts</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-tomcat">5.2.2. Using Connector/J with Tomcat</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-jboss">5.2.3. Using Connector/J with JBoss</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-spring-config">5.2.4. Using Connector/J with Spring</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-glassfish-config">5.2.5. Using Connector/J with GlassFish</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-usagenotes-troubleshooting">5.3. Connector/J: Common Problems and Solutions</a></span></dt></dl></dd><dt><span class="chapter"><a href="#connector-j-support">6. Connector/J Support</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-support-community">6.1. Connector/J Community Support</a></span></dt><dt><span class="section"><a href="#connector-j-support-bug-report">6.2. How to Report Connector/J Bugs or Problems</a></span></dt><dt><span class="section"><a href="#connector-j-support-changelog">6.3. Connector/J Change History</a></span></dt></dl></dd><dt><span class="appendix"><a href="#cj-news">A. MySQL Connector/J Change History</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-5-1">A.1. Changes in MySQL Connector/J 5.1.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-5-1-15">A.1.1. Changes in MySQL Connector/J 5.1.15 (09 February 2011)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-14">A.1.2. Changes in MySQL Connector/J 5.1.14 (6th December 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-13">A.1.3. Changes in MySQL Connector/J 5.1.13 (24 June 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-12">A.1.4. Changes in MySQL Connector/J 5.1.12 (18 February 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-11">A.1.5. Changes in MySQL Connector/J 5.1.11 (21 January 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-10">A.1.6. Changes in MySQL Connector/J 5.1.10 (23 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-9">A.1.7. Changes in MySQL Connector/J 5.1.9 (21 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-8">A.1.8. Changes in MySQL Connector/J 5.1.8 (16 July 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-7">A.1.9. Changes in MySQL Connector/J 5.1.7 (21 October 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-6">A.1.10. Changes in MySQL Connector/J 5.1.6 (07 March 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-5">A.1.11. Changes in MySQL Connector/J 5.1.5 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-4">A.1.12. Changes in MySQL Connector/J 5.1.4 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-3">A.1.13. Changes in MySQL Connector/J 5.1.3 (10 September 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-2">A.1.14. Changes in MySQL Connector/J 5.1.2 (29 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-1">A.1.15. Changes in MySQL Connector/J 5.1.1 (22 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-0">A.1.16. Changes in MySQL Connector/J 5.1.0 (11 April 2007)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-5-0">A.2. Changes in MySQL Connector/J 5.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-5-0-8">A.2.1. Changes in MySQL Connector/J 5.0.8 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-7">A.2.2. Changes in MySQL Connector/J 5.0.7 (20 July 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-6">A.2.3. Changes in MySQL Connector/J 5.0.6 (15 May 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-5">A.2.4. Changes in MySQL Connector/J 5.0.5 (02 March 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-4">A.2.5. Changes in MySQL Connector/J 5.0.4 (20 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-3">A.2.6. Changes in MySQL Connector/J 5.0.3 (26 July 2006 beta)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-2">A.2.7. Changes in MySQL Connector/J 5.0.2 (11 July 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-1">A.2.8. Changes in MySQL Connector/J 5.0.1 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-0">A.2.9. Changes in MySQL Connector/J 5.0.0 (22 December 2005)</a></span></dt></dl></dd><dt><span class="section"><a href="#cg-news-3-1">A.3. Changes in MySQL Connector/J 3.1.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-3-1-15">A.3.1. Changes in MySQL Connector/J 3.1.15 (Not yet released)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-14">A.3.2. Changes in MySQL Connector/J 3.1.14 (19 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-13">A.3.3. Changes in MySQL Connector/J 3.1.13 (26 May 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-12">A.3.4. Changes in MySQL Connector/J 3.1.12 (30 November 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-11">A.3.5. Changes in MySQL Connector/J 3.1.11 (07 October 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-10">A.3.6. Changes in MySQL Connector/J 3.1.10 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-9">A.3.7. Changes in MySQL Connector/J 3.1.9 (22 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-8">A.3.8. Changes in MySQL Connector/J 3.1.8 (14 April 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-7">A.3.9. Changes in MySQL Connector/J 3.1.7 (18 February 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-6">A.3.10. Changes in MySQL Connector/J 3.1.6 (23 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-5">A.3.11. Changes in MySQL Connector/J 3.1.5 (02 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-4">A.3.12. Changes in MySQL Connector/J 3.1.4 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-3">A.3.13. Changes in MySQL Connector/J 3.1.3 (07 July 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-2">A.3.14. Changes in MySQL Connector/J 3.1.2 (09 June 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-1">A.3.15. Changes in MySQL Connector/J 3.1.1 (14 February 2004 alpha)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-0">A.3.16. Changes in MySQL Connector/J 3.1.0 (18 February 2003 alpha)</a></span></dt></dl></dd><dt><span class="section"><a href="#cg-news-3-0">A.4. Changes in MySQL Connector/J 3.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-3-0-17">A.4.1. Changes in MySQL Connector/J 3.0.17 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-16">A.4.2. Changes in MySQL Connector/J 3.0.16 (15 November 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-15">A.4.3. Changes in MySQL Connector/J 3.0.15 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-14">A.4.4. Changes in MySQL Connector/J 3.0.14 (28 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-13">A.4.5. Changes in MySQL Connector/J 3.0.13 (27 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-12">A.4.6. Changes in MySQL Connector/J 3.0.12 (18 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-11">A.4.7. Changes in MySQL Connector/J 3.0.11 (19 February 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-10">A.4.8. Changes in MySQL Connector/J 3.0.10 (13 January 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-9">A.4.9. Changes in MySQL Connector/J 3.0.9 (07 October 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-8">A.4.10. Changes in MySQL Connector/J 3.0.8 (23 May 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-7">A.4.11. Changes in MySQL Connector/J 3.0.7 (08 April 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-6">A.4.12. Changes in MySQL Connector/J 3.0.6 (18 February 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-5">A.4.13. Changes in MySQL Connector/J 3.0.5 (22 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-4">A.4.14. Changes in MySQL Connector/J 3.0.4 (06 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-3">A.4.15. Changes in MySQL Connector/J 3.0.3 (17 December 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-2">A.4.16. Changes in MySQL Connector/J 3.0.2 (08 November 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-1">A.4.17. Changes in MySQL Connector/J 3.0.1 (21 September 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-0">A.4.18. Changes in MySQL Connector/J 3.0.0 (31 July 2002)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-2-0">A.5. Changes in MySQL Connector/J 2.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-2-0-14">A.5.1. Changes in MySQL Connector/J 2.0.14 (16 May 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-13">A.5.2. Changes in MySQL Connector/J 2.0.13 (24 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-12">A.5.3. Changes in MySQL Connector/J 2.0.12 (07 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-11">A.5.4. Changes in MySQL Connector/J 2.0.11 (27 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-10">A.5.5. Changes in MySQL Connector/J 2.0.10 (24 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-9">A.5.6. Changes in MySQL Connector/J 2.0.9 (13 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-8">A.5.7. Changes in MySQL Connector/J 2.0.8 (25 November 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-7">A.5.8. Changes in MySQL Connector/J 2.0.7 (24 October 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-6">A.5.9. Changes in MySQL Connector/J 2.0.6 (16 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-5">A.5.10. Changes in MySQL Connector/J 2.0.5 (13 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-3">A.5.11. Changes in MySQL Connector/J 2.0.3 (03 December 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-1">A.5.12. Changes in MySQL Connector/J 2.0.1 (06 April 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre5">A.5.13. Changes in MySQL Connector/J 2.0.0pre5 (21 February 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre4">A.5.14. Changes in MySQL Connector/J 2.0.0pre4 (10 January 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre">A.5.15. Changes in MySQL Connector/J 2.0.0pre (17 August 1999)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-1-2b">A.6. Changes in MySQL Connector/J 1.2b (04 July 1999)</a></span></dt><dt><span class="section"><a href="#cg-news-1-0">A.7. Changes in MySQL Connector/J 1.2.x and lower</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-1-2a">A.7.1. Changes in MySQL Connector/J 1.2a (14 April 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1i">A.7.2. Changes in MySQL Connector/J 1.1i (24 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1h">A.7.3. Changes in MySQL Connector/J 1.1h (08 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1g">A.7.4. Changes in MySQL Connector/J 1.1g (19 February 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1f">A.7.5. Changes in MySQL Connector/J 1.1f (31 December 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1b">A.7.6. Changes in MySQL Connector/J 1.1b (03 November 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1">A.7.7. Changes in MySQL Connector/J 1.1 (02 September 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-0">A.7.8. Changes in MySQL Connector/J 1.0 (24 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9d">A.7.9. Changes in MySQL Connector/J 0.9d (04 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9">A.7.10. Changes in MySQL Connector/J 0.9 (28 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-8">A.7.11. Changes in MySQL Connector/J 0.8 (06 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-7">A.7.12. Changes in MySQL Connector/J 0.7 (01 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-6">A.7.13. Changes in MySQL Connector/J 0.6 (21 May 1998)</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="#connector-j-third-party-licenses">B. Licenses for Third-Party Components</a></span></dt><dd><dl><dt><span class="section"><a href="#license-ant-contrib">B.1. Ant-Contrib License</a></span></dt><dt><span class="section"><a href="#license-slf4j">B.2. Simple Logging Facade for Java (SLF4J) License</a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>4.1. <a href="#id238201">Mapping of MySQL Error Numbers to SQLStates</a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>5.1. <a href="#connector-j-examples-connection-drivermanager">Connector/J: Obtaining a connection from the
            <code class="literal">DriverManager</code></a></dt><dt>5.2. <a href="#connector-j-examples-execute-select">Connector/J: Using java.sql.Statement to execute a
            <code class="literal">SELECT</code> query</a></dt><dt>5.3. <a href="#connector-j-examples-stored-procedure">Connector/J: Calling Stored Procedures</a></dt><dt>5.4. <a href="#connector-j-examples-preparecall">Connector/J: Using <code class="literal">Connection.prepareCall()</code></a></dt><dt>5.5. <a href="#connector-j-examples-output-param">Connector/J: Registering output parameters</a></dt><dt>5.6. <a href="#connector-j-examples-callablestatement">Connector/J: Setting <code class="literal">CallableStatement</code> input
                  parameters</a></dt><dt>5.7. <a href="#connector-j-examples-retrieving-results-params">Connector/J: Retrieving results and output parameter values</a></dt><dt>5.8. <a href="#connector-j-examples-autoincrement-getgeneratedkeys">Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">Statement.getGeneratedKeys()</code></a></dt><dt>5.9. <a href="#connector-j-examples-autoincrement-select">Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">SELECT LAST_INSERT_ID()</code></a></dt><dt>5.10. <a href="#connector-j-examples-autoincrement-updateable-resultsets">Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              in <code class="literal">Updatable ResultSets</code></a></dt><dt>5.11. <a href="#connector-j-examples-connectionpool-j2ee">Connector/J: Using a connection pool with a J2EE application server</a></dt><dt>5.12. <a href="#connector-j-examples-transaction-retry">Connector/J: Example of transaction with retry logic</a></dt></dl></div><div class="preface" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j"></a>MySQL Connector/J</h2></div></div></div><p>
    MySQL provides connectivity for client applications developed in the
    Java programming language through a JDBC driver, which is called
    MySQL Connector/J.
  </p><p>
    MySQL Connector/J is a JDBC Type 4 driver. Different versions are
    available that are compatible with the JDBC 3.0 and JDBC 4.0
    specifications. The Type 4 designation means that the driver is
    pure-Java implementation of the MySQL protocol and does not rely on
    the MySQL client libraries.
  </p><p>
    Although JDBC is useful by itself, we would hope that if you are not
    familiar with JDBC that after reading the first few sections of this
    manual, that you would avoid using naked JDBC for all but the most
    trivial problems and consider using one of the popular persistence
    frameworks such as
    <a href="http://www.hibernate.org/" target="_top">Hibernate</a>,
    <a href="http://www.springframework.org/" target="_top">Spring's JDBC
    templates</a> or <a href="http://ibatis.apache.org/" target="_top">Ibatis
    SQL Maps</a> to do the majority of repetitive work and heavier
    lifting that is sometimes required with JDBC.
  </p><p>
    This section is not designed to be a complete JDBC tutorial. If you
    need more information about using JDBC you might be interested in
    the following online tutorials that are more in-depth than the
    information presented here:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <a href="http://java.sun.com/docs/books/tutorial/jdbc/basics/index.html" target="_top">JDBC
        Basics</a>: A tutorial from Sun covering beginner topics in
        JDBC
      </p></li><li><p>
        <a href="http://java.sun.com/developer/onlineTraining/Database/JDBCShortCourse/index.html" target="_top">JDBC
        Short Course</a>: A more in-depth tutorial from Sun and
        JGuru
      </p></li></ul></div><p>
    <span class="bold"><strong>Key topics:</strong></span>
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        For help with connection strings, connection options setting up
        your connection through JDBC, see
        <a href="#connector-j-reference-configuration-properties" title="4.1. Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J">Section 4.1, “Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J”</a>.
      </p></li><li><p>
        For tips on using Connector/J and JDBC with generic J2EE
        toolkits, see <a href="#connector-j-usagenotes-j2ee" title="5.2. Using Connector/J with J2EE and Other Java Frameworks">Section 5.2, “Using Connector/J with J2EE and Other Java Frameworks”</a>.
      </p></li><li><p>
        Developers using the Tomcat server platform, see
        <a href="#connector-j-usagenotes-tomcat" title="5.2.2. Using Connector/J with Tomcat">Section 5.2.2, “Using Connector/J with Tomcat”</a>.
      </p></li><li><p>
        Developers using JBoss, see
        <a href="#connector-j-usagenotes-jboss" title="5.2.3. Using Connector/J with JBoss">Section 5.2.3, “Using Connector/J with JBoss”</a>.
      </p></li><li><p>
        Developers using Spring, see
        <a href="#connector-j-usagenotes-spring-config" title="5.2.4. Using Connector/J with Spring">Section 5.2.4, “Using Connector/J with Spring”</a>.
      </p></li><li><p>
        Developers using GlassFish (Sun Application Server), see
        <a href="#connector-j-usagenotes-glassfish-config" title="5.2.5. Using Connector/J with GlassFish">Section 5.2.5, “Using Connector/J with GlassFish”</a>.
      </p></li></ul></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-versions"></a>Chapter 1. Connector/J Versions</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#connector-j-versions-java">1.1. Java Versions Supported</a></span></dt></dl></div><p>
      There are currently four versions of MySQL Connector/J available:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Connector/J 5.1 is the Type 4 pure Java JDBC driver, which
          conforms to the JDBC 3.0 and JDBC 4.0 specifications. It
          provides compatibility with all the functionality of MySQL,
          including 4.1, 5.0, 5.1, 5.4 and 5.5. Connector/J 5.1 provides
          ease of development features, including auto-registration with
          the Driver Manager, standardized validity checks, categorized
          SQLExceptions, support for the JDBC-4.0 XML processing, per
          connection client information,
          <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NCHAR</code></a>,
          <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NVARCHAR</code></a> and
          <code class="literal">NCLOB</code> types. This release also includes all
          bug fixes up to and including Connector/J 5.0.6.
        </p></li><li><p>
          Connector/J 5.0 provides support for all the functionality
          offered by Connector/J 3.1 and includes distributed
          transaction (XA) support.
        </p></li><li><p>
          Connector/J 3.1 was designed for connectivity to MySQL 4.1 and
          MySQL 5.0 servers and provides support for all the
          functionality in MySQL 5.0 except distributed transaction (XA)
          support.
        </p></li><li><p>
          Connector/J 3.0 provides core functionality and was designed
          with connectivity to MySQL 3.x or MySQL 4.1 servers, although
          it will provide basic compatibility with later versions of
          MySQL. Connector/J 3.0 does not support server-side prepared
          statements, and does not support any of the features in
          versions of MySQL later than 4.1.
        </p></li></ul></div><p>
      The following table summarizes the Connector/J versions available:
    </p><p>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>Connector/J version</th><th>Driver Type</th><th>JDBC version</th><th>MySQL Server version</th><th>Status</th></tr></thead><tbody><tr><td>5.1</td><td>4</td><td>3.0, 4.0</td><td>4.1, 5.0, 5.1, 5.4, 5.5</td><td>Recommended version</td></tr><tr><td>5.0</td><td>4</td><td>3.0</td><td>4.1, 5.0</td><td>Released version</td></tr><tr><td>3.1</td><td>4</td><td>3.0</td><td>4.1, 5.0</td><td>Obsolete</td></tr><tr><td>3.0</td><td>4</td><td>3.0</td><td>3.x, 4.1</td><td>Obsolete</td></tr></tbody></table></div><p>
    </p><p>
      The current recommended version for Connector/J is 5.1. This guide
      covers all four connector versions, with specific notes given
      where a setting applies to a specific option.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-versions-java"></a>1.1. Java Versions Supported</h2></div></div></div><p>
        The following table summarizes Connector/J Java dependencies:
      </p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Connector/J version</th><th>Java RTE required</th><th>JDK required (to build source code)</th></tr></thead><tbody><tr><td>5.1</td><td>1.5.x, 1.6.x</td><td>1.6.x and 1.5.x</td></tr><tr><td>5.0</td><td>1.3.x, 1.4.x, 1.5.x, 1.6.x</td><td>1.4.2, 1.5.x, 1.6.x</td></tr><tr><td>3.1</td><td>1.2.x, 1.3.x, 1.4.x, 1.5.x, 1.6.x</td><td>1.4.2, 1.5.x, 1.6.x</td></tr><tr><td>3.0</td><td>1.2.x, 1.3.x, 1.4.x, 1.5.x, 1.6.x</td><td>1.4.2, 1.5.x, 1.6.x</td></tr></tbody></table></div><p>
      </p><p>
        MySQL Connector/J does not support JDK-1.1.x or JDK-1.0.x.
      </p><p>
        Because of the implementation of
        <code class="classname">java.sql.Savepoint</code>, Connector/J 3.1.0 and
        newer will not run on a Java runtime older than 1.4 unless the
        class verifier is turned off (by setting the
        <code class="option">-Xverify:none</code> option to the Java runtime). This
        is because the class verifier will try to load the class
        definition for <code class="classname">java.sql.Savepoint</code> even
        though it is not accessed by the driver unless you actually use
        savepoint functionality.
      </p><p>
        Caching functionality provided by Connector/J 3.1.0 or newer is
        also not available on JVMs older than 1.4.x, as it relies on
        <code class="classname">java.util.LinkedHashMap</code> which was first
        available in JDK-1.4.0.
      </p><p>
        If you are building Connector/J from source code using the
        source distribution (see
        <a href="#connector-j-installing-source" title="2.4. Installing from the Development Source Tree">Section 2.4, “Installing from the Development Source Tree”</a>) then you must
        use JDK 1.4.2 or newer to compile the Connector package. For
        Connector/J 5.1 you must have both JDK-1.6.x. and JDK-1.5.x
        installed to be able to build the source code.
      </p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-installing"></a>Chapter 2. Connector/J Installation</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#connector-j-binary-installation">2.1. Installing Connector/J from a Binary Distribution</a></span></dt><dt><span class="section"><a href="#connector-j-installing-classpath">2.2. Installing the Driver and Configuring the <code class="literal">CLASSPATH</code></a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading">2.3. Upgrading from an Older Version</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-installing-upgrading-3-0-to-3-1">2.3.1. Upgrading from MySQL Connector/J 3.0 to 3.1</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-5-1">2.3.2. Upgrading to MySQL Connector/J 5.1.x</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-issues">2.3.3. JDBC-Specific Issues When Upgrading to MySQL Server 4.1 or Newer</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-installing-source">2.4. Installing from the Development Source Tree</a></span></dt></dl></div><p>
      You can install the Connector/J package using either the binary or
      source distribution. The binary distribution provides the easiest
      method for installation; the source distribution enables you to
      customize your installation further. With either solution, you
      must manually add the Connector/J location to your Java
      <code class="literal">CLASSPATH</code>.
    </p><p>
      If you are upgrading from a previous version, read the upgrade
      information before continuing. See
      <a href="#connector-j-installing-upgrading" title="2.3. Upgrading from an Older Version">Section 2.3, “Upgrading from an Older Version”</a>.
    </p><p>
      Connector/J is also available as part of the Maven project. More
      information, and the Connector/J JAR files can be found at the
      <a href="http://www.ibiblio.org/maven/" target="_top">Maven
      repository</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-binary-installation"></a>2.1. Installing Connector/J from a Binary Distribution</h2></div></div></div><p>
        The easiest method of installation is to use the binary
        distribution of the Connector/J package. The binary distribution
        is available either as a Tar/Gzip or Zip file which you must
        extract to a suitable location and then optionally make the
        information about the package available by changing your
        <code class="literal">CLASSPATH</code> (see
        <a href="#connector-j-installing-classpath" title="2.2. Installing the Driver and Configuring the CLASSPATH">Section 2.2, “Installing the Driver and Configuring the <code class="literal">CLASSPATH</code>”</a>).
      </p><p>
        MySQL Connector/J is distributed as a .zip or .tar.gz archive
        containing the sources, the class files, and the JAR archive
        named
        <code class="filename">mysql-connector-java-<em class="replaceable"><code>[version]</code></em>-bin.jar</code>,
        and starting with Connector/J 3.1.8 a debug build of the driver
        in a file named
        <code class="filename">mysql-connector-java-<em class="replaceable"><code>[version]</code></em>-bin-g.jar</code>.
      </p><p>
        Starting with Connector/J 3.1.9, the <code class="filename">.class</code>
        files that constitute the JAR files are only included as part of
        the driver JAR file.
      </p><p>
        You should not use the debug build of the driver unless
        instructed to do so when reporting a problem or a bug, as it is
        not designed to be run in production environments, and will have
        adverse performance impact when used. The debug binary also
        depends on the Aspect/J runtime library, which is located in the
        <code class="filename">src/lib/aspectjrt.jar</code> file that comes with
        the Connector/J distribution.
      </p><p>
        You will need to use the appropriate graphical or command-line
        utility to extract the distribution (for example, WinZip for the
        .zip archive, and <span><strong class="command">tar</strong></span> for the .tar.gz
        archive). Because there are potentially long file names in the
        distribution, we use the GNU tar archive format. You will need
        to use GNU tar (or an application that understands the GNU tar
        archive format) to unpack the .tar.gz variant of the
        distribution.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-installing-classpath"></a>2.2. Installing the Driver and Configuring the <code class="literal">CLASSPATH</code></h2></div></div></div><p>
        Once you have extracted the distribution archive, you can
        install the driver by placing
        <code class="filename">mysql-connector-java-[version]-bin.jar </code>in
        your classpath, either by adding the full path to it to your
        <code class="literal">CLASSPATH</code> environment variable, or by
        directly specifying it with the command line switch -cp when
        starting your JVM.
      </p><p>
        If you are going to use the driver with the JDBC DriverManager,
        you would use <code class="literal">com.mysql.jdbc.Driver</code> as the
        class that implements <code class="classname">java.sql.Driver</code>.
      </p><p>
        You can set the <code class="literal">CLASSPATH</code> environment
        variable under UNIX, Linux or Mac OS X either locally for a user
        within their <code class="literal">.profile</code>,
        <code class="literal">.login</code> or other login file. You can also set
        it globally by editing the global
        <code class="literal">/etc/profile</code> file.
      </p><p>
        For example, under a C shell (csh, tcsh) you would add the
        Connector/J driver to your <code class="literal">CLASSPATH</code> using
        the following:
      </p><pre class="programlisting">shell&gt; setenv CLASSPATH /path/mysql-connector-java-[ver]-bin.jar:$CLASSPATH</pre><p>
        Or with a Bourne-compatible shell (sh, ksh, bash):
      </p><pre class="programlisting">shell&gt; export set CLASSPATH=/path/mysql-connector-java-[ver]-bin.jar:$CLASSPATH</pre><p>
        Within Windows 2000, Windows XP, Windows Server 2003 and Windows
        Vista, you must set the environment variable through the System
        Control Panel.
      </p><p>
        If you want to use MySQL Connector/J with an application server
        such as GlassFish, Tomcat or JBoss, you will have to read your
        vendor's documentation for more information on how to configure
        third-party class libraries, as most application servers ignore
        the <code class="literal">CLASSPATH</code> environment variable. For
        configuration examples for some J2EE application servers, see
        <a href="#connector-j-usagenotes-j2ee" title="5.2. Using Connector/J with J2EE and Other Java Frameworks">Section 5.2, “Using Connector/J with J2EE and Other Java Frameworks”</a>. However, the
        authoritative source for JDBC connection pool configuration
        information for your particular application server is the
        documentation for that application server.
      </p><p>
        If you are developing servlets or JSPs, and your application
        server is J2EE-compliant, you can put the driver's .jar file in
        the WEB-INF/lib subdirectory of your webapp, as this is a
        standard location for third party class libraries in J2EE web
        applications.
      </p><p>
        You can also use the <code class="classname">MysqlDataSource</code> or
        <code class="classname">MysqlConnectionPoolDataSource</code> classes in
        the <code class="literal">com.mysql.jdbc.jdbc2.optional</code> package, if
        your J2EE application server supports or requires them. Starting
        with Connector/J 5.0.0, the
        <code class="literal">javax.sql.XADataSource</code> interface is
        implemented using the
        <code class="literal">com.mysql.jdbc.jdbc2.optional.MysqlXADataSource</code>
        class, which supports XA distributed transactions when used in
        combination with MySQL server version 5.0.
      </p><p>
        The various <code class="classname">MysqlDataSource</code> classes
        support the following parameters (through standard set
        mutators):
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            user
          </p></li><li><p>
            password
          </p></li><li><p>
            serverName (see the previous section about fail-over hosts)
          </p></li><li><p>
            databaseName
          </p></li><li><p>
            port
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-installing-upgrading"></a>2.3. Upgrading from an Older Version</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-installing-upgrading-3-0-to-3-1">2.3.1. Upgrading from MySQL Connector/J 3.0 to 3.1</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-5-1">2.3.2. Upgrading to MySQL Connector/J 5.1.x</a></span></dt><dt><span class="section"><a href="#connector-j-installing-upgrading-issues">2.3.3. JDBC-Specific Issues When Upgrading to MySQL Server 4.1 or Newer</a></span></dt></dl></div><p>
        We try to keep the upgrade process as easy as possible, however
        as is the case with any software, sometimes changes need to be
        made in new versions to support new features, improve existing
        functionality, or comply with new standards.
      </p><p>
        This section has information about what users who are upgrading
        from one version of Connector/J to another (or to a new version
        of the MySQL server, with respect to JDBC functionality) should
        be aware of.
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-installing-upgrading-3-0-to-3-1"></a>2.3.1. Upgrading from MySQL Connector/J 3.0 to 3.1</h3></div></div></div><p>
          Connector/J 3.1 is designed to be backward-compatible with
          Connector/J 3.0 as much as possible. Major changes are
          isolated to new functionality exposed in MySQL-4.1 and newer,
          which includes Unicode character sets, server-side prepared
          statements, SQLState codes returned in error messages by the
          server and various performance enhancements that can be
          enabled or disabled using configuration properties.
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="bold"><strong>Unicode Character Sets</strong></span>:
              See the next section, as well as
              <a href="http://dev.mysql.com/doc/refman/5.5/en/charset.html" target="_top">Character Set Support</a>, for information on this new
              feature of MySQL. If you have something misconfigured, it
              will usually show up as an error with a message similar to
              <code class="literal">Illegal mix of collations</code>.
            </p></li><li><p>
              <span class="bold"><strong>Server-side Prepared
              Statements</strong></span>: Connector/J 3.1 will automatically
              detect and use server-side prepared statements when they
              are available (MySQL server version 4.1.0 and newer).
            </p><p>
              Starting with version 3.1.7, the driver scans SQL you are
              preparing using all variants of
              <code class="literal">Connection.prepareStatement()</code> to
              determine if it is a supported type of statement to
              prepare on the server side, and if it is not supported by
              the server, it instead prepares it as a client-side
              emulated prepared statement. You can disable this feature
              by passing
              <span class="property">emulateUnsupportedPstmts=false</span> in
              your JDBC URL.
            </p><p>
              If your application encounters issues with server-side
              prepared statements, you can revert to the older
              client-side emulated prepared statement code that is still
              presently used for MySQL servers older than 4.1.0 with the
              connection property
              <span class="property">useServerPrepStmts=false</span>
            </p></li><li><p>
              <span class="bold"><strong>Datetimes</strong></span> with all-zero
              components (<code class="literal">0000-00-00 ...</code>): These
              values can not be represented reliably in Java.
              Connector/J 3.0.x always converted them to
              <code class="literal">NULL</code> when being read from a ResultSet.
            </p><p>
              Connector/J 3.1 throws an exception by default when these
              values are encountered as this is the most correct
              behavior according to the JDBC and SQL standards. This
              behavior can be modified using the
              <span class="property">zeroDateTimeBehavior</span> configuration
              property. The permissible values are:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <code class="literal">exception</code> (the default), which
                  throws an SQLException with an SQLState of
                  <code class="literal">S1009</code>.
                </p></li><li><p>
                  <code class="literal">convertToNull</code>, which returns
                  <code class="literal">NULL</code> instead of the date.
                </p></li><li><p>
                  <code class="literal">round</code>, which rounds the date to the
                  nearest closest value which is
                  <code class="literal">0001-01-01</code>.
                </p></li></ul></div><p>
              Starting with Connector/J 3.1.7,
              <code class="literal">ResultSet.getString()</code> can be decoupled
              from this behavior using
              <span class="property">noDatetimeStringSync=true</span> (the
              default value is <code class="literal">false</code>) so that you can
              retrieve the unaltered all-zero value as a String. It
              should be noted that this also precludes using any time
              zone conversions, therefore the driver will not allow you
              to enable <span class="property">noDatetimeStringSync</span> and
              <span class="property">useTimezone</span> at the same time.
            </p></li><li><p>
              <span class="bold"><strong>New SQLState Codes</strong></span>:
              Connector/J 3.1 uses SQL:1999 SQLState codes returned by
              the MySQL server (if supported), which are different from
              the legacy X/Open state codes that Connector/J 3.0 uses.
              If connected to a MySQL server older than MySQL-4.1.0 (the
              oldest version to return SQLStates as part of the error
              code), the driver will use a built-in mapping. You can
              revert to the old mapping by using the configuration
              property <span class="property">useSqlStateCodes=false</span>.
            </p></li><li><p>
              <span class="bold"><strong><code class="literal">ResultSet.getString()</code></strong></span>:
              Calling <code class="literal">ResultSet.getString()</code> on a
              <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> column will now return
              the address of the <code class="literal">byte[]</code> array that
              represents it, instead of a <code class="literal">String</code>
              representation of the <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>.
              <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> values have no
              character set, so they cannot be converted to
              <code class="literal">java.lang.String</code>s without data loss or
              corruption.
            </p><p>
              To store strings in MySQL with LOB behavior, use one of
              the <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> types, which the
              driver will treat as a <code class="literal">java.sql.Clob</code>.
            </p></li><li><p>
              <span class="bold"><strong>Debug builds</strong></span>: Starting
              with Connector/J 3.1.8 a debug build of the driver in a
              file named
              <code class="filename">mysql-connector-java-<em class="replaceable"><code>[version]</code></em>-bin-g.jar</code>
              is shipped alongside the normal binary jar file that is
              named
              <code class="filename">mysql-connector-java-<em class="replaceable"><code>[version]</code></em>-bin.jar</code>.
            </p><p>
              Starting with Connector/J 3.1.9, we do not ship the .class
              files unbundled, they are only available in the JAR
              archives that ship with the driver.
            </p><p>
              You should not use the debug build of the driver unless
              instructed to do so when reporting a problem or bug, as it
              is not designed to be run in production environments, and
              will have adverse performance impact when used. The debug
              binary also depends on the Aspect/J runtime library, which
              is located in the
              <code class="filename">src/lib/aspectjrt.jar</code> file that comes
              with the Connector/J distribution.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-installing-upgrading-5-1"></a>2.3.2. Upgrading to MySQL Connector/J 5.1.x</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
              In Connector/J 5.0.x and earlier, the alias for a table in
              a <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> statement is
              returned when accessing the result set metadata using
              <code class="function">ResultSetMetaData.getColumnName()</code>.
              This behavior however is not JDBC compliant, and in
              Connector/J 5.1 this behavior was changed so that the
              original table name, rather than the alias, is returned.
            </p><p>
              The JDBC-compliant behavior is designed to let API users
              reconstruct the DML statement based on the metadata within
              <code class="literal">ResultSet</code> and
              <code class="literal">ResultSetMetaData</code>.
            </p><p>
              You can get the alias for a column in a result set by
              calling
              <code class="function">ResultSetMetaData.getColumnLabel()</code>.
              If you want to use the old noncompliant behavior with
              <code class="function">ResultSetMetaData.getColumnName()</code>,
              use the <code class="option">useOldAliasMetadataBehavior</code>
              option and set the value to <code class="literal">true</code>.
            </p><p>
              In Connector/J 5.0.x the default value of
              <code class="option">useOldAliasMetadataBehavior</code> was true, but
              in Connector/J 5.1 this was changed to a default value of
              false.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-installing-upgrading-issues"></a>2.3.3. JDBC-Specific Issues When Upgrading to MySQL Server 4.1 or Newer</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>Using the UTF-8 Character Encoding</em></span> -
              Prior to MySQL server version 4.1, the UTF-8 character
              encoding was not supported by the server, however the JDBC
              driver could use it, allowing storage of multiple
              character sets in latin1 tables on the server.
            </p><p>
              Starting with MySQL-4.1, this functionality is deprecated.
              If you have applications that rely on this functionality,
              and can not upgrade them to use the official Unicode
              character support in MySQL server version 4.1 or newer,
              you should add the following property to your connection
              URL:
            </p><p>
              <code class="computeroutput">useOldUTF8Behavior=true</code>
            </p></li><li><p>
              <span class="emphasis"><em>Server-side Prepared Statements</em></span> -
              Connector/J 3.1 will automatically detect and use
              server-side prepared statements when they are available
              (MySQL server version 4.1.0 and newer). If your
              application encounters issues with server-side prepared
              statements, you can revert to the older client-side
              emulated prepared statement code that is still presently
              used for MySQL servers older than 4.1.0 with the following
              connection property:
            </p><p>
              <code class="computeroutput">useServerPrepStmts=false</code>
            </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-installing-source"></a>2.4. Installing from the Development Source Tree</h2></div></div></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Caution</div><p>
          You should read this section only if you are interested in
          helping us test our new code. If you just want to get MySQL
          Connector/J up and running on your system, you should use a
          standard binary release distribution.
        </p></div><p>
        To install MySQL Connector/J from the development source tree,
        make sure that you have the following prerequisites:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            A Bazaar client, to check out the sources from our Launchpad
            repository (available from
            <a href="http://bazaar-vcs.org/" target="_top">http://bazaar-vcs.org/</a>).
          </p></li><li><p>
            Apache Ant version 1.7 or newer (available from
            <a href="http://ant.apache.org/" target="_top">http://ant.apache.org/</a>).
          </p></li><li><p>
            JDK 1.4.2 or later. Although MySQL Connector/J can be be
            used with older JDKs, to compile it from source you must
            have at least JDK 1.4.2. If you are building Connector/J 5.1
            you will need JDK 1.6.x and an older JDK such as JDK 1.5.x.
            You will then need to point your JAVA_HOME environment
            variable at the older installation.
          </p></li></ul></div><p>
        The source code repository for MySQL Connector/J is located on
        Launchpad at
        <a href="https://code.launchpad.net/connectorj" target="_top">https://code.launchpad.net/connectorj</a>.
      </p><p>
        To check out and compile a specific branch of MySQL Connector/J,
        follow these steps:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Check out the latest code from the branch that you want with
            one of the following commands.
          </p><p>
            To check out the latest development branch use:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>bzr branch lp:connectorj</code></strong></pre><p>
            This creates a <code class="filename">connectorj</code> subdirectory
            in the current directory that contains the latest sources
            for the requested branch.
          </p><p>
            To check out the latest 5.1 code use:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>bzr branch lp:connectorj/5.1</code></strong></pre><p>
            This will create a <code class="filename">5.1</code> subdirectory in
            the current directory containing the latest 5.1 code.
          </p></li><li><p>
            If you are building Connector/J 5.1 make sure that you have
            both JDK 1.6.x installed and an older JDK such as JDK 1.5.x.
            This is because Connector/J supports both JDBC 3.0 (which
            was prior to JDK 1.6.x) and JDBC 4.0. Set your JAVA_HOME
            environment variable to the path of the older JDK
            installation.
          </p></li><li><p>
            Change location to either the
            <code class="filename">connectorj</code> or <code class="filename">5.1</code>
            directory, depending on which branch you want to build, to
            make it your current working directory. For example:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd connectorj</code></strong></pre></li><li><p>
            If you are building Connector/J 5.1 you need to edit the
            <code class="filename">build.xml</code> to reflect the location of
            your JDK 1.6.x installation. The lines that you need to
            change are:
          </p><pre class="programlisting">            &lt;property name="com.mysql.jdbc.java6.javac" value="C:\jvms\jdk1.6.0\bin\javac.exe" /&gt;
            &lt;property name="com.mysql.jdbc.java6.rtjar" value="C:\jvms\jdk1.6.0\jre\lib\rt.jar" /&gt;
          </pre><p>
            Alternatively, you can set the value of these property names
            through the Ant <code class="option">-D</code> option.
          </p></li><li><p>
            Issue the following command to compile the driver and create
            a <code class="filename">.jar</code> file suitable for installation:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ant dist</code></strong></pre><p>
            This creates a <code class="filename">build</code> directory in the
            current directory, where all build output will go. A
            directory is created in the <code class="filename">build</code>
            directory that includes the version number of the sources
            you are building from. This directory contains the sources,
            compiled <code class="filename">.class</code> files, and a
            <code class="filename">.jar</code> file suitable for deployment. For
            other possible targets, including ones that will create a
            fully packaged distribution, issue the following command:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ant -projecthelp</code></strong></pre></li><li><p>
            A newly created <code class="filename">.jar</code> file containing
            the JDBC driver will be placed in the directory
            <code class="filename">build/mysql-connector-java-<em class="replaceable"><code>[version]</code></em></code>.
          </p><p>
            Install the newly created JDBC driver as you would a binary
            <code class="filename">.jar</code> file that you download from MySQL
            by following the instructions in
            <a href="#connector-j-installing-classpath" title="2.2. Installing the Driver and Configuring the CLASSPATH">Section 2.2, “Installing the Driver and Configuring the <code class="literal">CLASSPATH</code>”</a>.
          </p></li></ol></div><p>
        A package containing both the binary and source code for
        Connector/J 5.1 can also be found at the following location:
        <a href="http://dev.mysql.com/downloads/connector/j/5.1.html" target="_top">
        Connector/J 5.1 Download</a>
      </p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-examples"></a>Chapter 3. Connector/J Examples</h2></div></div></div><p>
      Examples of using Connector/J are located throughout this
      document, this section provides a summary and links to these
      examples.
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <a href="#connector-j-examples-connection-drivermanager" title="Example 5.1. Connector/J: Obtaining a connection from the
            DriverManager">Example 5.1, “Connector/J: Obtaining a connection from the
            <code class="literal">DriverManager</code>”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-execute-select" title="Example 5.2. Connector/J: Using java.sql.Statement to execute a
            SELECT query">Example 5.2, “Connector/J: Using java.sql.Statement to execute a
            <code class="literal">SELECT</code> query”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-stored-procedure" title="Example 5.3. Connector/J: Calling Stored Procedures">Example 5.3, “Connector/J: Calling Stored Procedures”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-preparecall" title="Example 5.4. Connector/J: Using Connection.prepareCall()">Example 5.4, “Connector/J: Using <code class="literal">Connection.prepareCall()</code>”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-output-param" title="Example 5.5. Connector/J: Registering output parameters">Example 5.5, “Connector/J: Registering output parameters”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-callablestatement" title="Example 5.6. Connector/J: Setting CallableStatement input
                  parameters">Example 5.6, “Connector/J: Setting <code class="literal">CallableStatement</code> input
                  parameters”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-retrieving-results-params" title="Example 5.7. Connector/J: Retrieving results and output parameter values">Example 5.7, “Connector/J: Retrieving results and output parameter values”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-autoincrement-getgeneratedkeys" title="Example 5.8. Connector/J: Retrieving AUTO_INCREMENT column values
              using Statement.getGeneratedKeys()">Example 5.8, “Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">Statement.getGeneratedKeys()</code>”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-autoincrement-select" title="Example 5.9. Connector/J: Retrieving AUTO_INCREMENT column values
              using SELECT LAST_INSERT_ID()">Example 5.9, “Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">SELECT LAST_INSERT_ID()</code>”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-autoincrement-updateable-resultsets" title="Example 5.10. Connector/J: Retrieving AUTO_INCREMENT column values
              in Updatable ResultSets">Example 5.10, “Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              in <code class="literal">Updatable ResultSets</code>”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-connectionpool-j2ee" title="Example 5.11. Connector/J: Using a connection pool with a J2EE application server">Example 5.11, “Connector/J: Using a connection pool with a J2EE application server”</a>
        </p></li><li><p>
          <a href="#connector-j-examples-transaction-retry" title="Example 5.12. Connector/J: Example of transaction with retry logic">Example 5.12, “Connector/J: Example of transaction with retry logic”</a>
        </p></li></ul></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-reference"></a>Chapter 4. Connector/J (JDBC) Reference</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#connector-j-reference-configuration-properties">4.1. Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J</a></span></dt><dt><span class="section"><a href="#connector-j-reference-implementation-notes">4.2. JDBC API Implementation Notes</a></span></dt><dt><span class="section"><a href="#connector-j-reference-type-conversions">4.3. Java, JDBC and MySQL Types</a></span></dt><dt><span class="section"><a href="#connector-j-reference-charsets">4.4. Using Character Sets and Unicode</a></span></dt><dt><span class="section"><a href="#connector-j-reference-using-ssl">4.5. Connecting Securely Using SSL</a></span></dt><dt><span class="section"><a href="#connector-j-reference-replication-connection">4.6. Using Master/Slave Replication with ReplicationConnection</a></span></dt><dt><span class="section"><a href="#connector-j-reference-error-sqlstates">4.7. Mapping MySQL Error Numbers to SQLStates</a></span></dt></dl></div><p>
      This section of the manual contains reference material for MySQL
      Connector/J, some of which is automatically generated during the
      Connector/J build process.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-configuration-properties"></a>4.1. Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J</h2></div></div></div><p>
        The name of the class that implements java.sql.Driver in MySQL
        Connector/J is <code class="literal">com.mysql.jdbc.Driver</code>. The
        <code class="literal">org.gjt.mm.mysql.Driver</code> class name is also
        usable to remain backward-compatible with MM.MySQL. You should
        use this class name when registering the driver, or when
        otherwise configuring software to use MySQL Connector/J.
      </p><p>
        The JDBC URL format for MySQL Connector/J is as follows, with
        items in square brackets ([, ]) being optional:
      </p><pre class="programlisting">jdbc:mysql://[host][,failoverhost...][:port]/[database] »
[?propertyName1][=propertyValue1][&amp;propertyName2][=propertyValue2]...</pre><p>
        If the host name is not specified, it defaults to 127.0.0.1. If
        the port is not specified, it defaults to 3306, the default port
        number for MySQL servers.
      </p><pre class="programlisting">jdbc:mysql://[host:port],[host:port].../[database] »
[?propertyName1][=propertyValue1][&amp;propertyName2][=propertyValue2]...</pre><p>
        If the database is not specified, the connection will be made
        with no default database. In this case, you will need to either
        call the <code class="function">setCatalog()</code> method on the
        Connection instance or fully specify table names using the
        database name (that is, <code class="literal">SELECT dbname.tablename.colname
        FROM dbname.tablename...</code>) in your SQL. Not specifying
        the database to use upon connection is generally only useful
        when building tools that work with multiple databases, such as
        GUI database managers.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          JDBC clients should never employ the <code class="literal">USE
          database</code> statement to specify the desired database,
          they should always use the
          <code class="literal">Connection.setCatalog()</code> method instead.
        </p></div><p>
        MySQL Connector/J has fail-over support. This enables the driver
        to fail-over to any number of slave hosts and still perform
        read-only queries. Fail-over only happens when the connection is
        in an <code class="function">autoCommit(true)</code> state, because
        fail-over can not happen reliably when a transaction is in
        progress. Most application servers and connection pools set
        <code class="literal">autoCommit</code> to <code class="literal">true</code> at the
        end of every transaction/connection use.
      </p><p>
        The fail-over functionality has the following behavior:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            If the URL property <span class="property">autoReconnect</span> is
            false: Failover only happens at connection initialization,
            and failback occurs when the driver determines that the
            first host has become available again.
          </p></li><li><p>
            If the URL property <span class="property">autoReconnect</span> is
            true: Failover happens when the driver determines that the
            connection has failed (before <span class="emphasis"><em>every</em></span>
            query), and falls back to the first host when it determines
            that the host has become available again (after
            <code class="literal">queriesBeforeRetryMaster</code> queries have
            been issued).
          </p></li></ul></div><p>
        In either case, whenever you are connected to a "failed-over"
        server, the connection will be set to read-only state, so
        queries that would modify data will have exceptions thrown (the
        query will <span class="bold"><strong>never</strong></span> be processed
        by the MySQL server).
      </p><p>
        Configuration properties define how Connector/J will make a
        connection to a MySQL server. Unless otherwise noted, properties
        can be set for a DataSource object or for a Connection object.
      </p><p>
        Configuration Properties can be set in one of the following
        ways:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Using the set*() methods on MySQL implementations of
            java.sql.DataSource (which is the preferred method when
            using implementations of java.sql.DataSource):
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                com.mysql.jdbc.jdbc2.optional.MysqlDataSource
              </p></li><li><p>
                com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource
              </p></li></ul></div></li><li><p>
            As a key/value pair in the java.util.Properties instance
            passed to <code class="literal">DriverManager.getConnection()</code>
            or <code class="literal">Driver.connect()</code>
          </p></li><li><p>
            As a JDBC URL parameter in the URL given to
            <code class="literal">java.sql.DriverManager.getConnection()</code>,
            <code class="literal">java.sql.Driver.connect()</code> or the MySQL
            implementations of the
            <code class="literal">javax.sql.DataSource</code>
            <code class="function">setURL()</code> method.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
              If the mechanism you use to configure a JDBC URL is
              XML-based, you will need to use the XML character literal
              &amp;amp; to separate configuration parameters, as the
              ampersand is a reserved character for XML.
            </p></div></li></ul></div><p>
        The properties are listed in the following tables.
      </p><p><b>Connection/Authentication. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>user</td><td>The user to connect as</td><td> </td><td>all versions</td></tr><tr><td>password</td><td>The password to use when connecting</td><td> </td><td>all versions</td></tr><tr><td>socketFactory</td><td>The name of the class that the driver should use for creating socket
                connections to the server. This class must implement the
                interface 'com.mysql.jdbc.SocketFactory' and have public
                no-args constructor.</td><td>com.mysql.jdbc.StandardSocketFactory</td><td>3.0.3</td></tr><tr><td>connectTimeout</td><td>Timeout for socket connect (in milliseconds), with 0 being no timeout.
                Only works on JDK-1.4 or newer. Defaults to '0'.</td><td>0</td><td>3.0.1</td></tr><tr><td>socketTimeout</td><td>Timeout on network socket operations (0, the default means no timeout).</td><td>0</td><td>3.0.1</td></tr><tr><td>connectionLifecycleInterceptors</td><td>A comma-delimited list of classes that implement
                "com.mysql.jdbc.ConnectionLifecycleInterceptor" that
                should notified of connection lifecycle events
                (creation, destruction, commit, rollback, setCatalog and
                setAutoCommit) and potentially alter the execution of
                these commands. ConnectionLifecycleInterceptors are
                "stackable", more than one interceptor may be specified
                via the configuration property as a comma-delimited
                list, with the interceptors executed in order from left
                to right.</td><td> </td><td>5.1.4</td></tr><tr><td>useConfigs</td><td>Load the comma-delimited list of configuration properties before parsing
                the URL or applying user-specified properties. These
                configurations are explained in the 'Configurations' of
                the documentation.</td><td> </td><td>3.1.5</td></tr><tr><td>interactiveClient</td><td>Set the CLIENT_INTERACTIVE flag, which tells MySQL to timeout
                connections based on INTERACTIVE_TIMEOUT instead of
                WAIT_TIMEOUT</td><td>false</td><td>3.1.0</td></tr><tr><td>localSocketAddress</td><td>Hostname or IP address given to explicitly configure the interface that
                the driver will bind the client side of the TCP/IP
                connection to when connecting.</td><td> </td><td>5.0.5</td></tr><tr><td>propertiesTransform</td><td>An implementation of com.mysql.jdbc.ConnectionPropertiesTransform that
                the driver will use to modify URL properties passed to
                the driver before attempting a connection</td><td> </td><td>3.1.4</td></tr><tr><td>useCompression</td><td>Use zlib compression when communicating with the server (true/false)?
                Defaults to 'false'.</td><td>false</td><td>3.0.17</td></tr></tbody></table></div><p>
    </p><p><b>Networking. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>maxAllowedPacket</td><td>Maximum allowed packet size to send to server. If not set, the value of
                system variable 'max_allowed_packet' will be used to
                initialize this upon connecting. This value will not
                take effect if set larger than the value of
                'max_allowed_packet'.</td><td>-1</td><td>5.1.8</td></tr><tr><td>tcpKeepAlive</td><td>If connecting using TCP/IP, should the driver set SO_KEEPALIVE?</td><td>true</td><td>5.0.7</td></tr><tr><td>tcpNoDelay</td><td>If connecting using TCP/IP, should the driver set SO_TCP_NODELAY
                (disabling the Nagle Algorithm)?</td><td>true</td><td>5.0.7</td></tr><tr><td>tcpRcvBuf</td><td>If connecting using TCP/IP, should the driver set SO_RCV_BUF to the
                given value? The default value of '0', means use the
                platform default value for this property)</td><td>0</td><td>5.0.7</td></tr><tr><td>tcpSndBuf</td><td>If connecting using TCP/IP, shuold the driver set SO_SND_BUF to the
                given value? The default value of '0', means use the
                platform default value for this property)</td><td>0</td><td>5.0.7</td></tr><tr><td>tcpTrafficClass</td><td>If connecting using TCP/IP, should the driver set traffic class or
                type-of-service fields ?See the documentation for
                java.net.Socket.setTrafficClass() for more information.</td><td>0</td><td>5.0.7</td></tr></tbody></table></div><p>
    </p><p><b>High Availability and Clustering. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>autoReconnect</td><td>Should the driver try to re-establish stale and/or dead connections? If
                enabled the driver will throw an exception for a queries
                issued on a stale or dead connection, which belong to
                the current transaction, but will attempt reconnect
                before the next query issued on the connection in a new
                transaction. The use of this feature is not recommended,
                because it has side effects related to session state and
                data consistency when applications don't handle
                SQLExceptions properly, and is only designed to be used
                when you are unable to configure your application to
                handle SQLExceptions resulting from dead and stale
                connections properly. Alternatively, investigate setting
                the MySQL server variable "wait_timeout" to some high
                value rather than the default of 8 hours.</td><td>false</td><td>1.1</td></tr><tr><td>autoReconnectForPools</td><td>Use a reconnection strategy appropriate for connection pools (defaults
                to 'false')</td><td>false</td><td>3.1.3</td></tr><tr><td>failOverReadOnly</td><td>When failing over in autoReconnect mode, should the connection be set to
                'read-only'?</td><td>true</td><td>3.0.12</td></tr><tr><td>maxReconnects</td><td>Maximum number of reconnects to attempt if autoReconnect is true,
                default is '3'.</td><td>3</td><td>1.1</td></tr><tr><td>reconnectAtTxEnd</td><td>If autoReconnect is set to true, should the driver attempt reconnections
                at the end of every transaction?</td><td>false</td><td>3.0.10</td></tr><tr><td>retriesAllDown</td><td>When using loadbalancing, the number of times the driver should cycle
                through available hosts, attempting to connect. Between
                cycles, the driver will pause for 250ms if no servers
                are available.</td><td>120</td><td>5.1.6</td></tr><tr><td>initialTimeout</td><td>If autoReconnect is enabled, the initial time to wait between re-connect
                attempts (in seconds, defaults to '2').</td><td>2</td><td>1.1</td></tr><tr><td>roundRobinLoadBalance</td><td>When autoReconnect is enabled, and failoverReadonly is false, should we
                pick hosts to connect to on a round-robin basis?</td><td>false</td><td>3.1.2</td></tr><tr><td>queriesBeforeRetryMaster</td><td>Number of queries to issue before falling back to master when failed
                over (when using multi-host failover). Whichever
                condition is met first, 'queriesBeforeRetryMaster' or
                'secondsBeforeRetryMaster' will cause an attempt to be
                made to reconnect to the master. Defaults to 50.</td><td>50</td><td>3.0.2</td></tr><tr><td>secondsBeforeRetryMaster</td><td>How long should the driver wait, when failed over, before attempting</td><td>30</td><td>3.0.2</td></tr><tr><td>selfDestructOnPingMaxOperations</td><td>=If set to a non-zero value, the driver will report close the connection
                and report failure when Connection.ping() or
                Connection.isValid(int) is called if the connnection's
                count of commands sent to the server exceeds this value.</td><td>0</td><td>5.1.6</td></tr><tr><td>selfDestructOnPingSecondsLifetime</td><td>If set to a non-zero value, the driver will report close the connection
                and report failure when Connection.ping() or
                Connection.isValid(int) is called if the connnection's
                lifetime exceeds this value.</td><td>0</td><td>5.1.6</td></tr><tr><td>resourceId</td><td>A globally unique name that identifies the resource that this datasource
                or connection is connected to, used for
                XAResource.isSameRM() when the driver can't determine
                this value based on hostnames used in the URL</td><td> </td><td>5.0.1</td></tr></tbody></table></div><p>
    </p><p><b>Security. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>allowMultiQueries</td><td>Allow the use of ';' to delimit multiple queries during one statement
                (true/false), defaults to 'false'</td><td>false</td><td>3.1.1</td></tr><tr><td>useSSL</td><td>Use SSL when communicating with the server (true/false), defaults to
                'false'</td><td>false</td><td>3.0.2</td></tr><tr><td>requireSSL</td><td>Require SSL connection if useSSL=true? (defaults to 'false').</td><td>false</td><td>3.1.0</td></tr><tr><td>verifyServerCertificate</td><td>If "useSSL" is set to "true", should the driver verify the server's
                certificate? When using this feature, the keystore
                parameters should be specified by the
                "clientCertificateKeyStore*" properties, rather than
                system properties.</td><td>true</td><td>5.1.6</td></tr><tr><td>clientCertificateKeyStoreUrl</td><td>URL to the client certificate KeyStore (if not specified, use defaults)</td><td> </td><td>5.1.0</td></tr><tr><td>clientCertificateKeyStoreType</td><td>KeyStore type for client certificates (NULL or empty means use the
                default, which is "JKS". Standard keystore types
                supported by the JVM are "JKS" and "PKCS12", your
                environment may have more available depending on what
                security products are installed and available to the
                JVM.</td><td>JKS</td><td>5.1.0</td></tr><tr><td>clientCertificateKeyStorePassword</td><td>Password for the client certificates KeyStore</td><td> </td><td>5.1.0</td></tr><tr><td>trustCertificateKeyStoreUrl</td><td>URL to the trusted root certificate KeyStore (if not specified, use
                defaults)</td><td> </td><td>5.1.0</td></tr><tr><td>trustCertificateKeyStoreType</td><td>KeyStore type for trusted root certificates (NULL or empty means use the
                default, which is "JKS". Standard keystore types
                supported by the JVM are "JKS" and "PKCS12", your
                environment may have more available depending on what
                security products are installed and available to the
                JVM.</td><td>JKS</td><td>5.1.0</td></tr><tr><td>trustCertificateKeyStorePassword</td><td>Password for the trusted root certificates KeyStore</td><td> </td><td>5.1.0</td></tr><tr><td>allowLoadLocalInfile</td><td>Should the driver allow use of 'LOAD DATA LOCAL INFILE...' (defaults to
                'true').</td><td>true</td><td>3.0.3</td></tr><tr><td>allowUrlInLocalInfile</td><td>Should the driver allow URLs in 'LOAD DATA LOCAL INFILE' statements?</td><td>false</td><td>3.1.4</td></tr><tr><td>paranoid</td><td>Take measures to prevent exposure sensitive information in error
                messages and clear data structures holding sensitive
                data when possible? (defaults to 'false')</td><td>false</td><td>3.0.1</td></tr><tr><td>passwordCharacterEncoding</td><td>What character encoding is used for passwords? Leaving this set to the
                default value (null), uses the platform character set,
                which works for ISO8859_1 (i.e. "latin1") passwords. For
                passwords in other character encodings, the encoding
                will have to be specified with this property, as it's
                not possible for the driver to auto-detect this.</td><td> </td><td>5.1.7</td></tr></tbody></table></div><p>
    </p><p><b>Performance Extensions. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>callableStmtCacheSize</td><td>If 'cacheCallableStmts' is enabled, how many callable statements should
                be cached?</td><td>100</td><td>3.1.2</td></tr><tr><td>metadataCacheSize</td><td>The number of queries to cache ResultSetMetadata for if
                cacheResultSetMetaData is set to 'true' (default 50)</td><td>50</td><td>3.1.1</td></tr><tr><td>useLocalSessionState</td><td>Should the driver refer to the internal values of autocommit and
                transaction isolation that are set by
                Connection.setAutoCommit() and
                Connection.setTransactionIsolation() and transaction
                state as maintained by the protocol, rather than
                querying the database or blindly sending commands to the
                database for commit() or rollback() method calls?</td><td>false</td><td>3.1.7</td></tr><tr><td>useLocalTransactionState</td><td>Should the driver use the in-transaction state provided by the MySQL
                protocol to determine if a commit() or rollback() should
                actually be sent to the database?</td><td>false</td><td>5.1.7</td></tr><tr><td>prepStmtCacheSize</td><td>If prepared statement caching is enabled, how many prepared statements
                should be cached?</td><td>25</td><td>3.0.10</td></tr><tr><td>prepStmtCacheSqlLimit</td><td>If prepared statement caching is enabled, what's the largest SQL the
                driver will cache the parsing for?</td><td>256</td><td>3.0.10</td></tr><tr><td>alwaysSendSetIsolation</td><td>Should the driver always communicate with the database when
                Connection.setTransactionIsolation() is called? If set
                to false, the driver will only communicate with the
                database when the requested transaction isolation is
                different than the whichever is newer, the last value
                that was set via Connection.setTransactionIsolation(),
                or the value that was read from the server when the
                connection was established.</td><td>true</td><td>3.1.7</td></tr><tr><td>maintainTimeStats</td><td>Should the driver maintain various internal timers to enable idle time
                calculations as well as more verbose error messages when
                the connection to the server fails? Setting this
                property to false removes at least two calls to
                System.getCurrentTimeMillis() per query.</td><td>true</td><td>3.1.9</td></tr><tr><td>useCursorFetch</td><td>If connected to MySQL &gt; 5.0.2, and setFetchSize() &gt; 0 on a
                statement, should that statement use cursor-based
                fetching to retrieve rows?</td><td>false</td><td>5.0.0</td></tr><tr><td>blobSendChunkSize</td><td>Chunk to use when sending BLOB/CLOBs via ServerPreparedStatements</td><td>1048576</td><td>3.1.9</td></tr><tr><td>cacheCallableStmts</td><td>Should the driver cache the parsing stage of CallableStatements</td><td>false</td><td>3.1.2</td></tr><tr><td>cachePrepStmts</td><td>Should the driver cache the parsing stage of PreparedStatements of
                client-side prepared statements, the "check" for
                suitability of server-side prepared and server-side
                prepared statements themselves?</td><td>false</td><td>3.0.10</td></tr><tr><td>cacheResultSetMetadata</td><td>Should the driver cache ResultSetMetaData for Statements and
                PreparedStatements? (Req. JDK-1.4+, true/false, default
                'false')</td><td>false</td><td>3.1.1</td></tr><tr><td>cacheServerConfiguration</td><td>Should the driver cache the results of 'SHOW VARIABLES' and 'SHOW
                COLLATION' on a per-URL basis?</td><td>false</td><td>3.1.5</td></tr><tr><td>defaultFetchSize</td><td>The driver will call setFetchSize(n) with this value on all
                newly-created Statements</td><td>0</td><td>3.1.9</td></tr><tr><td>dontTrackOpenResources</td><td>The JDBC specification requires the driver to automatically track and
                close resources, however if your application doesn't do
                a good job of explicitly calling close() on statements
                or result sets, this can cause memory leakage. Setting
                this property to true relaxes this constraint, and can
                be more memory efficient for some applications.</td><td>false</td><td>3.1.7</td></tr><tr><td>dynamicCalendars</td><td>Should the driver retrieve the default calendar when required, or cache
                it per connection/session?</td><td>false</td><td>3.1.5</td></tr><tr><td>elideSetAutoCommits</td><td>If using MySQL-4.1 or newer, should the driver only issue 'set
                autocommit=n' queries when the server's state doesn't
                match the requested state by
                Connection.setAutoCommit(boolean)?</td><td>false</td><td>3.1.3</td></tr><tr><td>enableQueryTimeouts</td><td>When enabled, query timeouts set via Statement.setQueryTimeout() use a
                shared java.util.Timer instance for scheduling. Even if
                the timeout doesn't expire before the query is
                processed, there will be memory used by the TimerTask
                for the given timeout which won't be reclaimed until the
                time the timeout would have expired if it hadn't been
                cancelled by the driver. High-load environments might
                want to consider disabling this functionality.</td><td>true</td><td>5.0.6</td></tr><tr><td>holdResultsOpenOverStatementClose</td><td>Should the driver leave the result sets open on Statement.close()
                (enabling violates JDBC specification)</td><td>false</td><td>3.1.7</td></tr><tr><td>largeRowSizeThreshold</td><td>What size result set row should the JDBC driver consider "large", and
                thus use a more memory-efficient way of representing the
                row internally?</td><td>2048</td><td>5.1.1</td></tr><tr><td>loadBalanceStrategy</td><td>If using a load-balanced connection to connect to SQL nodes in a MySQL
                Cluster/NDB configuration (by using the URL prefix
                "jdbc:mysql:loadbalance://"), which load balancing
                algorithm should the driver use: (1) "random" - the
                driver will pick a random host for each request. This
                tends to work better than round-robin, as the randomness
                will somewhat account for spreading loads where requests
                vary in response time, while round-robin can sometimes
                lead to overloaded nodes if there are variations in
                response times across the workload. (2)
                "bestResponseTime" - the driver will route the request
                to the host that had the best response time for the
                previous transaction.</td><td>random</td><td>5.0.6</td></tr><tr><td>locatorFetchBufferSize</td><td>If 'emulateLocators' is configured to 'true', what size buffer should be
                used when fetching BLOB data for getBinaryInputStream?</td><td>1048576</td><td>3.2.1</td></tr><tr><td>rewriteBatchedStatements</td><td>Should the driver use multiqueries (irregardless of the setting of
                "allowMultiQueries") as well as rewriting of prepared
                statements for INSERT into multi-value inserts when
                executeBatch() is called? Notice that this has the
                potential for SQL injection if using plain
                java.sql.Statements and your code doesn't sanitize input
                correctly. Notice that for prepared statements,
                server-side prepared statements can not currently take
                advantage of this rewrite option, and that if you don't
                specify stream lengths when using
                PreparedStatement.set*Stream(), the driver won't be able
                to determine the optimum number of parameters per batch
                and you might receive an error from the driver that the
                resultant packet is too large.
                Statement.getGeneratedKeys() for these rewritten
                statements only works when the entire batch includes
                INSERT statements.</td><td>false</td><td>3.1.13</td></tr><tr><td>useDirectRowUnpack</td><td>Use newer result set row unpacking code that skips a copy from network
                buffers to a MySQL packet instance and instead reads
                directly into the result set row data buffers.</td><td>true</td><td>5.1.1</td></tr><tr><td>useDynamicCharsetInfo</td><td>Should the driver use a per-connection cache of character set
                information queried from the server when necessary, or
                use a built-in static mapping that is more efficient,
                but isn't aware of custom character sets or character
                sets implemented after the release of the JDBC driver?</td><td>true</td><td>5.0.6</td></tr><tr><td>useFastDateParsing</td><td>Use internal String-&gt;Date/Time/Timestamp conversion routines to avoid
                excessive object creation?</td><td>true</td><td>5.0.5</td></tr><tr><td>useFastIntParsing</td><td>Use internal String-&gt;Integer conversion routines to avoid excessive
                object creation?</td><td>true</td><td>3.1.4</td></tr><tr><td>useJvmCharsetConverters</td><td>Always use the character encoding routines built into the JVM, rather
                than using lookup tables for single-byte character sets?</td><td>false</td><td>5.0.1</td></tr><tr><td>useReadAheadInput</td><td>Use newer, optimized non-blocking, buffered input stream when reading
                from the server?</td><td>true</td><td>3.1.5</td></tr></tbody></table></div><p>
    </p><p><b>Debugging/Profiling. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>logger</td><td>The name of a class that implements "com.mysql.jdbc.log.Log" that will
                be used to log messages to. (default is
                "com.mysql.jdbc.log.StandardLogger", which logs to
                STDERR)</td><td>com.mysql.jdbc.log.StandardLogger</td><td>3.1.1</td></tr><tr><td>gatherPerfMetrics</td><td>Should the driver gather performance metrics, and report them via the
                configured logger every 'reportMetricsIntervalMillis'
                milliseconds?</td><td>false</td><td>3.1.2</td></tr><tr><td>profileSQL</td><td>Trace queries and their execution/fetch times to the configured logger
                (true/false) defaults to 'false'</td><td>false</td><td>3.1.0</td></tr><tr><td>profileSql</td><td>Deprecated, use 'profileSQL' instead. Trace queries and their
                execution/fetch times on STDERR (true/false) defaults to
                'false'</td><td> </td><td>2.0.14</td></tr><tr><td>reportMetricsIntervalMillis</td><td>If 'gatherPerfMetrics' is enabled, how often should they be logged (in
                ms)?</td><td>30000</td><td>3.1.2</td></tr><tr><td>maxQuerySizeToLog</td><td>Controls the maximum length/size of a query that will get logged when
                profiling or tracing</td><td>2048</td><td>3.1.3</td></tr><tr><td>packetDebugBufferSize</td><td>The maximum number of packets to retain when 'enablePacketDebug' is true</td><td>20</td><td>3.1.3</td></tr><tr><td>slowQueryThresholdMillis</td><td>If 'logSlowQueries' is enabled, how long should a query (in ms) before
                it is logged as 'slow'?</td><td>2000</td><td>3.1.2</td></tr><tr><td>slowQueryThresholdNanos</td><td>If 'useNanosForElapsedTime' is set to true, and this property is set to
                a non-zero value, the driver will use this threshold (in
                nanosecond units) to determine if a query was slow.</td><td>0</td><td>5.0.7</td></tr><tr><td>useUsageAdvisor</td><td>Should the driver issue 'usage' warnings advising proper and efficient
                usage of JDBC and MySQL Connector/J to the log
                (true/false, defaults to 'false')?</td><td>false</td><td>3.1.1</td></tr><tr><td>autoGenerateTestcaseScript</td><td>Should the driver dump the SQL it is executing, including server-side
                prepared statements to STDERR?</td><td>false</td><td>3.1.9</td></tr><tr><td>autoSlowLog</td><td>Instead of using slowQueryThreshold* to determine if a query is slow
                enough to be logged, maintain statistics that allow the
                driver to determine queries that are outside the 99th
                percentile?</td><td>true</td><td>5.1.4</td></tr><tr><td>clientInfoProvider</td><td>The name of a class that implements the
                com.mysql.jdbc.JDBC4ClientInfoProvider interface in
                order to support JDBC-4.0's
                Connection.get/setClientInfo() methods</td><td>com.mysql.jdbc.JDBC4CommentClientInfoProvider</td><td>5.1.0</td></tr><tr><td>dumpMetadataOnColumnNotFound</td><td>Should the driver dump the field-level metadata of a result set into the
                exception message when ResultSet.findColumn() fails?</td><td>false</td><td>3.1.13</td></tr><tr><td>dumpQueriesOnException</td><td>Should the driver dump the contents of the query sent to the server in
                the message for SQLExceptions?</td><td>false</td><td>3.1.3</td></tr><tr><td>enablePacketDebug</td><td>When enabled, a ring-buffer of 'packetDebugBufferSize' packets will be
                kept, and dumped when exceptions are thrown in key areas
                in the driver's code</td><td>false</td><td>3.1.3</td></tr><tr><td>explainSlowQueries</td><td>If 'logSlowQueries' is enabled, should the driver automatically issue an
                'EXPLAIN' on the server and send the results to the
                configured log at a WARN level?</td><td>false</td><td>3.1.2</td></tr><tr><td>includeInnodbStatusInDeadlockExceptions</td><td>Include the output of "SHOW ENGINE INNODB STATUS" in exception messages
                when deadlock exceptions are detected?</td><td>false</td><td>5.0.7</td></tr><tr><td>includeThreadDumpInDeadlockExceptions</td><td>Include a current Java thread dump in exception messages when deadlock
                exceptions are detected?</td><td>false</td><td>5.1.15</td></tr><tr><td>includeThreadNamesAsStatementComment</td><td>Include the name of the current thread as a comment visible in "SHOW
                PROCESSLIST", or in Innodb deadlock dumps, useful in
                correlation with
                "includeInnodbStatusInDeadlockExceptions=true" and
                "includeThreadDumpInDeadlockExceptions=true".</td><td>false</td><td>5.1.15</td></tr><tr><td>logSlowQueries</td><td>Should queries that take longer than 'slowQueryThresholdMillis' be
                logged?</td><td>false</td><td>3.1.2</td></tr><tr><td>logXaCommands</td><td>Should the driver log XA commands sent by MysqlXaConnection to the
                server, at the DEBUG level of logging?</td><td>false</td><td>5.0.5</td></tr><tr><td>profilerEventHandler</td><td>Name of a class that implements the interface
                com.mysql.jdbc.profiler.ProfilerEventHandler that will
                be used to handle profiling/tracing events.</td><td>com.mysql.jdbc.profiler.LoggingProfilerEventHandler</td><td>5.1.6</td></tr><tr><td>resultSetSizeThreshold</td><td>If the usage advisor is enabled, how many rows should a result set
                contain before the driver warns that it is suspiciously
                large?</td><td>100</td><td>5.0.5</td></tr><tr><td>traceProtocol</td><td>Should trace-level network protocol be logged?</td><td>false</td><td>3.1.2</td></tr><tr><td>useNanosForElapsedTime</td><td>For profiling/debugging functionality that measures elapsed time, should
                the driver try to use nanoseconds resolution if
                available (JDK &gt;= 1.5)?</td><td>false</td><td>5.0.7</td></tr></tbody></table></div><p>
    </p><p><b>Miscellaneous. </b>
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong> Property Name </strong></span></td><td><span class="bold"><strong> Definition </strong></span></td><td><span class="bold"><strong> Default Value </strong></span></td><td><span class="bold"><strong> Since Version </strong></span></td></tr><tr><td>useUnicode</td><td>Forces the driver to use Unicode character encodings. Should only be set
                to false either when the driver can't determine the
                character set mapping (in which case, specify the Java
                character encoding in the characterEncoding property),
                or you are trying to force the driver to use a character
                set that MySQL doesn't natively support. Should be
                'true' for all versions of MySQL 4.1 or higher unless
                you are trying to emulate the character set handling
                support provided in MySQL 4.0. Value is true/false,
                defaults to 'true'</td><td>true</td><td>1.1g</td></tr><tr><td>characterEncoding</td><td>If 'useUnicode' is set to true, what Java character encoding should the
                driver use when dealing with strings? (defaults is to
                'autodetect'). If the encoding cannot be determined,
                then an exception will be raised.</td><td> </td><td>1.1g</td></tr><tr><td>characterSetResults</td><td>Character set to tell the server to return results as.</td><td> </td><td>3.0.13</td></tr><tr><td>connectionCollation</td><td>If set, tells the server to use this collation via 'set
                collation_connection'</td><td> </td><td>3.0.13</td></tr><tr><td>useBlobToStoreUTF8OutsideBMP</td><td>Tells the driver to treat [MEDIUM/LONG]BLOB columns as [LONG]VARCHAR
                columns holding text encoded in UTF-8 that has
                characters outside the BMP (4-byte encodings), which
                MySQL server can't handle natively.</td><td>false</td><td>5.1.3</td></tr><tr><td>utf8OutsideBmpExcludedColumnNamePattern</td><td>When "useBlobToStoreUTF8OutsideBMP" is set to "true", column names
                matching the given regex will still be treated as BLOBs
                unless they match the regex specified for
                "utf8OutsideBmpIncludedColumnNamePattern". The regex
                must follow the patterns used for the java.util.regex
                package.</td><td> </td><td>5.1.3</td></tr><tr><td>utf8OutsideBmpIncludedColumnNamePattern</td><td>Used to specify exclusion rules to
                "utf8OutsideBmpExcludedColumnNamePattern". The regex
                must follow the patterns used for the java.util.regex
                package.</td><td> </td><td>5.1.3</td></tr><tr><td>loadBalanceEnableJMX</td><td>Enables JMX-based management of load-balanced connection groups,
                including live addition/removal of hosts from
                load-balancing pool.</td><td>false</td><td>5.1.13</td></tr><tr><td>sessionVariables</td><td>A comma-separated list of name/value pairs to be sent as SET SESSION ...
                to the server when the driver connects.</td><td> </td><td>3.1.8</td></tr><tr><td>useColumnNamesInFindColumn</td><td>Prior to JDBC-4.0, the JDBC specification had a bug related to what
                could be given as a "column name" to ResultSet methods
                like findColumn(), or getters that took a String
                property. JDBC-4.0 clarified "column name" to mean the
                label, as given in an "AS" clause and returned by
                ResultSetMetaData.getColumnLabel(), and if no AS clause,
                the column name. Setting this property to "true" will
                give behavior that is congruent to JDBC-3.0 and earlier
                versions of the JDBC specification, but which because of
                the specification bug could give unexpected results.
                This property is preferred over
                "useOldAliasMetadataBehavior" unless you need the
                specific behavior that it provides with respect to
                ResultSetMetadata.</td><td>false</td><td>5.1.7</td></tr><tr><td>allowNanAndInf</td><td>Should the driver allow NaN or +/- INF values in
                PreparedStatement.setDouble()?</td><td>false</td><td>3.1.5</td></tr><tr><td>autoClosePStmtStreams</td><td>Should the driver automatically call .close() on streams/readers passed
                as arguments via set*() methods?</td><td>false</td><td>3.1.12</td></tr><tr><td>autoDeserialize</td><td>Should the driver automatically detect and de-serialize objects stored
                in BLOB fields?</td><td>false</td><td>3.1.5</td></tr><tr><td>blobsAreStrings</td><td>Should the driver always treat BLOBs as Strings - specifically to work
                around dubious metadata returned by the server for GROUP
                BY clauses?</td><td>false</td><td>5.0.8</td></tr><tr><td>capitalizeTypeNames</td><td>Capitalize type names in DatabaseMetaData? (usually only useful when
                using WebObjects, true/false, defaults to 'false')</td><td>true</td><td>2.0.7</td></tr><tr><td>clobCharacterEncoding</td><td>The character encoding to use for sending and retrieving TEXT,
                MEDIUMTEXT and LONGTEXT values instead of the configured
                connection characterEncoding</td><td> </td><td>5.0.0</td></tr><tr><td>clobberStreamingResults</td><td>This will cause a 'streaming' ResultSet to be automatically closed, and
                any outstanding data still streaming from the server to
                be discarded if another query is executed before all the
                data has been read from the server.</td><td>false</td><td>3.0.9</td></tr><tr><td>compensateOnDuplicateKeyUpdateCounts</td><td>Should the driver compensate for the update counts of "ON DUPLICATE KEY"
                INSERT statements (2 = 1, 0 = 1) when using prepared
                statements?</td><td>false</td><td>5.1.7</td></tr><tr><td>continueBatchOnError</td><td>Should the driver continue processing batch commands if one statement
                fails. The JDBC spec allows either way (defaults to
                'true').</td><td>true</td><td>3.0.3</td></tr><tr><td>createDatabaseIfNotExist</td><td>Creates the database given in the URL if it doesn't yet exist. Assumes
                the configured user has permissions to create databases.</td><td>false</td><td>3.1.9</td></tr><tr><td>emptyStringsConvertToZero</td><td>Should the driver allow conversions from empty string fields to numeric
                values of '0'?</td><td>true</td><td>3.1.8</td></tr><tr><td>emulateLocators</td><td>Should the driver emulate java.sql.Blobs with locators? With this
                feature enabled, the driver will delay loading the
                actual Blob data until the one of the retrieval methods
                (getInputStream(), getBytes(), and so forth) on the blob
                data stream has been accessed. For this to work, you
                must use a column alias with the value of the column to
                the actual name of the Blob. The feature also has the
                following restrictions: The SELECT that created the
                result set must reference only one table, the table must
                have a primary key; the SELECT must alias the original
                blob column name, specified as a string, to an alternate
                name; the SELECT must cover all columns that make up the
                primary key.</td><td>false</td><td>3.1.0</td></tr><tr><td>emulateUnsupportedPstmts</td><td>Should the driver detect prepared statements that are not supported by
                the server, and replace them with client-side emulated
                versions?</td><td>true</td><td>3.1.7</td></tr><tr><td>exceptionInterceptors</td><td>Comma-delimited list of classes that implement
                com.mysql.jdbc.ExceptionInterceptor. These classes will
                be instantiated one per Connection instance, and all
                SQLExceptions thrown by the driver will be allowed to be
                intercepted by these interceptors, in a chained fashion,
                with the first class listed as the head of the chain.</td><td> </td><td>5.1.8</td></tr><tr><td>functionsNeverReturnBlobs</td><td>Should the driver always treat data from functions returning BLOBs as
                Strings - specifically to work around dubious metadata
                returned by the server for GROUP BY clauses?</td><td>false</td><td>5.0.8</td></tr><tr><td>generateSimpleParameterMetadata</td><td>Should the driver generate simplified parameter metadata for
                PreparedStatements when no metadata is available either
                because the server couldn't support preparing the
                statement, or server-side prepared statements are
                disabled?</td><td>false</td><td>5.0.5</td></tr><tr><td>ignoreNonTxTables</td><td>Ignore non-transactional table warning for rollback? (defaults to
                'false').</td><td>false</td><td>3.0.9</td></tr><tr><td>jdbcCompliantTruncation</td><td>This sets whether Connector/J should throw java.sql.DataTruncation
                exceptions when data is truncated. This is required by
                the JDBC specification when connected to a server that
                supports warnings (MySQL 4.1.0 and newer). This property
                has no effect if the server sql-mode includes
                STRICT_TRANS_TABLES. Note that if STRICT_TRANS_TABLES is
                not set, it will be set as a result of using this
                connection string option.</td><td>true</td><td>3.1.2</td></tr><tr><td>loadBalanceAutoCommitStatementRegex</td><td>When load-balancing is enabled for auto-commit statements (via
                loadBalanceAutoCommitStatementThreshold), the statement
                counter will only increment when the SQL matches the
                regular expression. By default, every statement issued
                matches.</td><td> </td><td>5.1.15</td></tr><tr><td>loadBalanceAutoCommitStatementThreshold</td><td>When auto-commit is enabled, the number of statements which should be
                executed before triggering load-balancing to rebalance.
                Default value of 0 causes load-balanced connections to
                only rebalance when exceptions are encountered, or
                auto-commit is disabled and transactions are explicitly
                committed or rolled back.</td><td>0</td><td>5.1.15</td></tr><tr><td>loadBalanceBlacklistTimeout</td><td>Time in milliseconds between checks of servers which are unavailable.</td><td>0</td><td>5.1.0</td></tr><tr><td>loadBalanceConnectionGroup</td><td>Logical group of load-balanced connections within a classloader, used to
                manage different groups independently. If not specified,
                live management of load-balanced connections is
                disabled.</td><td> </td><td>5.1.13</td></tr><tr><td>loadBalanceExceptionChecker</td><td>Fully-qualified class name of custom exception checker. The class must
                implement com.mysql.jdbc.LoadBalanceExceptionChecker
                interface, and is used to inspect SQLExceptions and
                determine whether they should trigger fail-over to
                another host in a load-balanced deployment.</td><td>com.mysql.jdbc.StandardLoadBalanceExceptionChecker</td><td>5.1.13</td></tr><tr><td>loadBalancePingTimeout</td><td>Time in milliseconds to wait for ping response from each of
                load-balanced physical connections when using
                load-balanced Connection.</td><td>0</td><td>5.1.13</td></tr><tr><td>loadBalanceSQLExceptionSubclassFailover</td><td>Comma-delimited list of classes/interfaces used by default load-balanced
                exception checker to determine whether a given
                SQLException should trigger failover. The comparison is
                done using Class.isInstance(SQLException) using the
                thrown SQLException.</td><td> </td><td>5.1.13</td></tr><tr><td>loadBalanceSQLStateFailover</td><td>Comma-delimited list of SQLState codes used by default load-balanced
                exception checker to determine whether a given
                SQLException should trigger failover. The SQLState of a
                given SQLException is evaluated to determine whether it
                begins with any value in the comma-delimited list.</td><td> </td><td>5.1.13</td></tr><tr><td>loadBalanceValidateConnectionOnSwapServer</td><td>Should the load-balanced Connection explicitly check whether the
                connection is live when swapping to a new physical
                connection at commit/rollback?</td><td>false</td><td>5.1.13</td></tr><tr><td>maxRows</td><td>The maximum number of rows to return (0, the default means return all
                rows).</td><td>-1</td><td>all versions</td></tr><tr><td>netTimeoutForStreamingResults</td><td>What value should the driver automatically set the server setting
                'net_write_timeout' to when the streaming result sets
                feature is in use? (value has unit of seconds, the value
                '0' means the driver will not try and adjust this value)</td><td>600</td><td>5.1.0</td></tr><tr><td>noAccessToProcedureBodies</td><td>When determining procedure parameter types for CallableStatements, and
                the connected user can't access procedure bodies through
                "SHOW CREATE PROCEDURE" or select on mysql.proc should
                the driver instead create basic metadata (all parameters
                reported as IN VARCHARs, but allowing
                registerOutParameter() to be called on them anyway)
                instead of throwing an exception?</td><td>false</td><td>5.0.3</td></tr><tr><td>noDatetimeStringSync</td><td>Don't ensure that
                ResultSet.getDatetimeType().toString().equals(ResultSet.getString())</td><td>false</td><td>3.1.7</td></tr><tr><td>noTimezoneConversionForTimeType</td><td>Don't convert TIME values using the server timezone if
                'useTimezone'='true'</td><td>false</td><td>5.0.0</td></tr><tr><td>nullCatalogMeansCurrent</td><td>When DatabaseMetadataMethods ask for a 'catalog' parameter, does the
                value null mean use the current catalog? When
                nullCatalogMeansCurrent is true the current catalog will
                be used if the catalog parameter is null. If
                nullCatalogMeansCurrent is false and the catalog
                parameter is null then the catalog parameter is not used
                to restrict the catalog search. (This is not
                JDBC-compliant, but follows legacy behavior from earlier
                versions of the driver)</td><td>true</td><td>3.1.8</td></tr><tr><td>nullNamePatternMatchesAll</td><td>Should DatabaseMetaData methods that accept *pattern parameters treat
                null the same as '%' (this is not JDBC-compliant,
                however older versions of the driver accepted this
                departure from the specification)</td><td>true</td><td>3.1.8</td></tr><tr><td>overrideSupportsIntegrityEnhancementFacility</td><td>Should the driver return "true" for
                DatabaseMetaData.supportsIntegrityEnhancementFacility()
                even if the database doesn't support it to workaround
                applications that require this method to return "true"
                to signal support of foreign keys, even though the SQL
                specification states that this facility contains much
                more than just foreign key support (one such application
                being OpenOffice)?</td><td>false</td><td>3.1.12</td></tr><tr><td>padCharsWithSpace</td><td>If a result set column has the CHAR type and the value does not fill the
                amount of characters specified in the DDL for the
                column, should the driver pad the remaining characters
                with space (for ANSI compliance)?</td><td>false</td><td>5.0.6</td></tr><tr><td>pedantic</td><td>Follow the JDBC spec to the letter.</td><td>false</td><td>3.0.0</td></tr><tr><td>pinGlobalTxToPhysicalConnection</td><td>When using XAConnections, should the driver ensure that operations on a
                given XID are always routed to the same physical
                connection? This allows the XAConnection to support "XA
                START ... JOIN" after "XA END" has been called</td><td>false</td><td>5.0.1</td></tr><tr><td>populateInsertRowWithDefaultValues</td><td>When using ResultSets that are CONCUR_UPDATABLE, should the driver
                pre-populate the "insert" row with default values from
                the DDL for the table used in the query so those values
                are immediately available for ResultSet accessors? This
                functionality requires a call to the database for
                metadata each time a result set of this type is created.
                If disabled (the default), the default values will be
                populated by the an internal call to refreshRow() which
                pulls back default values and/or values changed by
                triggers.</td><td>false</td><td>5.0.5</td></tr><tr><td>processEscapeCodesForPrepStmts</td><td>Should the driver process escape codes in queries that are prepared?</td><td>true</td><td>3.1.12</td></tr><tr><td>queryTimeoutKillsConnection</td><td>If the timeout given in Statement.setQueryTimeout() expires, should the
                driver forcibly abort the Connection instead of
                attempting to abort the query?</td><td>false</td><td>5.1.9</td></tr><tr><td>relaxAutoCommit</td><td>If the version of MySQL the driver connects to does not support
                transactions, still allow calls to commit(), rollback()
                and setAutoCommit() (true/false, defaults to 'false')?</td><td>false</td><td>2.0.13</td></tr><tr><td>retainStatementAfterResultSetClose</td><td>Should the driver retain the Statement reference in a ResultSet after
                ResultSet.close() has been called. This is not
                JDBC-compliant after JDBC-4.0.</td><td>false</td><td>3.1.11</td></tr><tr><td>rollbackOnPooledClose</td><td>Should the driver issue a rollback() when the logical connection in a
                pool is closed?</td><td>true</td><td>3.0.15</td></tr><tr><td>runningCTS13</td><td>Enables workarounds for bugs in Sun's JDBC compliance testsuite version
                1.3</td><td>false</td><td>3.1.7</td></tr><tr><td>serverTimezone</td><td>Override detection/mapping of timezone. Used when timezone from server
                doesn't map to Java timezone</td><td> </td><td>3.0.2</td></tr><tr><td>statementInterceptors</td><td>A comma-delimited list of classes that implement
                "com.mysql.jdbc.StatementInterceptor" that should be
                placed "in between" query execution to influence the
                results. StatementInterceptors are "chainable", the
                results returned by the "current" interceptor will be
                passed on to the next in in the chain, from
                left-to-right order, as specified in this property.</td><td> </td><td>5.1.1</td></tr><tr><td>strictFloatingPoint</td><td>Used only in older versions of compliance test</td><td>false</td><td>3.0.0</td></tr><tr><td>strictUpdates</td><td>Should the driver do strict checking (all primary keys selected) of
                updatable result sets (true, false, defaults to 'true')?</td><td>true</td><td>3.0.4</td></tr><tr><td>tinyInt1isBit</td><td>Should the driver treat the datatype TINYINT(1) as the BIT type (because
                the server silently converts BIT -&gt; TINYINT(1) when
                creating tables)?</td><td>true</td><td>3.0.16</td></tr><tr><td>transformedBitIsBoolean</td><td>If the driver converts TINYINT(1) to a different type, should it use
                BOOLEAN instead of BIT for future compatibility with
                MySQL-5.0, as MySQL-5.0 has a BIT type?</td><td>false</td><td>3.1.9</td></tr><tr><td>treatUtilDateAsTimestamp</td><td>Should the driver treat java.util.Date as a TIMESTAMP for the purposes
                of PreparedStatement.setObject()?</td><td>true</td><td>5.0.5</td></tr><tr><td>ultraDevHack</td><td>Create PreparedStatements for prepareCall() when required, because
                UltraDev is broken and issues a prepareCall() for _all_
                statements? (true/false, defaults to 'false')</td><td>false</td><td>2.0.3</td></tr><tr><td>useAffectedRows</td><td>Don't set the CLIENT_FOUND_ROWS flag when connecting to the server (not
                JDBC-compliant, will break most applications that rely
                on "found" rows vs. "affected rows" for DML statements),
                but does cause "correct" update counts from "INSERT ...
                ON DUPLICATE KEY UPDATE" statements to be returned by
                the server.</td><td>false</td><td>5.1.7</td></tr><tr><td>useGmtMillisForDatetimes</td><td>Convert between session timezone and GMT before creating Date and
                Timestamp instances (value of "false" is legacy
                behavior, "true" leads to more JDBC-compliant behavior.</td><td>false</td><td>3.1.12</td></tr><tr><td>useHostsInPrivileges</td><td>Add '@hostname' to users in DatabaseMetaData.getColumn/TablePrivileges()
                (true/false), defaults to 'true'.</td><td>true</td><td>3.0.2</td></tr><tr><td>useInformationSchema</td><td>When connected to MySQL-5.0.7 or newer, should the driver use the
                INFORMATION_SCHEMA to derive information used by
                DatabaseMetaData?</td><td>false</td><td>5.0.0</td></tr><tr><td>useJDBCCompliantTimezoneShift</td><td>Should the driver use JDBC-compliant rules when converting
                TIME/TIMESTAMP/DATETIME values' timezone information for
                those JDBC arguments which take a java.util.Calendar
                argument? (Notice that this option is exclusive of the
                "useTimezone=true" configuration option.)</td><td>false</td><td>5.0.0</td></tr><tr><td>useLegacyDatetimeCode</td><td>Use code for DATE/TIME/DATETIME/TIMESTAMP handling in result sets and
                statements that consistently handles timezone
                conversions from client to server and back again, or use
                the legacy code for these datatypes that has been in the
                driver for backwards-compatibility?</td><td>true</td><td>5.1.6</td></tr><tr><td>useOldAliasMetadataBehavior</td><td>Should the driver use the legacy behavior for "AS" clauses on columns
                and tables, and only return aliases (if any) for
                ResultSetMetaData.getColumnName() or
                ResultSetMetaData.getTableName() rather than the
                original column/table name? In 5.0.x, the default value
                was true.</td><td>false</td><td>5.0.4</td></tr><tr><td>useOldUTF8Behavior</td><td>Use the UTF-8 behavior the driver did when communicating with 4.0 and
                older servers</td><td>false</td><td>3.1.6</td></tr><tr><td>useOnlyServerErrorMessages</td><td>Don't prepend 'standard' SQLState error messages to error messages
                returned by the server.</td><td>true</td><td>3.0.15</td></tr><tr><td>useSSPSCompatibleTimezoneShift</td><td>If migrating from an environment that was using server-side prepared
                statements, and the configuration property
                "useJDBCCompliantTimeZoneShift" set to "true", use
                compatible behavior when not using server-side prepared
                statements when sending TIMESTAMP values to the MySQL
                server.</td><td>false</td><td>5.0.5</td></tr><tr><td>useServerPrepStmts</td><td>Use server-side prepared statements if the server supports them?</td><td>false</td><td>3.1.0</td></tr><tr><td>useSqlStateCodes</td><td>Use SQL Standard state codes instead of 'legacy' X/Open/SQL state codes
                (true/false), default is 'true'</td><td>true</td><td>3.1.3</td></tr><tr><td>useStreamLengthsInPrepStmts</td><td>Honor stream length parameter in
                PreparedStatement/ResultSet.setXXXStream() method calls
                (true/false, defaults to 'true')?</td><td>true</td><td>3.0.2</td></tr><tr><td>useTimezone</td><td>Convert time/date types between client and server timezones (true/false,
                defaults to 'false')?</td><td>false</td><td>3.0.2</td></tr><tr><td>useUnbufferedInput</td><td>Don't use BufferedInputStream for reading data from the server</td><td>true</td><td>3.0.11</td></tr><tr><td>yearIsDateType</td><td>Should the JDBC driver treat the MySQL type "YEAR" as a java.sql.Date,
                or as a SHORT?</td><td>true</td><td>3.1.9</td></tr><tr><td>zeroDateTimeBehavior</td><td>What should happen when the driver encounters DATETIME values that are
                composed entirely of zeros (used by MySQL to represent
                invalid dates)? Valid values are "exception", "round"
                and "convertToNull".</td><td>exception</td><td>3.1.4</td></tr></tbody></table></div><p>
    </p><p>
        Connector/J also supports access to MySQL using named pipes on
        Windows NT/2000/XP using the
        <span class="property">NamedPipeSocketFactory</span> as a plugin-socket
        factory using the <span class="property">socketFactory</span> property.
        If you do not use a <span class="property">namedPipePath</span> property,
        the default of '\\.\pipe\MySQL' will be used. If you use the
        <code class="literal">NamedPipeSocketFactory</code>, the host name and
        port number values in the JDBC url will be ignored. You can
        enable this feature using:
      </p><pre class="programlisting">socketFactory=com.mysql.jdbc.NamedPipeSocketFactory
        </pre><p>
        Named pipes only work when connecting to a MySQL server on the
        same physical machine as the one the JDBC driver is being used
        on. In simple performance tests, it appears that named pipe
        access is between 30%-50% faster than the standard TCP/IP
        access. However, this varies per system, and named pipes are
        slower than TCP/IP in many Windows configurations.
      </p><p>
        You can create your own socket factories by following the
        example code in
        <code class="classname">com.mysql.jdbc.NamedPipeSocketFactory</code>, or
        <code class="classname">com.mysql.jdbc.StandardSocketFactory</code>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-implementation-notes"></a>4.2. JDBC API Implementation Notes</h2></div></div></div><p>
        MySQL Connector/J passes all of the tests in the publicly
        available version of Sun's JDBC compliance test suite. However,
        in many places the JDBC specification is vague about how certain
        functionality should be implemented, or the specification
        enables leeway in implementation.
      </p><p>
        This section gives details on a interface-by-interface level
        about how certain implementation decisions may affect how you
        use MySQL Connector/J.
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <span class="bold"><strong>Blob</strong></span>
          </p><p>
            Starting with Connector/J version 3.1.0, you can emulate
            Blobs with locators by adding the property
            'emulateLocators=true' to your JDBC URL. Using this method,
            the driver will delay loading the actual Blob data until you
            retrieve the other data and then use retrieval methods
            (<code class="function">getInputStream()</code>,
            <code class="function">getBytes()</code>, and so forth) on the blob
            data stream.
          </p><p>
            For this to work, you must use a column alias with the value
            of the column to the actual name of the Blob, for example:
          </p><pre class="programlisting">SELECT id, 'data' as blob_data from blobtable</pre><p>
            For this to work, you must also follow these rules:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                The <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> must also
                reference only one table, the table must have a primary
                key.
              </p></li><li><p>
                The <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> must alias the
                original blob column name, specified as a string, to an
                alternate name.
              </p></li><li><p>
                The <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> must cover all
                columns that make up the primary key.
              </p></li></ul></div><p>
            The Blob implementation does not allow in-place modification
            (they are copies, as reported by the
            <code class="literal">DatabaseMetaData.locatorsUpdateCopies()</code>
            method). Because of this, you should use the corresponding
            <code class="literal">PreparedStatement.setBlob()</code> or
            <code class="literal">ResultSet.updateBlob()</code> (in the case of
            updatable result sets) methods to save changes back to the
            database.
          </p></li><li><p>
            <span class="bold"><strong>CallableStatement</strong></span>
          </p><p>
            Starting with Connector/J 3.1.1, stored procedures are
            supported when connecting to MySQL version 5.0 or newer
            using the <code class="classname">CallableStatement</code>
            interface. Currently, the
            <code class="function">getParameterMetaData()</code> method of
            <code class="classname">CallableStatement</code> is not supported.
          </p></li><li><p>
            <span class="bold"><strong>Clob</strong></span>
          </p><p>
            The Clob implementation does not allow in-place modification
            (they are copies, as reported by the
            <code class="literal">DatabaseMetaData.locatorsUpdateCopies()</code>
            method). Because of this, you should use the
            <code class="literal">PreparedStatement.setClob()</code> method to
            save changes back to the database. The JDBC API does not
            have a <code class="literal">ResultSet.updateClob()</code> method.
          </p></li><li><p>
            <span class="bold"><strong>Connection</strong></span>
          </p><p>
            Unlike older versions of MM.MySQL the
            <code class="function">isClosed()</code> method does not ping the
            server to determine if it is available. In accordance with
            the JDBC specification, it only returns true if
            <code class="function">closed()</code> has been called on the
            connection. If you need to determine if the connection is
            still valid, you should issue a simple query, such as
            <code class="literal">SELECT 1</code>. The driver will throw an
            exception if the connection is no longer valid.
          </p></li><li><p>
            <span class="bold"><strong>DatabaseMetaData</strong></span>
          </p><p>
            Foreign Key information
            (<code class="function">getImportedKeys()</code>/<code class="function">getExportedKeys()</code>
            and <code class="function">getCrossReference()</code>) is only
            available from InnoDB tables. However, the driver uses
            <a href="http://dev.mysql.com/doc/refman/5.5/en/show-create-table.html" target="_top"><code class="literal">SHOW CREATE TABLE</code></a> to retrieve
            this information, so when other storage engines support
            foreign keys, the driver will transparently support them as
            well.
          </p></li><li><p>
            <span class="bold"><strong>PreparedStatement</strong></span>
          </p><p>
            PreparedStatements are implemented by the driver, as MySQL
            does not have a prepared statement feature. Because of this,
            the driver does not implement
            <code class="function">getParameterMetaData()</code> or
            <code class="function">getMetaData()</code> as it would require the
            driver to have a complete SQL parser in the client.
          </p><p>
            Starting with version 3.1.0 MySQL Connector/J, server-side
            prepared statements and binary-encoded result sets are used
            when the server supports them.
          </p><p>
            Take care when using a server-side prepared statement with
            <span class="bold"><strong>large</strong></span> parameters that are
            set using <code class="function">setBinaryStream()</code>,
            <code class="function">setAsciiStream()</code>,
            <code class="function">setUnicodeStream()</code>,
            <code class="function">setBlob()</code>, or
            <code class="function">setClob()</code>. If you want to re-execute
            the statement with any large parameter changed to a nonlarge
            parameter, it is necessary to call
            <code class="function">clearParameters()</code> and set all
            parameters again. The reason for this is as follows:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                During both server-side prepared statements and
                client-side emulation, large data is exchanged only when
                <code class="literal">PreparedStatement.execute()</code> is
                called.
              </p></li></ul></div><div class="itemizedlist"><ul type="circle"><li><p>
                Once that has been done, the stream used to read the
                data on the client side is closed (as per the JDBC
                spec), and cannot be read from again.
              </p></li></ul></div><div class="itemizedlist"><ul type="circle"><li><p>
                If a parameter changes from large to nonlarge, the
                driver must reset the server-side state of the prepared
                statement to allow the parameter that is being changed
                to take the place of the prior large value. This removes
                all of the large data that has already been sent to the
                server, thus requiring the data to be re-sent, using the
                <code class="function">setBinaryStream()</code>,
                <code class="function">setAsciiStream()</code>,
                <code class="function">setUnicodeStream()</code>,
                <code class="function">setBlob()</code> or
                <code class="function">setClob()</code> method.
              </p></li></ul></div><p>
            Consequently, if you want to change the type of a parameter
            to a nonlarge one, you must call
            <code class="function">clearParameters()</code> and set all
            parameters of the prepared statement again before it can be
            re-executed.
          </p></li><li><p>
            <span class="bold"><strong>ResultSet</strong></span>
          </p><p>
            By default, ResultSets are completely retrieved and stored
            in memory. In most cases this is the most efficient way to
            operate, and due to the design of the MySQL network protocol
            is easier to implement. If you are working with ResultSets
            that have a large number of rows or large values, and can
            not allocate heap space in your JVM for the memory required,
            you can tell the driver to stream the results back one row
            at a time.
          </p><p>
            To enable this functionality, you need to create a Statement
            instance in the following manner:
          </p><pre class="programlisting">stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,
              java.sql.ResultSet.CONCUR_READ_ONLY);
stmt.setFetchSize(Integer.MIN_VALUE);</pre><p>
            The combination of a forward-only, read-only result set,
            with a fetch size of <code class="literal">Integer.MIN_VALUE</code>
            serves as a signal to the driver to stream result sets
            row-by-row. After this any result sets created with the
            statement will be retrieved row-by-row.
          </p><p>
            There are some caveats with this approach. You will have to
            read all of the rows in the result set (or close it) before
            you can issue any other queries on the connection, or an
            exception will be thrown.
          </p><p>
            The earliest the locks these statements hold can be released
            (whether they be <code class="literal">MyISAM</code> table-level locks
            or row-level locks in some other storage engine such as
            <code class="literal">InnoDB</code>) is when the statement completes.
          </p><p>
            If the statement is within scope of a transaction, then
            locks are released when the transaction completes (which
            implies that the statement needs to complete first). As with
            most other databases, statements are not complete until all
            the results pending on the statement are read or the active
            result set for the statement is closed.
          </p><p>
            Therefore, if using streaming results, you should process
            them as quickly as possible if you want to maintain
            concurrent access to the tables referenced by the statement
            producing the result set.
          </p></li><li><p>
            <span class="bold"><strong>ResultSetMetaData</strong></span>
          </p><p>
            The <code class="function">isAutoIncrement()</code> method only works
            when using MySQL servers 4.0 and newer.
          </p></li><li><p>
            <span class="bold"><strong>Statement</strong></span>
          </p><p>
            When using versions of the JDBC driver earlier than 3.2.1,
            and connected to server versions earlier than 5.0.3, the
            <code class="function">setFetchSize()</code> method has no effect,
            other than to toggle result set streaming as described
            above.
          </p><p>
            Connector/J 5.0.0 and later include support for both
            <code class="literal">Statement.cancel()</code> and
            <code class="literal">Statement.setQueryTimeout()</code>. Both require
            MySQL 5.0.0 or newer server, and require a separate
            connection to issue the
            <a href="http://dev.mysql.com/doc/refman/5.5/en/kill.html" target="_top"><code class="literal">KILL QUERY</code></a>
            statement. In the case of
            <code class="function">setQueryTimeout()</code>, the implementation
            creates an additional thread to handle the timeout
            functionality.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
              Failures to cancel the statement for
              <code class="function">setQueryTimeout()</code> may manifest
              themselves as <code class="literal">RuntimeException</code> rather
              than failing silently, as there is currently no way to
              unblock the thread that is executing the query being
              cancelled due to timeout expiration and have it throw the
              exception instead.
            </p></div><p>
            MySQL does not support SQL cursors, and the JDBC driver
            doesn't emulate them, so "setCursorName()" has no effect.
          </p><p>
            Connector/J 5.1.3 and later include two additional methods:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="function">setLocalInfileInputStream()</code> sets an
                <code class="literal">InputStream</code> instance that will be
                used to send data to the MySQL server for a
                <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA
                LOCAL INFILE</code></a> statement rather than a
                <code class="literal">FileInputStream</code> or
                <code class="literal">URLInputStream</code> that represents the
                path given as an argument to the statement.
              </p><p>
                This stream will be read to completion upon execution of
                a <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA
                LOCAL INFILE</code></a> statement, and will automatically
                be closed by the driver, so it needs to be reset before
                each call to <code class="literal">execute*()</code> that would
                cause the MySQL server to request data to fulfill the
                request for
                <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA
                LOCAL INFILE</code></a>.
              </p><p>
                If this value is set to <code class="literal">NULL</code>, the
                driver will revert to using a
                <code class="literal">FileInputStream</code> or
                <code class="literal">URLInputStream</code> as required.
              </p></li><li><p>
                <code class="function">getLocalInfileInputStream()</code> returns
                the <code class="literal">InputStream</code> instance that will be
                used to send data in response to a
                <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA
                LOCAL INFILE</code></a> statement.
              </p><p>
                This method returns <code class="literal">NULL</code> if no such
                stream has been set using
                <code class="function">setLocalInfileInputStream()</code>.
              </p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-type-conversions"></a>4.3. Java, JDBC and MySQL Types</h2></div></div></div><p>
        MySQL Connector/J is flexible in the way it handles conversions
        between MySQL data types and Java data types.
      </p><p>
        In general, any MySQL data type can be converted to a
        java.lang.String, and any numeric type can be converted to any
        of the Java numeric types, although round-off, overflow, or loss
        of precision may occur.
      </p><p>
        Starting with Connector/J 3.1.0, the JDBC driver will issue
        warnings or throw DataTruncation exceptions as is required by
        the JDBC specification unless the connection was configured not
        to do so by using the property
        <span class="property">jdbcCompliantTruncation</span> and setting it to
        <code class="literal">false</code>.
      </p><p>
        The conversions that are always guaranteed to work are listed in
        the following table:
      </p><p><b>Connection Properties - Miscellaneous. </b>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>These MySQL Data Types</th><th>Can always be converted to these Java types</th></tr></thead><tbody><tr><td><code class="literal">CHAR, VARCHAR, BLOB, TEXT, ENUM, and SET</code></td><td><code class="literal">java.lang.String, java.io.InputStream, java.io.Reader,
                    java.sql.Blob, java.sql.Clob</code></td></tr><tr><td><code class="literal">FLOAT, REAL, DOUBLE PRECISION, NUMERIC, DECIMAL, TINYINT,
                    SMALLINT, MEDIUMINT, INTEGER, BIGINT</code></td><td><code class="literal">java.lang.String, java.lang.Short, java.lang.Integer,
                    java.lang.Long, java.lang.Double,
                    java.math.BigDecimal</code></td></tr><tr><td><code class="literal">DATE, TIME, DATETIME, TIMESTAMP</code></td><td><code class="literal">java.lang.String, java.sql.Date, java.sql.Timestamp</code></td></tr></tbody></table></div><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Round-off, overflow or loss of precision may occur if you
          choose a Java numeric data type that has less precision or
          capacity than the MySQL data type you are converting to/from.
        </p></div><p>
        The <code class="classname">ResultSet.getObject()</code> method uses the
        type conversions between MySQL and Java types, following the
        JDBC specification where appropriate. The value returned by
        <code class="classname">ResultSetMetaData.GetColumnClassName()</code> is
        also shown below. For more information on the
        <code class="literal">java.sql.Types</code> classes see
        <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Types.html" target="_top">Java
        2 Platform Types</a>.
      </p><p><b>MySQL Types to Java Types for ResultSet.getObject(). </b>
          </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>MySQL Type Name</th><th>Return value of <code class="literal">GetColumnClassName</code></th><th>Returned as Java Class</th></tr></thead><tbody><tr><td><span class="type">BIT(1)</span> (new in MySQL-5.0)</td><td><span class="type">BIT</span></td><td><code class="classname">java.lang.Boolean</code></td></tr><tr><td><span class="type">BIT( &gt; 1)</span> (new in MySQL-5.0)</td><td><span class="type">BIT</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">TINYINT</span></td><td><span class="type">TINYINT</span></td><td><code class="classname">java.lang.Boolean</code> if the configuration property
                    <code class="literal">tinyInt1isBit</code> is set to
                    <code class="literal">true</code> (the default) and the
                    storage size is 1, or
                    <code class="classname">java.lang.Integer</code> if not.</td></tr><tr><td><span class="type">BOOL</span>, <span class="type">BOOLEAN</span></td><td><span class="type">TINYINT</span></td><td>See <span class="type">TINYINT</span>, above as these are aliases for
                    <span class="type">TINYINT(1)</span>, currently.</td></tr><tr><td><span class="type">SMALLINT[(M)] [UNSIGNED]</span></td><td><span class="type">SMALLINT [UNSIGNED]</span></td><td><code class="classname">java.lang.Integer</code> (regardless if UNSIGNED or not)</td></tr><tr><td><span class="type">MEDIUMINT[(M)] [UNSIGNED]</span></td><td><span class="type">MEDIUMINT [UNSIGNED]</span></td><td><code class="classname">java.lang.Integer,</code> if UNSIGNED
                    <code class="classname">java.lang.Long</code> (C/J 3.1 and
                    earlier), or
                    <code class="classname">java.lang.Integer</code> for C/J 5.0
                    and later</td></tr><tr><td><span class="type">INT,INTEGER[(M)] [UNSIGNED]</span></td><td><span class="type">INTEGER [UNSIGNED]</span></td><td><code class="classname">java.lang.Integer</code>, if UNSIGNED
                    <code class="classname">java.lang.Long</code></td></tr><tr><td><span class="type">BIGINT[(M)] [UNSIGNED]</span></td><td><span class="type">BIGINT [UNSIGNED]</span></td><td><code class="classname">java.lang.Long</code>, if UNSIGNED
                    <code class="classname">java.math.BigInteger</code></td></tr><tr><td><span class="type">FLOAT[(M,D)]</span></td><td><span class="type">FLOAT</span></td><td><code class="classname">java.lang.Float</code></td></tr><tr><td><span class="type">DOUBLE[(M,B)]</span></td><td><span class="type">DOUBLE</span></td><td><code class="classname">java.lang.Double</code></td></tr><tr><td><span class="type">DECIMAL[(M[,D])]</span></td><td><span class="type">DECIMAL</span></td><td><code class="classname">java.math.BigDecimal</code></td></tr><tr><td><span class="type">DATE</span></td><td><span class="type">DATE</span></td><td><code class="classname">java.sql.Date</code></td></tr><tr><td><span class="type">DATETIME</span></td><td><span class="type">DATETIME</span></td><td><code class="classname">java.sql.Timestamp</code></td></tr><tr><td><span class="type">TIMESTAMP[(M)]</span></td><td><span class="type">TIMESTAMP</span></td><td><code class="classname">java.sql.Timestamp</code></td></tr><tr><td><span class="type">TIME</span></td><td><span class="type">TIME</span></td><td><code class="classname">java.sql.Time</code></td></tr><tr><td><span class="type">YEAR[(2|4)]</span></td><td><span class="type">YEAR</span></td><td>If <code class="literal">yearIsDateType</code> configuration property is set to
                    false, then the returned object type is
                    <code class="classname">java.sql.Short</code>. If set to
                    true (the default) then an object of type
                    <code class="classname">java.sql.Date</code> (with the date
                    set to January 1st, at midnight).</td></tr><tr><td><span class="type">CHAR(M)</span></td><td><span class="type">CHAR</span></td><td><code class="classname">java.lang.String</code> (unless the character set for
                    the column is <span class="type">BINARY</span>, then
                    <code class="classname">byte[]</code> is returned.</td></tr><tr><td><span class="type">VARCHAR(M) [BINARY]</span></td><td><span class="type">VARCHAR</span></td><td><code class="classname">java.lang.String</code> (unless the character set for
                    the column is <span class="type">BINARY</span>, then
                    <code class="classname">byte[]</code> is returned.</td></tr><tr><td><span class="type">BINARY(M)</span></td><td><span class="type">BINARY</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">VARBINARY(M)</span></td><td><span class="type">VARBINARY</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">TINYBLOB</span></td><td><span class="type">TINYBLOB</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">TINYTEXT</span></td><td><span class="type">VARCHAR</span></td><td><code class="classname">java.lang.String</code></td></tr><tr><td><span class="type">BLOB</span></td><td><span class="type">BLOB</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">TEXT</span></td><td><span class="type">VARCHAR</span></td><td><code class="classname">java.lang.String</code></td></tr><tr><td><span class="type">MEDIUMBLOB</span></td><td><span class="type">MEDIUMBLOB</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">MEDIUMTEXT</span></td><td><span class="type">VARCHAR</span></td><td><code class="classname">java.lang.String</code></td></tr><tr><td><span class="type">LONGBLOB</span></td><td><span class="type">LONGBLOB</span></td><td><code class="classname">byte[]</code></td></tr><tr><td><span class="type">LONGTEXT</span></td><td><span class="type">VARCHAR</span></td><td><code class="classname">java.lang.String</code></td></tr><tr><td><span class="type">ENUM('value1','value2',...)</span></td><td><span class="type">CHAR</span></td><td><code class="classname">java.lang.String</code></td></tr><tr><td><span class="type">SET('value1','value2',...)</span></td><td><span class="type">CHAR</span></td><td><code class="classname">java.lang.String</code></td></tr></tbody></table></div><p>
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-charsets"></a>4.4. Using Character Sets and Unicode</h2></div></div></div><p>
        All strings sent from the JDBC driver to the server are
        converted automatically from native Java Unicode form to the
        client character encoding, including all queries sent using
        <code class="literal">Statement.execute()</code>,
        <code class="literal">Statement.executeUpdate()</code>,
        <code class="literal">Statement.executeQuery()</code> as well as all
        <code class="interfacename">PreparedStatement</code>
        and
        <code class="interfacename">CallableStatement</code>
        parameters with the exclusion of parameters set using
        <code class="function">setBytes()</code>,
        <code class="function">setBinaryStream()</code>,
        <code class="function">setAsciiStream()</code>,
        <code class="function">setUnicodeStream()</code> and
        <code class="function">setBlob()</code>.
      </p><p>
        Prior to MySQL Server 4.1, Connector/J supported a single
        character encoding per connection, which could either be
        automatically detected from the server configuration, or could
        be configured by the user through the
        <em class="parameter"><code>useUnicode</code></em> and
        <em class="parameter"><code>characterEncoding</code></em> properties.
      </p><p>
        Starting with MySQL Server 4.1, Connector/J supports a single
        character encoding between client and server, and any number of
        character encodings for data returned by the server to the
        client in <code class="classname">ResultSets</code>.
      </p><p>
        The character encoding between client and server is
        automatically detected upon connection. The encoding used by the
        driver is specified on the server using the
        <code class="literal">character_set</code> system variable for server
        versions older than 4.1.0 and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_server" target="_top"><code class="literal">character_set_server</code></a> for server
        versions 4.1.0 and newer. For more information, see
        <a href="http://dev.mysql.com/doc/refman/5.5/en/charset-server.html" target="_top">Server Character Set and Collation</a>.
      </p><p>
        To override the automatically detected encoding on the client
        side, use the <em class="parameter"><code>characterEncoding</code></em> property
        in the URL used to connect to the server.
      </p><p>
        When specifying character encodings on the client side,
        Java-style names should be used. The following table lists
        Java-style names for MySQL character sets:
      </p><p><b>MySQL to Java Encoding Name Translations. </b>
          </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>MySQL Character Set Name</th><th>Java-Style Character Encoding Name</th></tr></thead><tbody><tr><td>ascii</td><td>US-ASCII</td></tr><tr><td>big5</td><td>Big5</td></tr><tr><td>gbk</td><td>GBK</td></tr><tr><td>sjis</td><td>SJIS (or Cp932 or MS932 for MySQL Server &lt; 4.1.11)</td></tr><tr><td>cp932</td><td>Cp932 or MS932 (MySQL Server &gt; 4.1.11)</td></tr><tr><td>gb2312</td><td>EUC_CN</td></tr><tr><td>ujis</td><td>EUC_JP</td></tr><tr><td>euckr</td><td>EUC_KR</td></tr><tr><td>latin1</td><td>Cp1252</td></tr><tr><td>latin2</td><td>ISO8859_2</td></tr><tr><td>greek</td><td>ISO8859_7</td></tr><tr><td>hebrew</td><td>ISO8859_8</td></tr><tr><td>cp866</td><td>Cp866</td></tr><tr><td>tis620</td><td>TIS620</td></tr><tr><td>cp1250</td><td>Cp1250</td></tr><tr><td>cp1251</td><td>Cp1251</td></tr><tr><td>cp1257</td><td>Cp1257</td></tr><tr><td>macroman</td><td>MacRoman</td></tr><tr><td>macce</td><td>MacCentralEurope</td></tr><tr><td>utf8</td><td>UTF-8</td></tr><tr><td>ucs2</td><td>UnicodeBig</td></tr></tbody></table></div><p>
        </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Warning</div><p>
          Do not issue the query 'set names' with Connector/J, as the
          driver will not detect that the character set has changed, and
          will continue to use the character set detected during the
          initial connection setup.
        </p></div><p>
        To allow multiple character sets to be sent from the client, the
        UTF-8 encoding should be used, either by configuring
        <code class="literal">utf8</code> as the default server character set, or
        by configuring the JDBC driver to use UTF-8 through the
        <em class="parameter"><code>characterEncoding</code></em> property.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-using-ssl"></a>4.5. Connecting Securely Using SSL</h2></div></div></div><p>
        SSL in MySQL Connector/J encrypts all data (other than the
        initial handshake) between the JDBC driver and the server. The
        performance penalty for enabling SSL is an increase in query
        processing time between 35% and 50%, depending on the size of
        the query, and the amount of data it returns.
      </p><p>
        For SSL Support to work, you must have the following:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            A JDK that includes JSSE (Java Secure Sockets Extension),
            like JDK-1.4.1 or newer. SSL does not currently work with a
            JDK that you can add JSSE to, like JDK-1.2.x or JDK-1.3.x
            due to the following JSSE bug:
            <a href="http://developer.java.sun.com/developer/bugParade/bugs/4273544.html" target="_top">http://developer.java.sun.com/developer/bugParade/bugs/4273544.html</a>
          </p></li><li><p>
            A MySQL server that supports SSL and has been compiled and
            configured to do so, which is MySQL-4.0.4 or later, see
            <a href="http://dev.mysql.com/doc/refman/5.5/en/secure-connections.html" target="_top">Using SSL for Secure Connections</a>, for more information.
          </p></li><li><p>
            A client certificate (covered later in this section)
          </p></li></ul></div><p>
        The system works through two Java truststore files, one file
        contains the certificate information for the server
        (<code class="filename">truststore</code> in the examples below). The
        other file contains the certificate for the client
        (<code class="filename">keystore</code> in the examples below). All Java
        truststore files are password protected by supplying a suitable
        password to the <span><strong class="command">keytool</strong></span> when you create the
        files. You need the file names and associated passwords to
        create an SSL connection.
      </p><p>
        You will first need to import the MySQL server CA Certificate
        into a Java truststore. A sample MySQL server CA Certificate is
        located in the <code class="filename">SSL</code> subdirectory of the
        MySQL source distribution. This is what SSL will use to
        determine if you are communicating with a secure MySQL server.
        Alternatively, use the CA Certificate that you have generated or
        been provided with by your SSL provider.
      </p><p>
        To use Java's <span><strong class="command">keytool</strong></span> to create a truststore
        in the current directory , and import the server's CA
        certificate (<code class="filename">cacert.pem</code>), you can do the
        following (assuming that <span><strong class="command">keytool</strong></span> is in your
        path. The <span><strong class="command">keytool</strong></span> should be located in the
        <code class="filename">bin</code> subdirectory of your JDK or JRE):
      </p><pre class="programlisting">shell&gt; keytool -import -alias mysqlServerCACert \
                                  -file cacert.pem -keystore truststore</pre><p>
        You will need to enter the password when prompted for the
        keystore file. Interaction with <span><strong class="command">keytool</strong></span> will
        look like this:
      </p><pre class="programlisting">Enter keystore password:  *********
Owner: EMAILADDRESS=walrus@example.com, CN=Walrus,
       O=MySQL AB, L=Orenburg, ST=Some-State, C=RU
Issuer: EMAILADDRESS=walrus@example.com, CN=Walrus,
       O=MySQL AB, L=Orenburg, ST=Some-State, C=RU
Serial number: 0
Valid from:
   Fri Aug 02 16:55:53 CDT 2002 until: Sat Aug 02 16:55:53 CDT 2003
Certificate fingerprints:
    MD5:  61:91:A0:F2:03:07:61:7A:81:38:66:DA:19:C4:8D:AB
    SHA1: 25:77:41:05:D5:AD:99:8C:14:8C:CA:68:9C:2F:B8:89:C3:34:4D:6C
Trust this certificate? [no]:  yes
Certificate was added to keystore</pre><p>
        You then have two options, you can either import the client
        certificate that matches the CA certificate you just imported,
        or you can create a new client certificate.
      </p><p>
        To import an existing certificate, the certificate should be in
        DER format. You can use <span><strong class="command">openssl</strong></span> to convert an
        existing certificate into the new format. For example:
      </p><pre class="programlisting">shell&gt; openssl x509 -outform DER -in client-cert.pem -out client.cert
      </pre><p>
        You now need to import the converted certificate into your
        keystore using <span><strong class="command">keytool</strong></span>:
      </p><pre class="programlisting">shell&gt; keytool -import -file client.cert -keystore keystore -alias mysqlClientCertificate
</pre><p>
        To generate your own client certificate, use
        <span><strong class="command">keytool</strong></span> to create a suitable certificate and
        add it to the <code class="filename">keystore</code> file:
      </p><pre class="programlisting"> shell&gt; keytool -genkey -keyalg rsa \
     -alias mysqlClientCertificate -keystore keystore </pre><p>
        Keytool will prompt you for the following information, and
        create a keystore named <code class="filename">keystore</code> in the
        current directory.
      </p><p>
        You should respond with information that is appropriate for your
        situation:
      </p><pre class="programlisting">Enter keystore password:  *********
What is your first and last name?
  [Unknown]:  Matthews
What is the name of your organizational unit?
  [Unknown]:  Software Development
What is the name of your organization?
  [Unknown]:  MySQL AB
What is the name of your City or Locality?
  [Unknown]:  Flossmoor
What is the name of your State or Province?
  [Unknown]:  IL
What is the two-letter country code for this unit?
  [Unknown]:  US
Is &lt;CN=Matthews, OU=Software Development, O=MySQL AB,
 L=Flossmoor, ST=IL, C=US&gt; correct?
  [no]:  y
Enter key password for &lt;mysqlClientCertificate&gt;
        (RETURN if same as keystore password):</pre><p>
        Finally, to get JSSE to use the keystore and truststore that you
        have generated, you need to set the following system properties
        when you start your JVM, replacing
        <span class="property">path_to_keystore_file</span> with the full path to
        the keystore file you created,
        <span class="property">path_to_truststore_file</span> with the path to
        the truststore file you created, and using the appropriate
        password values for each property. You can do this either on the
        command line:
      </p><pre class="programlisting">-Djavax.net.ssl.keyStore=path_to_keystore_file
-Djavax.net.ssl.keyStorePassword=password
-Djavax.net.ssl.trustStore=path_to_truststore_file
-Djavax.net.ssl.trustStorePassword=password </pre><p>
        Or you can set the values directly within the application:
      </p><pre class="programlisting"> System.setProperty("javax.net.ssl.keyStore","path_to_keystore_file");
System.setProperty("javax.net.ssl.keyStorePassword","password");
System.setProperty("javax.net.ssl.trustStore","path_to_truststore_file");
System.setProperty("javax.net.ssl.trustStorePassword","password");</pre><p>
        You will also need to set <span class="property">useSSL</span> to
        <code class="literal">true</code> in your connection parameters for MySQL
        Connector/J, either by adding <code class="literal">useSSL=true</code> to
        your URL, or by setting the property <span class="property">useSSL</span>
        to <code class="literal">true</code> in the
        <code class="classname">java.util.Properties</code> instance you pass to
        <code class="literal">DriverManager.getConnection()</code>.
      </p><p>
        You can test that SSL is working by turning on JSSE debugging
        (as detailed below), and look for the following key events:
      </p><pre class="programlisting">...
*** ClientHello, v3.1
RandomCookie:  GMT: 1018531834 bytes = { 199, 148, 180, 215, 74, 12, »
  54, 244, 0, 168, 55, 103, 215, 64, 16, 138, 225, 190, 132, 153, 2, »
  217, 219, 239, 202, 19, 121, 78 }
Session ID:  {}
Cipher Suites:  { 0, 5, 0, 4, 0, 9, 0, 10, 0, 18, 0, 19, 0, 3, 0, 17 }
Compression Methods:  { 0 }
***
[write] MD5 and SHA1 hashes:  len = 59
0000: 01 00 00 37 03 01 3D B6 90 FA C7 94 B4 D7 4A 0C  ...7..=.......J.
0010: 36 F4 00 A8 37 67 D7 40 10 8A E1 BE 84 99 02 D9  6...7g.@........
0020: DB EF CA 13 79 4E 00 00 10 00 05 00 04 00 09 00  ....yN..........
0030: 0A 00 12 00 13 00 03 00 11 01 00                 ...........
main, WRITE:  SSL v3.1 Handshake, length = 59
main, READ:  SSL v3.1 Handshake, length = 74
*** ServerHello, v3.1
RandomCookie:  GMT: 1018577560 bytes = { 116, 50, 4, 103, 25, 100, 58, »
   202, 79, 185, 178, 100, 215, 66, 254, 21, 83, 187, 190, 42, 170, 3, »
   132, 110, 82, 148, 160, 92 }
Session ID:  {163, 227, 84, 53, 81, 127, 252, 254, 178, 179, 68, 63, »
   182, 158, 30, 11, 150, 79, 170, 76, 255, 92, 15, 226, 24, 17, 177, »
   219, 158, 177, 187, 143}
Cipher Suite:  { 0, 5 }
Compression Method: 0
***
%% Created:  [Session-1, SSL_RSA_WITH_RC4_128_SHA]
** SSL_RSA_WITH_RC4_128_SHA
[read] MD5 and SHA1 hashes:  len = 74
0000: 02 00 00 46 03 01 3D B6 43 98 74 32 04 67 19 64  ...F..=.C.t2.g.d
0010: 3A CA 4F B9 B2 64 D7 42 FE 15 53 BB BE 2A AA 03  :.O..d.B..S..*..
0020: 84 6E 52 94 A0 5C 20 A3 E3 54 35 51 7F FC FE B2  .nR..\ ..T5Q....
0030: B3 44 3F B6 9E 1E 0B 96 4F AA 4C FF 5C 0F E2 18  .D?.....O.L.\...
0040: 11 B1 DB 9E B1 BB 8F 00 05 00                    ..........
main, READ:  SSL v3.1 Handshake, length = 1712
...</pre><p>
        JSSE provides debugging (to STDOUT) when you set the following
        system property: <code class="literal">-Djavax.net.debug=all</code> This
        will tell you what keystores and truststores are being used, as
        well as what is going on during the SSL handshake and
        certificate exchange. It will be helpful when trying to
        determine what is not working when trying to get an SSL
        connection to happen.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-replication-connection"></a>4.6. Using Master/Slave Replication with ReplicationConnection</h2></div></div></div><p>
        Starting with Connector/J 3.1.7, we've made available a variant
        of the driver that will automatically send queries to a
        read/write master, or a failover or round-robin loadbalanced set
        of slaves based on the state of
        <code class="literal">Connection.getReadOnly()</code> .
      </p><p>
        An application signals that it wants a transaction to be
        read-only by calling
        <code class="literal">Connection.setReadOnly(true)</code>, this
        replication-aware connection will use one of the slave
        connections, which are load-balanced per-vm using a round-robin
        scheme (a given connection is sticky to a slave unless that
        slave is removed from service). If you have a write transaction,
        or if you have a read that is time-sensitive (remember,
        replication in MySQL is asynchronous), set the connection to be
        not read-only, by calling
        <code class="literal">Connection.setReadOnly(false)</code> and the driver
        will ensure that further calls are sent to the master MySQL
        server. The driver takes care of propagating the current state
        of autocommit, isolation level, and catalog between all of the
        connections that it uses to accomplish this load balancing
        functionality.
      </p><p>
        To enable this functionality, use the "
        <code class="literal">com.mysql.jdbc.ReplicationDriver</code> " class when
        configuring your application server's connection pool or when
        creating an instance of a JDBC driver for your standalone
        application. Because it accepts the same URL format as the
        standard MySQL JDBC driver, <code class="literal">ReplicationDriver</code>
        does not currently work with
        <code class="literal">java.sql.DriverManager</code> -based connection
        creation unless it is the only MySQL JDBC driver registered with
        the <code class="literal">DriverManager</code> .
      </p><p>
        Here is a short, simple example of how ReplicationDriver might
        be used in a standalone application.
      </p><a name="connector-j-using-replication-driver-example"></a><pre class="programlisting">import java.sql.Connection;
import java.sql.ResultSet;
import java.util.Properties;
import com.mysql.jdbc.ReplicationDriver;
public class ReplicationDriverDemo {
  public static void main(String[] args) throws Exception {
    ReplicationDriver driver = new ReplicationDriver();
    Properties props = new Properties();
    // We want this for failover on the slaves
    props.put("autoReconnect", "true");
    // We want to load balance between the slaves
    props.put("roundRobinLoadBalance", "true");
    props.put("user", "foo");
    props.put("password", "bar");
    //
    // Looks like a normal MySQL JDBC url, with a
    // comma-separated list of hosts, the first
    // being the 'master', the rest being any number
    // of slaves that the driver will load balance against
    //
    Connection conn =
        driver.connect("jdbc:mysql:replication://master,slave1,slave2,slave3/test",
            props);
    //
    // Perform read/write work on the master
    // by setting the read-only flag to "false"
    //
    conn.setReadOnly(false);
    conn.setAutoCommit(false);
    conn.createStatement().executeUpdate("UPDATE some_table ....");
    conn.commit();
    //
    // Now, do a query from a slave, the driver automatically picks one
    // from the list
    //
    conn.setReadOnly(true);
    ResultSet rs =
      conn.createStatement().executeQuery("SELECT a,b FROM alt_table");
     .......
  }
}
</pre><p>
        You may also want to investigate the Load Balancing JDBC Pool
        (lbpol) tool, which provides a wrapper around the standard JDBC
        driver and enables you to use DB connection pools that includes
        checks for system failures and uneven load distribution. For
        more information, see
        <a href="http://code.tailrank.com/lbpool" target="_top">Load Balancing JDBC
        Pool (lbpool)</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-reference-error-sqlstates"></a>4.7. Mapping MySQL Error Numbers to SQLStates</h2></div></div></div><p>
        The table below provides a mapping of the MySQL Error Numbers to
        <code class="literal">SQL States</code>
      </p><div class="table"><a name="id238201"></a><p class="title"><b>Table 4.1. Mapping of MySQL Error Numbers to SQLStates</b></p><table summary="Mapping of MySQL Error Numbers to SQLStates" border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>MySQL Error Number</th><th>MySQL Error Name</th><th>Legacy (X/Open) SQLState</th><th>SQL Standard SQLState</th></tr></thead><tbody><tr><td>1022</td><td>ER_DUP_KEY</td><td>S1000</td><td>23000</td></tr><tr><td>1037</td><td>ER_OUTOFMEMORY</td><td>S1001</td><td>HY001</td></tr><tr><td>1038</td><td>ER_OUT_OF_SORTMEMORY</td><td>S1001</td><td>HY001</td></tr><tr><td>1040</td><td>ER_CON_COUNT_ERROR</td><td>08004</td><td>08004</td></tr><tr><td>1042</td><td>ER_BAD_HOST_ERROR</td><td>08004</td><td>08S01</td></tr><tr><td>1043</td><td>ER_HANDSHAKE_ERROR</td><td>08004</td><td>08S01</td></tr><tr><td>1044</td><td>ER_DBACCESS_DENIED_ERROR</td><td>S1000</td><td>42000</td></tr><tr><td>1045</td><td>ER_ACCESS_DENIED_ERROR</td><td>28000</td><td>28000</td></tr><tr><td>1047</td><td>ER_UNKNOWN_COM_ERROR</td><td>08S01</td><td>HY000</td></tr><tr><td>1050</td><td>ER_TABLE_EXISTS_ERROR</td><td>S1000</td><td>42S01</td></tr><tr><td>1051</td><td>ER_BAD_TABLE_ERROR</td><td>42S02</td><td>42S02</td></tr><tr><td>1052</td><td>ER_NON_UNIQ_ERROR</td><td>S1000</td><td>23000</td></tr><tr><td>1053</td><td>ER_SERVER_SHUTDOWN</td><td>S1000</td><td>08S01</td></tr><tr><td>1054</td><td>ER_BAD_FIELD_ERROR</td><td>S0022</td><td>42S22</td></tr><tr><td>1055</td><td>ER_WRONG_FIELD_WITH_GROUP</td><td>S1009</td><td>42000</td></tr><tr><td>1056</td><td>ER_WRONG_GROUP_FIELD</td><td>S1009</td><td>42000</td></tr><tr><td>1057</td><td>ER_WRONG_SUM_SELECT</td><td>S1009</td><td>42000</td></tr><tr><td>1058</td><td>ER_WRONG_VALUE_COUNT</td><td>21S01</td><td>21S01</td></tr><tr><td>1059</td><td>ER_TOO_LONG_IDENT</td><td>S1009</td><td>42000</td></tr><tr><td>1060</td><td>ER_DUP_FIELDNAME</td><td>S1009</td><td>42S21</td></tr><tr><td>1061</td><td>ER_DUP_KEYNAME</td><td>S1009</td><td>42000</td></tr><tr><td>1062</td><td>ER_DUP_ENTRY</td><td>S1009</td><td>23000</td></tr><tr><td>1063</td><td>ER_WRONG_FIELD_SPEC</td><td>S1009</td><td>42000</td></tr><tr><td>1064</td><td>ER_PARSE_ERROR</td><td>42000</td><td>42000</td></tr><tr><td>1065</td><td>ER_EMPTY_QUERY</td><td>42000</td><td>42000</td></tr><tr><td>1066</td><td>ER_NONUNIQ_TABLE</td><td>S1009</td><td>42000</td></tr><tr><td>1067</td><td>ER_INVALID_DEFAULT</td><td>S1009</td><td>42000</td></tr><tr><td>1068</td><td>ER_MULTIPLE_PRI_KEY</td><td>S1009</td><td>42000</td></tr><tr><td>1069</td><td>ER_TOO_MANY_KEYS</td><td>S1009</td><td>42000</td></tr><tr><td>1070</td><td>ER_TOO_MANY_KEY_PARTS</td><td>S1009</td><td>42000</td></tr><tr><td>1071</td><td>ER_TOO_LONG_KEY</td><td>S1009</td><td>42000</td></tr><tr><td>1072</td><td>ER_KEY_COLUMN_DOES_NOT_EXITS</td><td>S1009</td><td>42000</td></tr><tr><td>1073</td><td>ER_BLOB_USED_AS_KEY</td><td>S1009</td><td>42000</td></tr><tr><td>1074</td><td>ER_TOO_BIG_FIELDLENGTH</td><td>S1009</td><td>42000</td></tr><tr><td>1075</td><td>ER_WRONG_AUTO_KEY</td><td>S1009</td><td>42000</td></tr><tr><td>1080</td><td>ER_FORCING_CLOSE</td><td>S1000</td><td>08S01</td></tr><tr><td>1081</td><td>ER_IPSOCK_ERROR</td><td>08S01</td><td>08S01</td></tr><tr><td>1082</td><td>ER_NO_SUCH_INDEX</td><td>S1009</td><td>42S12</td></tr><tr><td>1083</td><td>ER_WRONG_FIELD_TERMINATORS</td><td>S1009</td><td>42000</td></tr><tr><td>1084</td><td>ER_BLOBS_AND_NO_TERMINATED</td><td>S1009</td><td>42000</td></tr><tr><td>1090</td><td>ER_CANT_REMOVE_ALL_FIELDS</td><td>S1000</td><td>42000</td></tr><tr><td>1091</td><td>ER_CANT_DROP_FIELD_OR_KEY</td><td>S1000</td><td>42000</td></tr><tr><td>1101</td><td>ER_BLOB_CANT_HAVE_DEFAULT</td><td>S1000</td><td>42000</td></tr><tr><td>1102</td><td>ER_WRONG_DB_NAME</td><td>S1000</td><td>42000</td></tr><tr><td>1103</td><td>ER_WRONG_TABLE_NAME</td><td>S1000</td><td>42000</td></tr><tr><td>1104</td><td>ER_TOO_BIG_SELECT</td><td>S1000</td><td>42000</td></tr><tr><td>1106</td><td>ER_UNKNOWN_PROCEDURE</td><td>S1000</td><td>42000</td></tr><tr><td>1107</td><td>ER_WRONG_PARAMCOUNT_TO_PROCEDURE</td><td>S1000</td><td>42000</td></tr><tr><td>1109</td><td>ER_UNKNOWN_TABLE</td><td>S1000</td><td>42S02</td></tr><tr><td>1110</td><td>ER_FIELD_SPECIFIED_TWICE</td><td>S1000</td><td>42000</td></tr><tr><td>1112</td><td>ER_UNSUPPORTED_EXTENSION</td><td>S1000</td><td>42000</td></tr><tr><td>1113</td><td>ER_TABLE_MUST_HAVE_COLUMNS</td><td>S1000</td><td>42000</td></tr><tr><td>1115</td><td>ER_UNKNOWN_CHARACTER_SET</td><td>S1000</td><td>42000</td></tr><tr><td>1118</td><td>ER_TOO_BIG_ROWSIZE</td><td>S1000</td><td>42000</td></tr><tr><td>1120</td><td>ER_WRONG_OUTER_JOIN</td><td>S1000</td><td>42000</td></tr><tr><td>1121</td><td>ER_NULL_COLUMN_IN_INDEX</td><td>S1000</td><td>42000</td></tr><tr><td>1129</td><td>ER_HOST_IS_BLOCKED</td><td>08004</td><td>HY000</td></tr><tr><td>1130</td><td>ER_HOST_NOT_PRIVILEGED</td><td>08004</td><td>HY000</td></tr><tr><td>1131</td><td>ER_PASSWORD_ANONYMOUS_USER</td><td>S1000</td><td>42000</td></tr><tr><td>1132</td><td>ER_PASSWORD_NOT_ALLOWED</td><td>S1000</td><td>42000</td></tr><tr><td>1133</td><td>ER_PASSWORD_NO_MATCH</td><td>S1000</td><td>42000</td></tr><tr><td>1136</td><td>ER_WRONG_VALUE_COUNT_ON_ROW</td><td>S1000</td><td>21S01</td></tr><tr><td>1138</td><td>ER_INVALID_USE_OF_NULL</td><td>S1000</td><td>42000</td></tr><tr><td>1139</td><td>ER_REGEXP_ERROR</td><td>S1000</td><td>42000</td></tr><tr><td>1140</td><td>ER_MIX_OF_GROUP_FUNC_AND_FIELDS</td><td>S1000</td><td>42000</td></tr><tr><td>1141</td><td>ER_NONEXISTING_GRANT</td><td>S1000</td><td>42000</td></tr><tr><td>1142</td><td>ER_TABLEACCESS_DENIED_ERROR</td><td>S1000</td><td>42000</td></tr><tr><td>1143</td><td>ER_COLUMNACCESS_DENIED_ERROR</td><td>S1000</td><td>42000</td></tr><tr><td>1144</td><td>ER_ILLEGAL_GRANT_FOR_TABLE</td><td>S1000</td><td>42000</td></tr><tr><td>1145</td><td>ER_GRANT_WRONG_HOST_OR_USER</td><td>S1000</td><td>42000</td></tr><tr><td>1146</td><td>ER_NO_SUCH_TABLE</td><td>S1000</td><td>42S02</td></tr><tr><td>1147</td><td>ER_NONEXISTING_TABLE_GRANT</td><td>S1000</td><td>42000</td></tr><tr><td>1148</td><td>ER_NOT_ALLOWED_COMMAND</td><td>S1000</td><td>42000</td></tr><tr><td>1149</td><td>ER_SYNTAX_ERROR</td><td>S1000</td><td>42000</td></tr><tr><td>1152</td><td>ER_ABORTING_CONNECTION</td><td>S1000</td><td>08S01</td></tr><tr><td>1153</td><td>ER_NET_PACKET_TOO_LARGE</td><td>S1000</td><td>08S01</td></tr><tr><td>1154</td><td>ER_NET_READ_ERROR_FROM_PIPE</td><td>S1000</td><td>08S01</td></tr><tr><td>1155</td><td>ER_NET_FCNTL_ERROR</td><td>S1000</td><td>08S01</td></tr><tr><td>1156</td><td>ER_NET_PACKETS_OUT_OF_ORDER</td><td>S1000</td><td>08S01</td></tr><tr><td>1157</td><td>ER_NET_UNCOMPRESS_ERROR</td><td>S1000</td><td>08S01</td></tr><tr><td>1158</td><td>ER_NET_READ_ERROR</td><td>S1000</td><td>08S01</td></tr><tr><td>1159</td><td>ER_NET_READ_INTERRUPTED</td><td>S1000</td><td>08S01</td></tr><tr><td>1160</td><td>ER_NET_ERROR_ON_WRITE</td><td>S1000</td><td>08S01</td></tr><tr><td>1161</td><td>ER_NET_WRITE_INTERRUPTED</td><td>S1000</td><td>08S01</td></tr><tr><td>1162</td><td>ER_TOO_LONG_STRING</td><td>S1000</td><td>42000</td></tr><tr><td>1163</td><td>ER_TABLE_CANT_HANDLE_BLOB</td><td>S1000</td><td>42000</td></tr><tr><td>1164</td><td>ER_TABLE_CANT_HANDLE_AUTO_INCREMENT</td><td>S1000</td><td>42000</td></tr><tr><td>1166</td><td>ER_WRONG_COLUMN_NAME</td><td>S1000</td><td>42000</td></tr><tr><td>1167</td><td>ER_WRONG_KEY_COLUMN</td><td>S1000</td><td>42000</td></tr><tr><td>1169</td><td>ER_DUP_UNIQUE</td><td>S1000</td><td>23000</td></tr><tr><td>1170</td><td>ER_BLOB_KEY_WITHOUT_LENGTH</td><td>S1000</td><td>42000</td></tr><tr><td>1171</td><td>ER_PRIMARY_CANT_HAVE_NULL</td><td>S1000</td><td>42000</td></tr><tr><td>1172</td><td>ER_TOO_MANY_ROWS</td><td>S1000</td><td>42000</td></tr><tr><td>1173</td><td>ER_REQUIRES_PRIMARY_KEY</td><td>S1000</td><td>42000</td></tr><tr><td>1177</td><td>ER_CHECK_NO_SUCH_TABLE</td><td>S1000</td><td>42000</td></tr><tr><td>1178</td><td>ER_CHECK_NOT_IMPLEMENTED</td><td>S1000</td><td>42000</td></tr><tr><td>1179</td><td>ER_CANT_DO_THIS_DURING_AN_TRANSACTION</td><td>S1000</td><td>25000</td></tr><tr><td>1184</td><td>ER_NEW_ABORTING_CONNECTION</td><td>S1000</td><td>08S01</td></tr><tr><td>1189</td><td>ER_MASTER_NET_READ</td><td>S1000</td><td>08S01</td></tr><tr><td>1190</td><td>ER_MASTER_NET_WRITE</td><td>S1000</td><td>08S01</td></tr><tr><td>1203</td><td>ER_TOO_MANY_USER_CONNECTIONS</td><td>S1000</td><td>42000</td></tr><tr><td>1205</td><td>ER_LOCK_WAIT_TIMEOUT</td><td>41000</td><td>41000</td></tr><tr><td>1207</td><td>ER_READ_ONLY_TRANSACTION</td><td>S1000</td><td>25000</td></tr><tr><td>1211</td><td>ER_NO_PERMISSION_TO_CREATE_USER</td><td>S1000</td><td>42000</td></tr><tr><td>1213</td><td>ER_LOCK_DEADLOCK</td><td>41000</td><td>40001</td></tr><tr><td>1216</td><td>ER_NO_REFERENCED_ROW</td><td>S1000</td><td>23000</td></tr><tr><td>1217</td><td>ER_ROW_IS_REFERENCED</td><td>S1000</td><td>23000</td></tr><tr><td>1218</td><td>ER_CONNECT_TO_MASTER</td><td>S1000</td><td>08S01</td></tr><tr><td>1222</td><td>ER_WRONG_NUMBER_OF_COLUMNS_IN_SELECT</td><td>S1000</td><td>21000</td></tr><tr><td>1226</td><td>ER_USER_LIMIT_REACHED</td><td>S1000</td><td>42000</td></tr><tr><td>1230</td><td>ER_NO_DEFAULT</td><td>S1000</td><td>42000</td></tr><tr><td>1231</td><td>ER_WRONG_VALUE_FOR_VAR</td><td>S1000</td><td>42000</td></tr><tr><td>1232</td><td>ER_WRONG_TYPE_FOR_VAR</td><td>S1000</td><td>42000</td></tr><tr><td>1234</td><td>ER_CANT_USE_OPTION_HERE</td><td>S1000</td><td>42000</td></tr><tr><td>1235</td><td>ER_NOT_SUPPORTED_YET</td><td>S1000</td><td>42000</td></tr><tr><td>1239</td><td>ER_WRONG_FK_DEF</td><td>S1000</td><td>42000</td></tr><tr><td>1241</td><td>ER_OPERAND_COLUMNS</td><td>S1000</td><td>21000</td></tr><tr><td>1242</td><td>ER_SUBQUERY_NO_1_ROW</td><td>S1000</td><td>21000</td></tr><tr><td>1247</td><td>ER_ILLEGAL_REFERENCE</td><td>S1000</td><td>42S22</td></tr><tr><td>1248</td><td>ER_DERIVED_MUST_HAVE_ALIAS</td><td>S1000</td><td>42000</td></tr><tr><td>1249</td><td>ER_SELECT_REDUCED</td><td>S1000</td><td>01000</td></tr><tr><td>1250</td><td>ER_TABLENAME_NOT_ALLOWED_HERE</td><td>S1000</td><td>42000</td></tr><tr><td>1251</td><td>ER_NOT_SUPPORTED_AUTH_MODE</td><td>S1000</td><td>08004</td></tr><tr><td>1252</td><td>ER_SPATIAL_CANT_HAVE_NULL</td><td>S1000</td><td>42000</td></tr><tr><td>1253</td><td>ER_COLLATION_CHARSET_MISMATCH</td><td>S1000</td><td>42000</td></tr><tr><td>1261</td><td>ER_WARN_TOO_FEW_RECORDS</td><td>S1000</td><td>01000</td></tr><tr><td>1262</td><td>ER_WARN_TOO_MANY_RECORDS</td><td>S1000</td><td>01000</td></tr><tr><td>1263</td><td>ER_WARN_NULL_TO_NOTNULL</td><td>S1000</td><td>01000</td></tr><tr><td>1264</td><td>ER_WARN_DATA_OUT_OF_RANGE</td><td>S1000</td><td>01000</td></tr><tr><td>1265</td><td>ER_WARN_DATA_TRUNCATED</td><td>S1000</td><td>01000</td></tr><tr><td>1280</td><td>ER_WRONG_NAME_FOR_INDEX</td><td>S1000</td><td>42000</td></tr><tr><td>1281</td><td>ER_WRONG_NAME_FOR_CATALOG</td><td>S1000</td><td>42000</td></tr><tr><td>1286</td><td>ER_UNKNOWN_STORAGE_ENGINE</td><td>S1000</td><td>42000</td></tr></tbody></table></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-usagenotes"></a>Chapter 5. Connector/J Notes and Tips</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#connector-j-usagenotes-basic">5.1. Basic JDBC Concepts</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-usagenotes-connect-drivermanager">5.1.1. Connecting to MySQL Using the <code class="literal">DriverManager</code> Interface</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements">5.1.2. Using Statements to Execute SQL</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements-callable">5.1.3. Using <code class="literal">CallableStatements</code> to Execute Stored Procedures</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-last-insert-id">5.1.4. Retrieving <code class="literal">AUTO_INCREMENT</code> Column Values</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-usagenotes-j2ee">5.2. Using Connector/J with J2EE and Other Java Frameworks</a></span></dt><dd><dl><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts">5.2.1. General J2EE Concepts</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-tomcat">5.2.2. Using Connector/J with Tomcat</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-jboss">5.2.3. Using Connector/J with JBoss</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-spring-config">5.2.4. Using Connector/J with Spring</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-glassfish-config">5.2.5. Using Connector/J with GlassFish</a></span></dt></dl></dd><dt><span class="section"><a href="#connector-j-usagenotes-troubleshooting">5.3. Connector/J: Common Problems and Solutions</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-usagenotes-basic"></a>5.1. Basic JDBC Concepts</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-usagenotes-connect-drivermanager">5.1.1. Connecting to MySQL Using the <code class="literal">DriverManager</code> Interface</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements">5.1.2. Using Statements to Execute SQL</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-statements-callable">5.1.3. Using <code class="literal">CallableStatements</code> to Execute Stored Procedures</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-last-insert-id">5.1.4. Retrieving <code class="literal">AUTO_INCREMENT</code> Column Values</a></span></dt></dl></div><p>
        This section provides some general JDBC background.
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-connect-drivermanager"></a>5.1.1. Connecting to MySQL Using the <code class="literal">DriverManager</code> Interface</h3></div></div></div><p>
          When you are using JDBC outside of an application server, the
          <code class="literal">DriverManager</code> class manages the
          establishment of Connections.
        </p><p>
          The <code class="literal">DriverManager</code> needs to be told which
          JDBC drivers it should try to make Connections with. The
          easiest way to do this is to use
          <code class="literal">Class.forName()</code> on the class that
          implements the <code class="literal">java.sql.Driver</code> interface.
          With MySQL Connector/J, the name of this class is
          <code class="literal">com.mysql.jdbc.Driver</code>. With this method,
          you could use an external configuration file to supply the
          driver class name and driver parameters to use when connecting
          to a database.
        </p><p>
          The following section of Java code shows how you might
          register MySQL Connector/J from the
          <code class="function">main()</code> method of your application. If
          testing this code please ensure you read the installation
          section first at <a href="#connector-j-installing" title="Chapter 2. Connector/J Installation">Chapter 2, <i>Connector/J Installation</i></a>, to
          make sure you have connector installed correctly and the
          <code class="literal">CLASSPATH</code> set up. Also, ensure that MySQL
          is configured to accept external TCP/IP connections.
        </p><pre class="programlisting">import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
// Notice, do not import com.mysql.jdbc.*
// or you will have problems!
public class LoadDriver {
    public static void main(String[] args) {
        try {
            // The newInstance() call is a work around for some
            // broken Java implementations
            Class.forName("com.mysql.jdbc.Driver").newInstance();
        } catch (Exception ex) {
            // handle the error
        }
    }
}</pre><p>
          After the driver has been registered with the
          <code class="literal">DriverManager</code>, you can obtain a
          <code class="literal">Connection</code> instance that is connected to a
          particular database by calling
          <code class="literal">DriverManager.getConnection()</code>:
        </p><div class="example"><a name="connector-j-examples-connection-drivermanager"></a><p class="title"><b>Example 5.1. Connector/J: Obtaining a connection from the
            <code class="literal">DriverManager</code></b></p><p>
            If you have not already done so, please review the section
            <a href="#connector-j-usagenotes-connect-drivermanager" title="5.1.1. Connecting to MySQL Using the DriverManager Interface">Section 5.1.1, “Connecting to MySQL Using the <code class="literal">DriverManager</code> Interface”</a>
            before working with these examples.
          </p><p>
            This example shows how you can obtain a
            <code class="literal">Connection</code> instance from the
            <code class="literal">DriverManager</code>. There are a few different
            signatures for the <code class="function">getConnection()</code>
            method. You should see the API documentation that comes with
            your JDK for more specific information on how to use them.
          </p><pre class="programlisting">import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
Connection conn = null;
...
try {
    conn =
       DriverManager.getConnection("jdbc:mysql://localhost/test?" +
                                   "user=monty&amp;password=greatsqldb");
    // Do something with the Connection
   ...
} catch (SQLException ex) {
    // handle any errors
    System.out.println("SQLException: " + ex.getMessage());
    System.out.println("SQLState: " + ex.getSQLState());
    System.out.println("VendorError: " + ex.getErrorCode());
}
</pre><p>
            Once a <code class="classname">Connection</code> is established, it
            can be used to create <code class="classname">Statement</code> and
            <code class="classname">PreparedStatement</code> objects, as well as
            retrieve metadata about the database. This is explained in
            the following sections.
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-statements"></a>5.1.2. Using Statements to Execute SQL</h3></div></div></div><p>
          <code class="classname">Statement</code> objects allow you to execute
          basic SQL queries and retrieve the results through the
          <code class="literal">ResultSet</code> class which is described later.
        </p><p>
          To create a <code class="classname">Statement</code> instance, you
          call the <code class="function">createStatement()</code> method on the
          <code class="literal">Connection</code> object you have retrieved using
          one of the <code class="literal">DriverManager.getConnection()</code> or
          <code class="literal">DataSource.getConnection()</code> methods
          described earlier.
        </p><p>
          Once you have a <code class="classname">Statement</code> instance, you
          can execute a <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> query by
          calling the <code class="function">executeQuery(String)</code> method
          with the SQL you want to use.
        </p><p>
          To update data in the database, use the
          <code class="function">executeUpdate(String SQL)</code> method. This
          method returns the number of rows matched by the update
          statement, not the number of rows that were modified.
        </p><p>
          If you do not know ahead of time whether the SQL statement
          will be a <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> or an
          <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a>,
          then you can use the <code class="function">execute(String SQL)</code>
          method. This method will return true if the SQL query was a
          <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a>, or false if it was an
          <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a>,
          <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a>, or
          <a href="http://dev.mysql.com/doc/refman/5.5/en/delete.html" target="_top"><code class="literal">DELETE</code></a> statement. If the
          statement was a <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> query,
          you can retrieve the results by calling the
          <code class="function">getResultSet()</code> method. If the statement
          was an <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a>,
          <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a>, or
          <a href="http://dev.mysql.com/doc/refman/5.5/en/delete.html" target="_top"><code class="literal">DELETE</code></a> statement, you can
          retrieve the affected rows count by calling
          <code class="function">getUpdateCount()</code> on the
          <code class="classname">Statement</code> instance.
        </p><div class="example"><a name="connector-j-examples-execute-select"></a><p class="title"><b>Example 5.2. Connector/J: Using java.sql.Statement to execute a
            <code class="literal">SELECT</code> query</b></p><pre class="programlisting">import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.ResultSet;
// assume that conn is an already created JDBC connection (see previous examples)
Statement stmt = null;
ResultSet rs = null;
try {
    stmt = conn.createStatement();
    rs = stmt.executeQuery("SELECT foo FROM bar");
    // or alternatively, if you don't know ahead of time that
    // the query will be a SELECT...
    if (stmt.execute("SELECT foo FROM bar")) {
        rs = stmt.getResultSet();
    }
    // Now do something with the ResultSet ....
}
catch (SQLException ex){
    // handle any errors
    System.out.println("SQLException: " + ex.getMessage());
    System.out.println("SQLState: " + ex.getSQLState());
    System.out.println("VendorError: " + ex.getErrorCode());
}
finally {
    // it is a good idea to release
    // resources in a finally{} block
    // in reverse-order of their creation
    // if they are no-longer needed
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException sqlEx) { } // ignore
        rs = null;
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException sqlEx) { } // ignore
        stmt = null;
    }
}</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-statements-callable"></a>5.1.3. Using <code class="literal">CallableStatements</code> to Execute Stored Procedures</h3></div></div></div><p>
          Starting with MySQL server version 5.0 when used with
          Connector/J 3.1.1 or newer, the
          <code class="classname">java.sql.CallableStatement</code> interface is
          fully implemented with the exception of the
          <code class="function">getParameterMetaData()</code> method.
        </p><p>
          For more information on MySQL stored procedures, please refer
          to
          <a href="http://dev.mysql.com/doc/mysql/en/stored-routines.html" target="_top">http://dev.mysql.com/doc/mysql/en/stored-routines.html</a>.
        </p><p>
          Connector/J exposes stored procedure functionality through
          JDBC's <code class="classname">CallableStatement</code> interface.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
            Current versions of MySQL server do not return enough
            information for the JDBC driver to provide result set
            metadata for callable statements. This means that when using
            <code class="literal">CallableStatement</code>,
            <code class="literal">ResultSetMetaData</code> may return
            <code class="literal">NULL</code>.
          </p></div><p>
          The following example shows a stored procedure that returns
          the value of <code class="varname">inOutParam</code> incremented by 1,
          and the string passed in using <code class="varname">inputParam</code>
          as a <code class="classname">ResultSet</code>:
          </p><div class="example"><a name="connector-j-examples-stored-procedure"></a><p class="title"><b>Example 5.3. Connector/J: Calling Stored Procedures</b></p><pre class="programlisting">CREATE PROCEDURE demoSp(IN inputParam VARCHAR(255), \
                                        INOUT inOutParam INT)
BEGIN
    DECLARE z INT;
    SET z = inOutParam + 1;
    SET inOutParam = z;
    SELECT inputParam;
    SELECT CONCAT('zyxw', inputParam);
END</pre></div><p>
        </p><p>
          To use the <code class="literal">demoSp</code> procedure with
          Connector/J, follow these steps:
        </p><div class="orderedlist"><ol type="1"><li><p>
              Prepare the callable statement by using
              <code class="literal">Connection.prepareCall()</code> .
            </p><p>
              Notice that you have to use JDBC escape syntax, and that
              the parentheses surrounding the parameter placeholders are
              not optional:
            </p><div class="example"><a name="connector-j-examples-preparecall"></a><p class="title"><b>Example 5.4. Connector/J: Using <code class="literal">Connection.prepareCall()</code></b></p><pre class="programlisting">import java.sql.CallableStatement;
...
    //
    // Prepare a call to the stored procedure 'demoSp'
    // with two parameters
    //
    // Notice the use of JDBC-escape syntax ({call ...})
    //
    CallableStatement cStmt = conn.prepareCall("{call demoSp(?, ?)}");
    cStmt.setString(1, "abcdefg");</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
                <code class="literal">Connection.prepareCall()</code> is an
                expensive method, due to the metadata retrieval that the
                driver performs to support output parameters. For
                performance reasons, you should try to minimize
                unnecessary calls to
                <code class="literal">Connection.prepareCall()</code> by reusing
                <code class="classname">CallableStatement</code> instances in
                your code.
              </p></div></li><li><p>
              Register the output parameters (if any exist)
            </p><p>
              To retrieve the values of output parameters (parameters
              specified as <code class="literal">OUT</code> or
              <code class="literal">INOUT</code> when you created the stored
              procedure), JDBC requires that they be specified before
              statement execution using the various
              <code class="function">registerOutputParameter()</code> methods in
              the <code class="classname">CallableStatement</code> interface:
              </p><div class="example"><a name="connector-j-examples-output-param"></a><p class="title"><b>Example 5.5. Connector/J: Registering output parameters</b></p><pre class="programlisting">import java.sql.Types;
...
//
// Connector/J supports both named and indexed
// output parameters. You can register output
// parameters using either method, as well
// as retrieve output parameters using either
// method, regardless of what method was
// used to register them.
//
// The following examples show how to use
// the various methods of registering
// output parameters (you should of course
// use only one registration per parameter).
//
//
// Registers the second parameter as output, and
// uses the type 'INTEGER' for values returned from
// getObject()
//
cStmt.registerOutParameter(2, Types.INTEGER);
//
// Registers the named parameter 'inOutParam', and
// uses the type 'INTEGER' for values returned from
// getObject()
//
cStmt.registerOutParameter("inOutParam", Types.INTEGER);
...
</pre></div><p>
            </p></li><li><p>
              Set the input parameters (if any exist)
            </p><p>
              Input and in/out parameters are set as for
              <code class="classname">PreparedStatement</code> objects. However,
              <code class="classname">CallableStatement</code> also supports
              setting parameters by name:
              </p><div class="example"><a name="connector-j-examples-callablestatement"></a><p class="title"><b>Example 5.6. Connector/J: Setting <code class="literal">CallableStatement</code> input
                  parameters</b></p><pre class="programlisting">...
    //
    // Set a parameter by index
    //
    cStmt.setString(1, "abcdefg");
    //
    // Alternatively, set a parameter using
    // the parameter name
    //
    cStmt.setString("inputParameter", "abcdefg");
    //
    // Set the 'in/out' parameter using an index
    //
    cStmt.setInt(2, 1);
    //
    // Alternatively, set the 'in/out' parameter
    // by name
    //
    cStmt.setInt("inOutParam", 1);
...</pre></div><p>
            </p></li><li><p>
              Execute the <code class="classname">CallableStatement</code>, and
              retrieve any result sets or output parameters.
            </p><p>
              Although <code class="classname">CallableStatement</code> supports
              calling any of the <code class="classname">Statement</code>
              execute methods (<code class="function">executeUpdate()</code>,
              <code class="function">executeQuery()</code> or
              <code class="function">execute()</code>), the most flexible method
              to call is <code class="function">execute()</code>, as you do not
              need to know ahead of time if the stored procedure returns
              result sets:
              </p><div class="example"><a name="connector-j-examples-retrieving-results-params"></a><p class="title"><b>Example 5.7. Connector/J: Retrieving results and output parameter values</b></p><pre class="programlisting">...
    boolean hadResults = cStmt.execute();
    //
    // Process all returned result sets
    //
    while (hadResults) {
        ResultSet rs = cStmt.getResultSet();
        // process result set
        ...
        hadResults = cStmt.getMoreResults();
    }
    //
    // Retrieve output parameters
    //
    // Connector/J supports both index-based and
    // name-based retrieval
    //
    int outputValue = cStmt.getInt(2); // index-based
    outputValue = cStmt.getInt("inOutParam"); // name-based
...</pre></div><p>
            </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-last-insert-id"></a>5.1.4. Retrieving <code class="literal">AUTO_INCREMENT</code> Column Values</h3></div></div></div><p>
          Before version 3.0 of the JDBC API, there was no standard way
          of retrieving key values from databases that supported auto
          increment or identity columns. With older JDBC drivers for
          MySQL, you could always use a MySQL-specific method on the
          <code class="classname">Statement</code> interface, or issue the query
          <code class="literal">SELECT LAST_INSERT_ID()</code> after issuing an
          <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a> to a table that had an
          <code class="literal">AUTO_INCREMENT</code> key. Using the
          MySQL-specific method call isn't portable, and issuing a
          <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> to get the
          <code class="literal">AUTO_INCREMENT</code> key's value requires another
          round-trip to the database, which isn't as efficient as
          possible. The following code snippets demonstrate the three
          different ways to retrieve <code class="literal">AUTO_INCREMENT</code>
          values. First, we demonstrate the use of the new JDBC-3.0
          method <code class="function">getGeneratedKeys()</code> which is now
          the preferred method to use if you need to retrieve
          <code class="literal">AUTO_INCREMENT</code> keys and have access to
          JDBC-3.0. The second example shows how you can retrieve the
          same value using a standard <code class="literal">SELECT
          LAST_INSERT_ID()</code> query. The final example shows how
          updatable result sets can retrieve the
          <code class="literal">AUTO_INCREMENT</code> value when using the
          <code class="function">insertRow()</code> method.
          </p><div class="example"><a name="connector-j-examples-autoincrement-getgeneratedkeys"></a><p class="title"><b>Example 5.8. Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">Statement.getGeneratedKeys()</code></b></p><pre class="programlisting">   Statement stmt = null;
   ResultSet rs = null;
   try {
    //
    // Create a Statement instance that we can use for
    // 'normal' result sets assuming you have a
    // Connection 'conn' to a MySQL database already
    // available
    stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,
                                java.sql.ResultSet.CONCUR_UPDATABLE);
    //
    // Issue the DDL queries for the table for this example
    //
    stmt.executeUpdate("DROP TABLE IF EXISTS autoIncTutorial");
    stmt.executeUpdate(
            "CREATE TABLE autoIncTutorial ("
            + "priKey INT NOT NULL AUTO_INCREMENT, "
            + "dataField VARCHAR(64), PRIMARY KEY (priKey))");
    //
    // Insert one row that will generate an AUTO INCREMENT
    // key in the 'priKey' field
    //
    stmt.executeUpdate(
            "INSERT INTO autoIncTutorial (dataField) "
            + "values ('Can I Get the Auto Increment Field?')",
            Statement.RETURN_GENERATED_KEYS);
    //
    // Example of using Statement.getGeneratedKeys()
    // to retrieve the value of an auto-increment
    // value
    //
    int autoIncKeyFromApi = -1;
    rs = stmt.getGeneratedKeys();
    if (rs.next()) {
        autoIncKeyFromApi = rs.getInt(1);
    } else {
        // throw an exception from here
    }
    rs.close();
    rs = null;
    System.out.println("Key returned from getGeneratedKeys():"
        + autoIncKeyFromApi);
} finally {
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
}
</pre></div><p>
          </p><div class="example"><a name="connector-j-examples-autoincrement-select"></a><p class="title"><b>Example 5.9. Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              using <code class="literal">SELECT LAST_INSERT_ID()</code></b></p><pre class="programlisting">   Statement stmt = null;
   ResultSet rs = null;
   try {
    //
    // Create a Statement instance that we can use for
    // 'normal' result sets.
    stmt = conn.createStatement();
    //
    // Issue the DDL queries for the table for this example
    //
    stmt.executeUpdate("DROP TABLE IF EXISTS autoIncTutorial");
    stmt.executeUpdate(
            "CREATE TABLE autoIncTutorial ("
            + "priKey INT NOT NULL AUTO_INCREMENT, "
            + "dataField VARCHAR(64), PRIMARY KEY (priKey))");
    //
    // Insert one row that will generate an AUTO INCREMENT
    // key in the 'priKey' field
    //
    stmt.executeUpdate(
            "INSERT INTO autoIncTutorial (dataField) "
            + "values ('Can I Get the Auto Increment Field?')");
    //
    // Use the MySQL LAST_INSERT_ID()
    // function to do the same thing as getGeneratedKeys()
    //
    int autoIncKeyFromFunc = -1;
    rs = stmt.executeQuery("SELECT LAST_INSERT_ID()");
    if (rs.next()) {
        autoIncKeyFromFunc = rs.getInt(1);
    } else {
        // throw an exception from here
    }
    rs.close();
    System.out.println("Key returned from " +
                       "'SELECT LAST_INSERT_ID()': " +
                       autoIncKeyFromFunc);
} finally {
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
}
   </pre></div><p>
          </p><div class="example"><a name="connector-j-examples-autoincrement-updateable-resultsets"></a><p class="title"><b>Example 5.10. Connector/J: Retrieving <code class="literal">AUTO_INCREMENT</code> column values
              in <code class="literal">Updatable ResultSets</code></b></p><pre class="programlisting">   Statement stmt = null;
   ResultSet rs = null;
   try {
    //
    // Create a Statement instance that we can use for
    // 'normal' result sets as well as an 'updatable'
    // one, assuming you have a Connection 'conn' to
    // a MySQL database already available
    //
    stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,
                                java.sql.ResultSet.CONCUR_UPDATABLE);
    //
    // Issue the DDL queries for the table for this example
    //
    stmt.executeUpdate("DROP TABLE IF EXISTS autoIncTutorial");
    stmt.executeUpdate(
            "CREATE TABLE autoIncTutorial ("
            + "priKey INT NOT NULL AUTO_INCREMENT, "
            + "dataField VARCHAR(64), PRIMARY KEY (priKey))");
    //
    // Example of retrieving an AUTO INCREMENT key
    // from an updatable result set
    //
    rs = stmt.executeQuery("SELECT priKey, dataField "
       + "FROM autoIncTutorial");
    rs.moveToInsertRow();
    rs.updateString("dataField", "AUTO INCREMENT here?");
    rs.insertRow();
    //
    // the driver adds rows at the end
    //
    rs.last();
    //
    // We should now be on the row we just inserted
    //
    int autoIncKeyFromRS = rs.getInt("priKey");
    rs.close();
    rs = null;
    System.out.println("Key returned for inserted row: "
        + autoIncKeyFromRS);
} finally {
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException ex) {
            // ignore
        }
    }
}
   </pre></div><p>
          When you run the preceding example code, you should get the
          following output: Key returned from
          <code class="function">getGeneratedKeys()</code>: 1 Key returned from
          <code class="literal">SELECT LAST_INSERT_ID()</code>: 1 Key returned for
          inserted row: 2 You should be aware, that at times, it can be
          tricky to use the <code class="literal">SELECT LAST_INSERT_ID()</code>
          query, as that function's value is scoped to a connection. So,
          if some other query happens on the same connection, the value
          will be overwritten. On the other hand, the
          <code class="function">getGeneratedKeys()</code> method is scoped by
          the <code class="classname">Statement</code> instance, so it can be
          used even if other queries happen on the same connection, but
          not on the same <code class="classname">Statement</code> instance.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-usagenotes-j2ee"></a>5.2. Using Connector/J with J2EE and Other Java Frameworks</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts">5.2.1. General J2EE Concepts</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-tomcat">5.2.2. Using Connector/J with Tomcat</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-jboss">5.2.3. Using Connector/J with JBoss</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-spring-config">5.2.4. Using Connector/J with Spring</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-glassfish-config">5.2.5. Using Connector/J with GlassFish</a></span></dt></dl></div><p>
        This section describes how to use Connector/J in several
        contexts.
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-j2ee-concepts"></a>5.2.1. General J2EE Concepts</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts-connection-pooling">5.2.1.1. Understanding Connection Pooling</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts-managing-load-balanced-connections">5.2.1.2. Managing Load Balanced Connections</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-j2ee-concepts-load-balancing-failover">5.2.1.3. Load Balancing Failover Policies</a></span></dt></dl></div><p>
          This section provides general background on J2EE concepts that
          pertain to use of Connector/J.
        </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-j2ee-concepts-connection-pooling"></a>5.2.1.1. Understanding Connection Pooling</h4></div></div></div><p>
            Connection pooling is a technique of creating and managing a
            pool of connections that are ready for use by any thread
            that needs them.
          </p><p>
            This technique of pooling connections is based on the fact
            that most applications only need a thread to have access to
            a JDBC connection when they are actively processing a
            transaction, which usually take only milliseconds to
            complete. When not processing a transaction, the connection
            would otherwise sit idle. Instead, connection pooling
            enables the idle connection to be used by some other thread
            to do useful work.
          </p><p>
            In practice, when a thread needs to do work against a MySQL
            or other database with JDBC, it requests a connection from
            the pool. When the thread is finished using the connection,
            it returns it to the pool, so that it may be used by any
            other threads that want to use it.
          </p><p>
            When the connection is loaned out from the pool, it is used
            exclusively by the thread that requested it. From a
            programming point of view, it is the same as if your thread
            called <code class="literal">DriverManager.getConnection()</code>
            every time it needed a JDBC connection, however with
            connection pooling, your thread may end up using either a
            new, or already-existing connection.
          </p><p>
            Connection pooling can greatly increase the performance of
            your Java application, while reducing overall resource
            usage. The main benefits to connection pooling are:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                Reduced connection creation time
              </p><p>
                Although this is not usually an issue with the quick
                connection setup that MySQL offers compared to other
                databases, creating new JDBC connections still incurs
                networking and JDBC driver overhead that will be avoided
                if connections are recycled.
              </p></li><li><p>
                Simplified programming model
              </p><p>
                When using connection pooling, each individual thread
                can act as though it has created its own JDBC
                connection, allowing you to use straight-forward JDBC
                programming techniques.
              </p></li><li><p>
                Controlled resource usage
              </p><p>
                If you do not use connection pooling, and instead create
                a new connection every time a thread needs one, your
                application's resource usage can be quite wasteful and
                lead to unpredictable behavior under load.
              </p></li></ul></div><p>
            Remember that each connection to MySQL has overhead (memory,
            CPU, context switches, and so forth) on both the client and
            server side. Every connection limits how many resources
            there are available to your application as well as the MySQL
            server. Many of these resources will be used whether or not
            the connection is actually doing any useful work!
          </p><p>
            Connection pools can be tuned to maximize performance, while
            keeping resource utilization below the point where your
            application will start to fail rather than just run slower.
          </p><p>
            Luckily, Sun has standardized the concept of connection
            pooling in JDBC through the JDBC-2.0 Optional interfaces,
            and all major application servers have implementations of
            these APIs that work fine with MySQL Connector/J.
          </p><p>
            Generally, you configure a connection pool in your
            application server configuration files, and access it
            through the Java Naming and Directory Interface (JNDI). The
            following code shows how you might use a connection pool
            from an application deployed in a J2EE application server:
            </p><div class="example"><a name="connector-j-examples-connectionpool-j2ee"></a><p class="title"><b>Example 5.11. Connector/J: Using a connection pool with a J2EE application server</b></p><pre class="programlisting">import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;
import javax.naming.InitialContext;
import javax.sql.DataSource;
public class MyServletJspOrEjb {
    public void doSomething() throws Exception {
        /*
         * Create a JNDI Initial context to be able to
         *  lookup  the DataSource
         *
         * In production-level code, this should be cached as
         * an instance or static variable, as it can
         * be quite expensive to create a JNDI context.
         *
         * Note: This code only works when you are using servlets
         * or EJBs in a J2EE application server. If you are
         * using connection pooling in standalone Java code, you
         * will have to create/configure datasources using whatever
         * mechanisms your particular connection pooling library
         * provides.
         */
        InitialContext ctx = new InitialContext();
         /*
          * Lookup the DataSource, which will be backed by a pool
          * that the application server provides. DataSource instances
          * are also a good candidate for caching as an instance
          * variable, as JNDI lookups can be expensive as well.
          */
        DataSource ds =
          (DataSource)ctx.lookup("java:comp/env/jdbc/MySQLDB");
        /*
         * The following code is what would actually be in your
         * Servlet, JSP or EJB 'service' method...where you need
         * to work with a JDBC connection.
         */
        Connection conn = null;
        Statement stmt = null;
        try {
            conn = ds.getConnection();
            /*
             * Now, use normal JDBC programming to work with
             * MySQL, making sure to close each resource when you're
             * finished with it, which permits the connection pool
             * resources to be recovered as quickly as possible
             */
            stmt = conn.createStatement();
            stmt.execute("SOME SQL QUERY");
            stmt.close();
            stmt = null;
            conn.close();
            conn = null;
        } finally {
            /*
             * close any jdbc instances here that weren't
             * explicitly closed during normal code path, so
             * that we don't 'leak' resources...
             */
            if (stmt != null) {
                try {
                    stmt.close();
                } catch (sqlexception sqlex) {
                    // ignore -- as we can't do anything about it here
                }
                stmt = null;
            }
            if (conn != null) {
                try {
                    conn.close();
                } catch (sqlexception sqlex) {
                    // ignore -- as we can't do anything about it here
                }
                conn = null;
            }
        }
    }
}</pre></div><p>
            As shown in the example above, after obtaining the JNDI
            InitialContext, and looking up the DataSource, the rest of
            the code should look familiar to anyone who has done JDBC
            programming in the past.
          </p><p>
            The most important thing to remember when using connection
            pooling is to make sure that no matter what happens in your
            code (exceptions, flow-of-control, and so forth),
            connections, and anything created by them (such as
            statements or result sets) are closed, so that they may be
            re-used, otherwise they will be stranded, which in the best
            case means that the MySQL server resources they represent
            (such as buffers, locks, or sockets) may be tied up for some
            time, or worst case, may be tied up forever.
          </p><p>
            <span class="bold"><strong>What Is the Best Size for my
            Connection Pool?</strong></span>
          </p><p>
            As with all other configuration rules-of-thumb, the answer
            is: it depends. Although the optimal size depends on
            anticipated load and average database transaction time, the
            optimum connection pool size is smaller than you might
            expect. If you take Sun's Java Petstore blueprint
            application for example, a connection pool of 15-20
            connections can serve a relatively moderate load (600
            concurrent users) using MySQL and Tomcat with response times
            that are acceptable.
          </p><p>
            To correctly size a connection pool for your application,
            you should create load test scripts with tools such as
            Apache JMeter or The Grinder, and load test your
            application.
          </p><p>
            An easy way to determine a starting point is to configure
            your connection pool's maximum number of connections to be
            unbounded, run a load test, and measure the largest amount
            of concurrently used connections. You can then work backward
            from there to determine what values of minimum and maximum
            pooled connections give the best performance for your
            particular application.
          </p><p>
            <span class="bold"><strong>Validating Connections</strong></span>
          </p><p>
            MySQL Connector/J has the ability to execute a lightweight
            ping against a server, in order to validate the connection.
            In the case of load-balanced connections, this is performed
            against all active pooled internal connections that are
            retained. This is beneficial to Java applications using
            connection pools, as the pool can use this feature to
            validate connections. Depending on your connection pool and
            configuration, this validation can be carried out at
            different times:
          </p><div class="orderedlist"><ol type="1"><li><p>
                Before the pool returns a connection to the application.
              </p></li><li><p>
                When the application returns a connection to the pool.
              </p></li><li><p>
                During periodic checks of idle connections.
              </p></li></ol></div><p>
            In order to use this feature you need to specify a
            validation query in your connection pool that starts with
            <code class="literal">/* ping */</code>. Note the syntax must be
            exactly as specified. This will cause the driver send a ping
            to the server and return a fake, light-weight, result set.
            When using a <code class="literal">ReplicationConnection</code> or
            <code class="literal">LoadBalancedConnection</code>, the ping will be
            sent across all active connections.
          </p><p>
            It is critical that the syntax be specified correctly. For
            example, consider the following snippets:
          </p><pre class="programlisting">sql = "/* PING */ SELECT 1";
sql = "SELECT 1 /* ping*/";
sql = "/*ping*/ SELECT 1";
sql = " /* ping */ SELECT 1";
sql = "/*to ping or not to ping*/ SELECT 1";
</pre><p>
            None of the above statements will work. This is because the
            ping syntax is sensitive to whitespace, capitalization, and
            placement. The syntax needs to be exact for reasons of
            efficiency, as this test is done for every statement that is
            executed:
          </p><pre class="programlisting">
protected static final String PING_MARKER = "/* ping */";
...
if (sql.charAt(0) == '/') {
if (sql.startsWith(PING_MARKER)) {
doPingInstead();
...

</pre><p>
            All of the previous statements will issue a normal
            <code class="literal">SELECT</code> statement and will
            <span class="bold"><strong>not</strong></span> be transformed into the
            lightweight ping. Further, for load-balanced connections the
            statement will be executed against one connection in the
            internal pool, rather than validating each underlying
            physical connection. This results in the non-active physical
            connections assuming a stale state, and they may die. If
            Connector/J then re-balances it may select a dead
            connection, resulting in an exception being passed to the
            application. To help prevent this you can use
            <code class="literal">loadBalanceValidateConnectionOnSwapServer</code>
            to validate the connection before use.
          </p><p>
            If your Connector/J deployment uses a connection pool that
            allows you to specify a validation query, this should be
            taken advantage of, but ensure that the query starts
            <span class="emphasis"><em>exactly</em></span> with <code class="literal">/* ping
            */</code>. This is particularly important if you are
            using the load-balancing or replication-aware features of
            Connector/J, as it will help keep alive connections which
            otherwise will go stale and die, causing problems later.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-j2ee-concepts-managing-load-balanced-connections"></a>5.2.1.2. Managing Load Balanced Connections</h4></div></div></div><p>
            Connector/J has long provided an effective means to
            distribute read/write load across multiple MySQL server
            instances for Cluster or master-master replication
            deployments, but until version 5.1.13, managing such
            deployments frequently required a service outage to redeploy
            a new configuration. Given that the ease of scaling out by
            adding additional MySQL Cluster (server) instances is a key
            element in that product offering, which is also naturally
            targeted at deployments with very strict availability
            requirements, it was necessary to add support for online
            changes of this nature. This is also critical for online
            upgrades, as the alternative is to take a MySQL Cluster
            server instance down hard, which will lose any in-process
            transactions and will also generate application exceptions,
            if any application is trying to use that particular server
            instance. Connector/J now has the ability to dynamically
            configure load-balanced connections.
          </p><p>
            There are two connection string options associated with this
            functionality:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                <code class="literal">loadBalanceConnectionGroup</code> – This
                provides the ability to group connections from different
                sources. This allows you to manage these JDBC sources
                within a single class-loader in any combination you
                choose. If they use the same configuration, and you want
                to manage them as a logical single group, give them the
                same name. This is the key property for management, if
                you do not define a name (string) for
                <code class="literal">loadBalanceConnectionGroup</code>, you
                cannot manage the connections. All load-balanced
                connections sharing the same
                <code class="literal">loadBalanceConnectionGroup</code> value,
                regardless of how the application creates them, will be
                managed together.
              </p></li><li><p>
                <code class="literal">loadBalanceEnableJMX</code> – The ability
                to manage the connections is exposed when you define a
                <code class="literal">loadBalanceConnectionGroup</code>, but if
                you want to manage this externally, it is necessary to
                enable JMX by setting this property to
                <code class="literal">true</code>. This enables a JMX
                implementation, which exposes the management and
                monitoring operations of a connection group. Further,
                you need to start your application with the
                <code class="literal">-Dcom.sun.management.jmxremote</code> JVM
                flag. You can then perform connect and perform
                operations using a JMX client such as
                <code class="literal">jconsole</code>.
              </p></li></ul></div><p>
            Once a connection has been made using the correct connection
            string options, a number of monitoring properties are
            available:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                Current active host count
              </p></li><li><p>
                Current active physical connection count
              </p></li><li><p>
                Current active logical connection count
              </p></li><li><p>
                Total logical connections created
              </p></li><li><p>
                Total transaction count
              </p></li></ul></div><p>
            The following management operations can also be performed:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                Add host
              </p></li><li><p>
                Remove host
              </p></li></ul></div><p>
            The JMX interface,
            <code class="literal">com.mysql.jdbc.jmx.LoadBalanceConnectionGroupManagerMBean</code>,
            has the following methods:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                int getActiveHostCount(String group);
              </p></li><li><p>
                int getTotalHostCount(String group);
              </p></li><li><p>
                long getTotalLogicalConnectionCount(String group);
              </p></li><li><p>
                long getActiveLogicalConnectionCount(String group);
              </p></li><li><p>
                long getActivePhysicalConnectionCount(String group);
              </p></li><li><p>
                long getTotalPhysicalConnectionCount(String group);
              </p></li><li><p>
                long getTotalTransactionCount(String group);
              </p></li><li><p>
                void removeHost(String group, String host) throws
                SQLException;
              </p></li><li><p>
                void stopNewConnectionsToHost(String group, String host)
                throws SQLException;
              </p></li><li><p>
                void addHost(String group, String host, boolean
                forExisting);
              </p></li><li><p>
                String getActiveHostsList(String group);
              </p></li><li><p>
                String getRegisteredConnectionGroups();
              </p></li></ul></div><p>
            The <code class="literal">getRegisteredConnectionGroups()</code>
            method will return the names of all connection groups
            defined in that class-loader.
          </p><p>
            You can test this setup with the following code:
          </p><pre class="programlisting">
public class Test {
    private static String URL = "jdbc:mysql:loadbalance://" +
        "localhost:3306,localhost:3310/test?" +
        "loadBalanceConnectionGroup=first&amp;loadBalanceEnableJMX=true";
    public static void main(String[] args) throws Exception {
        new Thread(new Repeater()).start();
        new Thread(new Repeater()).start();
        new Thread(new Repeater()).start();
    }
    static Connection getNewConnection() throws SQLException, ClassNotFoundException {
        Class.forName("com.mysql.jdbc.Driver");
        return DriverManager.getConnection(URL, "root", "");
    }
    static void executeSimpleTransaction(Connection c, int conn, int trans){
        try {
            c.setAutoCommit(false);
            Statement s = c.createStatement();
            s.executeQuery("SELECT SLEEP(1) /* Connection: " + conn + ", transaction: " + trans + " */");
            c.commit();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    public static class Repeater implements Runnable {
        public void run() {
            for(int i=0; i &lt; 100; i++){
                try {
                    Connection c = getNewConnection();
                    for(int j=0; j &lt; 10; j++){
                        executeSimpleTransaction(c, i, j);
                        Thread.sleep(Math.round(100 * Math.random()));
                    }
                    c.close();
                    Thread.sleep(100);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

</pre><p>
            After compiling, the application can be started with the
            <code class="literal">-Dcom.sun.management.jmxremote</code> flag, to
            enable remote management. <code class="literal">jconsole</code> can
            then be started. The Test main class will be listed by
            jconsole. Select this and click
            <span class="guibutton">Connect</span>. You can then navigate to the
            <code class="literal">com.mysql.jdbc.jmx.LoadBalanceConnectionGroupManager</code>
            bean. At this point you can click on various operations and
            examine the returned result.
          </p><p>
            If you now had an additional instance of MySQL running on
            port 3309, you could ensure that Connector/J starts using it
            by using the <code class="literal">addHost()</code>, which is exposed
            in <code class="literal">jconsole</code>. Note that these operations
            can be performed dynamically without having to stop the
            application running.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-j2ee-concepts-load-balancing-failover"></a>5.2.1.3. Load Balancing Failover Policies</h4></div></div></div><p>
            Connector/J provides a useful load-balancing implementation
            for Cluster or multi-master deployments. As of Connector/J
            5.1.12, this same implementation is used for balancing load
            between read-only slaves with
            <code class="literal">ReplicationDriver</code>. When trying to balance
            workload between multiple servers, the driver has to
            determine when it is safe to swap servers, doing so in the
            middle of a transaction, for example, could cause problems.
            It is important not to lose state information. For this
            reason, Connector/J will only try to pick a new server when
            one of the following happens:
          </p><div class="orderedlist"><ol type="1"><li><p>
                At transaction boundaries (transactions are explicitly
                committed or rolled back).
              </p></li><li><p>
                A communication exception (SQL State starting with "08")
                is encountered.
              </p></li><li><p>
                When a <code class="literal">SQLException</code> matches
                conditions defined by user, using the extension points
                defined by the
                <code class="literal">loadBalanceSQLStateFailover</code>,
                <code class="literal">loadBalanceSQLExceptionSubclassFailover</code>
                or <code class="literal">loadBalanceExceptionChecker</code>
                properties.
              </p></li></ol></div><p>
            The third condition revolves around three new properties
            introduced with Connector/J 5.1.13. It allows you to control
            which <code class="literal">SQLException</code>s trigger failover.
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                <code class="literal">loadBalanceExceptionChecker</code> - The
                <code class="literal">loadBalanceExceptionChecker</code> property
                is really the key. This takes a fully-qualified class
                name which implements the new
                <code class="literal">com.mysql.jdbc.LoadBalanceExceptionChecker</code>
                interface. This interface is very simple, and you only
                need to implement the following method:
              </p><pre class="programlisting">public boolean shouldExceptionTriggerFailover(SQLException ex)
</pre><p>
                A <code class="literal">SQLException</code> is passed in, and a
                boolean returned. <code class="literal">True</code> triggers a
                failover, <code class="literal">false</code> does not.
              </p><p>
                You can use this to implement your own custom logic. An
                example where this might be useful is when dealing with
                transient errors when using MySQL Cluster, where certain
                buffers may become overloaded. The following code
                snippet illustrates this:
              </p><pre class="programlisting">
public class NdbLoadBalanceExceptionChecker
 extends StandardLoadBalanceExceptionChecker {
 public boolean shouldExceptionTriggerFailover(SQLException ex) {
  return super.shouldExceptionTriggerFailover(ex)
    ||  checkNdbException(ex);
 }
 private boolean checkNdbException(SQLException ex){
 // Have to parse the message since most NDB errors
 // are mapped to the same DEMC.
  return (ex.getMessage().startsWith("Lock wait timeout exceeded") ||
  (ex.getMessage().startsWith("Got temporary error")
  &amp;&amp; ex.getMessage().endsWith("from NDB")));
 }
}

</pre><p>
                The code above extends
                <code class="literal">com.mysql.jdbc.StandardLoadBalanceExceptionChecker</code>,
                which is the default implementation. There are a few
                convenient shortcuts built into this, for those who want
                to have some level of control using properties, without
                writing Java code. This default implementation uses the
                two remaining properties:
                <code class="literal">loadBalanceSQLStateFailover</code> and
                <code class="literal">loadBalanceSQLExceptionSubclassFailover</code>.
              </p></li><li><p>
                <code class="literal">loadBalanceSQLStateFailover</code> - allows
                you to define a comma-delimited list of
                <code class="literal">SQLState</code> code prefixes, against which
                a <code class="literal">SQLException</code> is compared. If the
                prefix matches, failover is triggered. So, for example,
                the following would trigger a failover if a given
                <code class="literal">SQLException</code> starts with "00", or is
                "12345":
              </p><pre class="programlisting">loadBalanceSQLStateFailover=00,12345
</pre></li><li><p>
                <code class="literal">loadBalanceSQLExceptionSubclassFailover</code>
                - can be used in conjunction with
                <code class="literal">loadBalanceSQLStateFailover</code> or on its
                own. If you want certain subclasses of
                <code class="literal">SQLException</code> to trigger failover,
                simply provide a comma-delimited list of fully-qualified
                class or interface names to check against. For example,
                if you want all
                <code class="literal">SQLTransientConnectionExceptions</code> to
                trigger failover, you would specify:
              </p><pre class="programlisting">loadBalanceSQLExceptionSubclassFailover=java.sql.SQLTransientConnectionException
</pre></li></ul></div><p>
            While the three fail-over conditions enumerated earlier suit
            most situations, if <code class="literal">auto-commit</code> is
            enabled, Connector/J never re-balances, and continues using
            the same physical connection. This can be problematic,
            particularly when load-balancing is being used to distribute
            read-only load across multiple slaves. However, Connector/J
            can be configured to re-balance after a certain number of
            statements are executed, when <code class="literal">auto-commit</code>
            is enabled. This functionality is dependent upon the
            following properties:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                <code class="literal">loadBalanceAutoCommitStatementThreshold</code>
                – defines the number of matching statements which will
                trigger the driver to potentially swap physical server
                connections. The default value, 0, retains the behavior
                that connections with <code class="literal">auto-commit</code>
                enabled are never balanced.
              </p></li><li><p>
                <code class="literal">loadBalanceAutoCommitStatementRegex</code>
                – the regular expression against which statements must
                match. The default value, blank, matches all statements.
                So, for example, using the following properties will
                cause Connector/J to re-balance after every third
                statement that contains the string “<span class="quote">test</span>”:
              </p><pre class="programlisting">loadBalanceAutoCommitStatementThreshold=3
loadBalanceAutoCommitStatementRegex=.*test.*
</pre><p>
                <code class="literal">loadBalanceAutoCommitStatementRegex</code>
                can prove useful in a number of situations. Your
                application may use temporary tables, server-side
                session state variables, or connection state, where
                letting the driver arbitrarily swap physical connections
                before processing is complete could cause data loss or
                other problems. This allows you to identify a trigger
                statement that is only executed when it is safe to swap
                physical connections.
              </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-tomcat"></a>5.2.2. Using Connector/J with Tomcat</h3></div></div></div><p>
          The following instructions are based on the instructions for
          Tomcat-5.x, available at
          <a href="http://tomcat.apache.org/tomcat-5.5-doc/jndi-datasource-examples-howto.html" target="_top">http://tomcat.apache.org/tomcat-5.5-doc/jndi-datasource-examples-howto.html</a>
          which is current at the time this document was written.
        </p><p>
          First, install the .jar file that comes with Connector/J in
          <code class="filename">$CATALINA_HOME/common/lib</code> so that it is
          available to all applications installed in the container.
        </p><p>
          Next, Configure the JNDI DataSource by adding a declaration
          resource to
          <code class="filename">$CATALINA_HOME/conf/server.xml</code> in the
          context that defines your web application:
        </p><pre class="programlisting">&lt;Context ....&gt;
  ...
  &lt;Resource name="jdbc/MySQLDB"
               auth="Container"
               type="javax.sql.DataSource"/&gt;
  &lt;!-- The name you used above, must match _exactly_ here!
       The connection pool will be bound into JNDI with the name
       "java:/comp/env/jdbc/MySQLDB"
  --&gt;
  &lt;ResourceParams name="jdbc/MySQLDB"&gt;
    &lt;parameter&gt;
      &lt;name&gt;factory&lt;/name&gt;
      &lt;value&gt;org.apache.commons.dbcp.BasicDataSourceFactory&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- Don't set this any higher than max_connections on your
         MySQL server, usually this should be a 10 or a few 10's
         of connections, not hundreds or thousands --&gt;
    &lt;parameter&gt;
      &lt;name&gt;maxActive&lt;/name&gt;
      &lt;value&gt;10&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- You don't want to many idle connections hanging around
         if you can avoid it, only enough to soak up a spike in
         the load --&gt;
    &lt;parameter&gt;
      &lt;name&gt;maxIdle&lt;/name&gt;
      &lt;value&gt;5&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- Don't use autoReconnect=true, it's going away eventually
         and it's a crutch for older connection pools that couldn't
         test connections. You need to decide whether your application
         is supposed to deal with SQLExceptions (hint, it should), and
         how much of a performance penalty you're willing to pay
         to ensure 'freshness' of the connection --&gt;
    &lt;parameter&gt;
      &lt;name&gt;validationQuery&lt;/name&gt;
      &lt;value&gt;SELECT 1&lt;/value&gt; &lt;-- See discussion below for update to this option --&gt;
    &lt;/parameter&gt;
   &lt;!-- The most conservative approach is to test connections
        before they're given to your application. For most applications
        this is okay, the query used above is very small and takes
        no real server resources to process, other than the time used
        to traverse the network.
        If you have a high-load application you'll need to rely on
        something else. --&gt;
    &lt;parameter&gt;
      &lt;name&gt;testOnBorrow&lt;/name&gt;
      &lt;value&gt;true&lt;/value&gt;
    &lt;/parameter&gt;
   &lt;!-- Otherwise, or in addition to testOnBorrow, you can test
        while connections are sitting idle --&gt;
    &lt;parameter&gt;
      &lt;name&gt;testWhileIdle&lt;/name&gt;
      &lt;value&gt;true&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- You have to set this value, otherwise even though
         you've asked connections to be tested while idle,
         the idle evicter thread will never run --&gt;
    &lt;parameter&gt;
      &lt;name&gt;timeBetweenEvictionRunsMillis&lt;/name&gt;
      &lt;value&gt;10000&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- Don't allow connections to hang out idle too long,
         never longer than what wait_timeout is set to on the
         server...A few minutes or even fraction of a minute
         is sometimes okay here, it depends on your application
         and how much spikey load it will see --&gt;
    &lt;parameter&gt;
      &lt;name&gt;minEvictableIdleTimeMillis&lt;/name&gt;
      &lt;value&gt;60000&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- Username and password used when connecting to MySQL --&gt;
    &lt;parameter&gt;
     &lt;name&gt;username&lt;/name&gt;
     &lt;value&gt;someuser&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;parameter&gt;
     &lt;name&gt;password&lt;/name&gt;
     &lt;value&gt;somepass&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- Class name for the Connector/J driver --&gt;
    &lt;parameter&gt;
       &lt;name&gt;driverClassName&lt;/name&gt;
       &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
    &lt;/parameter&gt;
    &lt;!-- The JDBC connection url for connecting to MySQL, notice
         that if you want to pass any other MySQL-specific parameters
         you should pass them here in the URL, setting them using the
         parameter tags above will have no effect, you will also
         need to use &amp;amp; to separate parameter values as the
         ampersand is a reserved character in XML --&gt;
    &lt;parameter&gt;
      &lt;name&gt;url&lt;/name&gt;
      &lt;value&gt;jdbc:mysql://localhost:3306/test&lt;/value&gt;
    &lt;/parameter&gt;
  &lt;/ResourceParams&gt;
&lt;/Context&gt;</pre><p>
          Note that Connector/J 5.1.3 introduced a facility whereby,
          rather than use a <code class="literal">validationQuery</code> value of
          <code class="literal">SELECT 1</code>, it is possible to use
          <code class="literal">validationQuery</code> with a value set to
          <code class="literal">/* ping */</code>. This sends a ping to the server
          which then returns a fake result set. This is a lighter weight
          solution. It also has the advantage that if using
          <code class="literal">ReplicationConnection</code> or
          <code class="literal">LoadBalancedConnection</code> type connections,
          the ping will be sent across all active connections. The
          following XML snippet illustrates how to select this option:
        </p><pre class="programlisting">
&lt;parameter&gt;
 &lt;name&gt;validationQuery&lt;/name&gt;
 &lt;value&gt;/* ping */&lt;/value&gt;
&lt;/parameter&gt;

</pre><p>
          Note that <code class="literal">/* ping */</code> has to be specified
          exactly.
        </p><p>
          In general, you should follow the installation instructions
          that come with your version of Tomcat, as the way you
          configure datasources in Tomcat changes from time-to-time, and
          unfortunately if you use the wrong syntax in your XML file,
          you will most likely end up with an exception similar to the
          following:
        </p><pre class="programlisting">Error: java.sql.SQLException: Cannot load JDBC driver class 'null ' SQL
state: null </pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-jboss"></a>5.2.3. Using Connector/J with JBoss</h3></div></div></div><p>
          These instructions cover JBoss-4.x. To make the JDBC driver
          classes available to the application server, copy the .jar
          file that comes with Connector/J to the
          <code class="filename">lib</code> directory for your server
          configuration (which is usually called
          <code class="filename">default</code>). Then, in the same configuration
          directory, in the subdirectory named deploy, create a
          datasource configuration file that ends with "-ds.xml", which
          tells JBoss to deploy this file as a JDBC Datasource. The file
          should have the following contents:
        </p><pre class="programlisting">&lt;datasources&gt;
    &lt;local-tx-datasource&gt;
        &lt;!-- This connection pool will be bound into JNDI with the name
             "java:/MySQLDB" --&gt;
        &lt;jndi-name&gt;MySQLDB&lt;/jndi-name&gt;
        &lt;connection-url&gt;jdbc:mysql://localhost:3306/dbname&lt;/connection-url&gt;
        &lt;driver-class&gt;com.mysql.jdbc.Driver&lt;/driver-class&gt;
        &lt;user-name&gt;user&lt;/user-name&gt;
        &lt;password&gt;pass&lt;/password&gt;
        &lt;min-pool-size&gt;5&lt;/min-pool-size&gt;
        &lt;!-- Don't set this any higher than max_connections on your
         MySQL server, usually this should be a 10 or a few 10's
         of connections, not hundreds or thousands --&gt;
        &lt;max-pool-size&gt;20&lt;/max-pool-size&gt;
        &lt;!-- Don't allow connections to hang out idle too long,
         never longer than what wait_timeout is set to on the
         server...A few minutes is usually okay here,
         it depends on your application
         and how much spikey load it will see --&gt;
        &lt;idle-timeout-minutes&gt;5&lt;/idle-timeout-minutes&gt;
        &lt;!-- If you're using Connector/J 3.1.8 or newer, you can use
             our implementation of these to increase the robustness
             of the connection pool. --&gt;
        &lt;exception-sorter-class-name&gt;
  com.mysql.jdbc.integration.jboss.ExtendedMysqlExceptionSorter
        &lt;/exception-sorter-class-name&gt;
        &lt;valid-connection-checker-class-name&gt;
  com.mysql.jdbc.integration.jboss.MysqlValidConnectionChecker
        &lt;/valid-connection-checker-class-name&gt;
    &lt;/local-tx-datasource&gt;
&lt;/datasources&gt; </pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-spring-config"></a>5.2.4. Using Connector/J with Spring</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-usagenotes-spring-config-jdbctemplate">5.2.4.1. Using <code class="classname">JdbcTemplate</code></a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-spring-config-transactional">5.2.4.2. Transactional JDBC Access</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-spring-config-connpooling">5.2.4.3. Connection Pooling</a></span></dt></dl></div><p>
          The Spring Framework is a Java-based application framework
          designed for assisting in application design by providing a
          way to configure components. The technique used by Spring is a
          well known design pattern called Dependency Injection (see
          <a href="http://www.martinfowler.com/articles/injection.html" target="_top">Inversion
          of Control Containers and the Dependency Injection
          pattern</a>). This article will focus on Java-oriented
          access to MySQL databases with Spring 2.0. For those
          wondering, there is a .NET port of Spring appropriately named
          Spring.NET.
        </p><p>
          Spring is not only a system for configuring components, but
          also includes support for aspect oriented programming (AOP).
          This is one of the main benefits and the foundation for
          Spring's resource and transaction management. Spring also
          provides utilities for integrating resource management with
          JDBC and Hibernate.
        </p><p>
          For the examples in this section the MySQL world sample
          database will be used. The first task is to set up a MySQL
          data source through Spring. Components within Spring use the
          "bean" terminology. For example, to configure a connection to
          a MySQL server supporting the world sample database you might
          use:
        </p><pre class="programlisting">&lt;util:map id="dbProps"&gt;
    &lt;entry key="db.driver" value="com.mysql.jdbc.Driver"/&gt;
    &lt;entry key="db.jdbcurl" value="jdbc:mysql://localhost/world"/&gt;
    &lt;entry key="db.username" value="myuser"/&gt;
    &lt;entry key="db.password" value="mypass"/&gt;
&lt;/util:map&gt;

        </pre><p>
          In the above example we are assigning values to properties
          that will be used in the configuration. For the datasource
          configuration:
        </p><pre class="programlisting">&lt;bean id="dataSource"
       class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;
    &lt;property name="driverClassName" value="${db.driver}"/&gt;
    &lt;property name="url" value="${db.jdbcurl}"/&gt;
    &lt;property name="username" value="${db.username}"/&gt;
    &lt;property name="password" value="${db.password}"/&gt;
&lt;/bean&gt;
        </pre><p>
          The placeholders are used to provide values for properties of
          this bean. This means that you can specify all the properties
          of the configuration in one place instead of entering the
          values for each property on each bean. We do, however, need
          one more bean to pull this all together. The last bean is
          responsible for actually replacing the placeholders with the
          property values.
        </p><pre class="programlisting">&lt;bean
 class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
    &lt;property name="properties" ref="dbProps"/&gt;
&lt;/bean&gt;
        </pre><p>
          Now that we have our MySQL data source configured and ready to
          go, we write some Java code to access it. The example below
          will retrieve three random cities and their corresponding
          country using the data source we configured with Spring.
        </p><pre class="programlisting">// Create a new application context. this processes the Spring config
ApplicationContext ctx =
    new ClassPathXmlApplicationContext("ex1appContext.xml");
// Retrieve the data source from the application context
    DataSource ds = (DataSource) ctx.getBean("dataSource");
// Open a database connection using Spring's DataSourceUtils
Connection c = DataSourceUtils.getConnection(ds);
try {
    // retrieve a list of three random cities
    PreparedStatement ps = c.prepareStatement(
        "select City.Name as 'City', Country.Name as 'Country' " +
        "from City inner join Country on City.CountryCode = Country.Code " +
        "order by rand() limit 3");
    ResultSet rs = ps.executeQuery();
    while(rs.next()) {
        String city = rs.getString("City");
        String country = rs.getString("Country");
        System.out.printf("The city %s is in %s%n", city, country);
    }
} catch (SQLException ex) {
    // something has failed and we print a stack trace to analyse the error
    ex.printStackTrace();
    // ignore failure closing connection
    try { c.close(); } catch (SQLException e) { }
} finally {
    // properly release our connection
    DataSourceUtils.releaseConnection(c, ds);
}</pre><p>
          This is very similar to normal JDBC access to MySQL with the
          main difference being that we are using DataSourceUtils
          instead of the DriverManager to create the connection.
        </p><p>
          While it may seem like a small difference, the implications
          are somewhat far reaching. Spring manages this resource in a
          way similar to a container managed data source in a J2EE
          application server. When a connection is opened, it can be
          subsequently accessed in other parts of the code if it is
          synchronized with a transaction. This makes it possible to
          treat different parts of your application as transactional
          instead of passing around a database connection.
        </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-spring-config-jdbctemplate"></a>5.2.4.1. Using <code class="classname">JdbcTemplate</code></h4></div></div></div><p>
            Spring makes extensive use of the Template method design
            pattern (see
            <a href="http://en.wikipedia.org/wiki/Template_method_pattern" target="_top">Template
            Method Pattern</a>). Our immediate focus will be on the
            <code class="literal">JdbcTemplate</code> and related classes,
            specifically <code class="literal">NamedParameterJdbcTemplate</code>.
            The template classes handle obtaining and releasing a
            connection for data access when one is needed.
          </p><p>
            The next example shows how to use
            <code class="literal">NamedParameterJdbcTemplate</code> inside of a
            DAO (Data Access Object) class to retrieve a random city
            given a country code.
          </p><pre class="programlisting">public class Ex2JdbcDao {
     /**
     * Data source reference which will be provided by Spring.
     */
     private DataSource dataSource;
     /**
     * Our query to find a random city given a country code. Notice
     * the ":country" parameter toward the end. This is called a
     * named parameter.
     */
     private String queryString = "select Name from City " +
        "where CountryCode = :country order by rand() limit 1";
     /**
     * Retrieve a random city using Spring JDBC access classes.
     */
     public String getRandomCityByCountryCode(String cntryCode) {
         // A template that permits using queries with named parameters
         NamedParameterJdbcTemplate template =
         new NamedParameterJdbcTemplate(dataSource);
         // A java.util.Map is used to provide values for the parameters
         Map params = new HashMap();
         params.put("country", cntryCode);
         // We query for an Object and specify what class we are expecting
         return (String)template.queryForObject(queryString, params, String.class);
     }
    /**
    * A JavaBean setter-style method to allow Spring to inject the data source.
    * @param dataSource
    */
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }
}
   </pre><p>
            The focus in the above code is on the
            <code class="function">getRandomCityByCountryCode()</code> method. We
            pass a country code and use the
            <code class="literal">NamedParameterJdbcTemplate</code> to query for a
            city. The country code is placed in a Map with the key
            "country", which is the parameter is named in the SQL query.
          </p><p>
            To access this code, you need to configure it with Spring by
            providing a reference to the data source.
          </p><pre class="programlisting">&lt;bean id="dao" class="code.Ex2JdbcDao"&gt;
    &lt;property name="dataSource" ref="dataSource"/&gt;
&lt;/bean&gt;</pre><p>
            At this point, we can just grab a reference to the DAO from
            Spring and call
            <code class="function">getRandomCityByCountryCode()</code>.
          </p><pre class="programlisting">// Create the application context
    ApplicationContext ctx =
    new ClassPathXmlApplicationContext("ex2appContext.xml");
    // Obtain a reference to our DAO
    Ex2JdbcDao dao = (Ex2JdbcDao) ctx.getBean("dao");
    String countryCode = "USA";
    // Find a few random cities in the US
    for(int i = 0; i &lt; 4; ++i)
        System.out.printf("A random city in %s is %s%n", countryCode,
            dao.getRandomCityByCountryCode(countryCode));
</pre><p>
            This example shows how to use Spring's JDBC classes to
            completely abstract away the use of traditional JDBC classes
            including <code class="literal">Connection</code> and
            <code class="literal">PreparedStatement</code>.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-spring-config-transactional"></a>5.2.4.2. Transactional JDBC Access</h4></div></div></div><p>
            You might be wondering how we can add transactions into our
            code if we do not deal directly with the JDBC classes.
            Spring provides a transaction management package that not
            only replaces JDBC transaction management, but also enables
            declarative transaction management (configuration instead of
            code).
          </p><p>
            To use transactional database access, we will need to change
            the storage engine of the tables in the world database. The
            downloaded script explicitly creates MyISAM tables which do
            not support transactional semantics. The InnoDB storage
            engine does support transactions and this is what we will be
            using. We can change the storage engine with the following
            statements.
          </p><pre class="programlisting">ALTER TABLE City ENGINE=InnoDB;
ALTER TABLE Country ENGINE=InnoDB;
ALTER TABLE CountryLanguage ENGINE=InnoDB;
</pre><p>
            A good programming practice emphasized by Spring is
            separating interfaces and implementations. What this means
            is that we can create a Java interface and only use the
            operations on this interface without any internal knowledge
            of what the actual implementation is. We will let Spring
            manage the implementation and with this it will manage the
            transactions for our implementation.
          </p><p>
            First you create a simple interface:
          </p><pre class="programlisting">public interface Ex3Dao {
    Integer createCity(String name, String countryCode,
    String district, Integer population);
}
</pre><p>
            This interface contains one method that will create a new
            city record in the database and return the id of the new
            record. Next you need to create an implementation of this
            interface.
          </p><pre class="programlisting">public class Ex3DaoImpl implements Ex3Dao {
    protected DataSource dataSource;
    protected SqlUpdate updateQuery;
    protected SqlFunction idQuery;
    public Integer createCity(String name, String countryCode,
        String district, Integer population) {
            updateQuery.update(new Object[] { name, countryCode,
                   district, population });
            return getLastId();
        }
    protected Integer getLastId() {
        return idQuery.run();
    }
}
</pre><p>
            You can see that we only operate on abstract query objects
            here and do not deal directly with the JDBC API. Also, this
            is the complete implementation. All of our transaction
            management will be dealt with in the configuration. To get
            the configuration started, we need to create the DAO.
          </p><pre class="programlisting">&lt;bean id="dao" class="code.Ex3DaoImpl"&gt;
    &lt;property name="dataSource" ref="dataSource"/&gt;
    &lt;property name="updateQuery"&gt;...&lt;/property&gt;
    &lt;property name="idQuery"&gt;...&lt;/property&gt;
&lt;/bean&gt;
</pre><p>
            Now you need to set up the transaction configuration. The
            first thing you must do is create transaction manager to
            manage the data source and a specification of what
            transaction properties are required for the
            <code class="literal">dao</code> methods.
          </p><pre class="programlisting">&lt;bean id="transactionManager"
  class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt;
    &lt;property name="dataSource" ref="dataSource"/&gt;
&lt;/bean&gt;
&lt;tx:advice id="txAdvice" transaction-manager="transactionManager"&gt;
    &lt;tx:attributes&gt;
        &lt;tx:method name="*"/&gt;
    &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;</pre><p>
            The preceding code creates a transaction manager that
            handles transactions for the data source provided to it. The
            <code class="literal">txAdvice</code> uses this transaction manager
            and the attributes specify to create a transaction for all
            methods. Finally you need to apply this advice with an AOP
            pointcut.
          </p><pre class="programlisting">&lt;aop:config&gt;
    &lt;aop:pointcut id="daoMethods"
        expression="execution(* code.Ex3Dao.*(..))"/&gt;
     &lt;aop:advisor advice-ref="txAdvice" pointcut-ref="daoMethods"/&gt;
&lt;/aop:config&gt;</pre><p>
            This basically says that all methods called on the
            <code class="literal">Ex3Dao</code> interface will be wrapped in a
            transaction. To make use of this, you only have to retrieve
            the <code class="literal">dao</code> from the application context and
            call a method on the <code class="literal">dao</code> instance.
          </p><pre class="programlisting">Ex3Dao dao = (Ex3Dao) ctx.getBean("dao");
Integer id = dao.createCity(name,  countryCode, district, pop);
</pre><p>
            We can verify from this that there is no transaction
            management happening in our Java code and it is all
            configured with Spring. This is a very powerful notion and
            regarded as one of the most beneficial features of Spring.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-spring-config-connpooling"></a>5.2.4.3. Connection Pooling</h4></div></div></div><p>
            In many situations, such as web applications, there will be a
            large number of small database transactions. When this is
            the case, it usually makes sense to create a pool of
            database connections available for web requests as needed.
            Although MySQL does not spawn an extra process when a
            connection is made, there is still a small amount of
            overhead to create and set up the connection. Pooling of
            connections also alleviates problems such as collecting
            large amounts of sockets in the <code class="literal">TIME_WAIT</code>
            state.
          </p><p>
            Setting up pooling of MySQL connections with Spring is as
            simple as changing the data source configuration in the
            application context. There are a number of configurations
            that we can use. The first example is based on the
            <a href="http://jakarta.apache.org/commons/dbcp/" target="_top">Jakarta
            Commons DBCP library</a>. The example below replaces the
            source configuration that was based on
            <code class="literal">DriverManagerDataSource</code> with DBCP's
            BasicDataSource.
          </p><pre class="programlisting">&lt;bean id="dataSource" destroy-method="close"
  class="org.apache.commons.dbcp.BasicDataSource"&gt;
    &lt;property name="driverClassName" value="${db.driver}"/&gt;
    &lt;property name="url" value="${db.jdbcurl}"/&gt;
    &lt;property name="username" value="${db.username}"/&gt;
    &lt;property name="password" value="${db.password}"/&gt;
    &lt;property name="initialSize" value="3"/&gt;
&lt;/bean&gt;</pre><p>
            The configuration of the two solutions is very similar. The
            difference is that DBCP will pool connections to the
            database instead of creating a new connection every time one
            is requested. We have also set a parameter here called
            <code class="literal">initialSize</code>. This tells DBCP that we want
            three connections in the pool when it is created.
          </p><p>
            Another way to configure connection pooling is to configure
            a data source in our J2EE application server. Using JBoss as
            an example, you can set up the MySQL connection pool by
            creating a file called
            <code class="filename">mysql-local-ds.xml</code> and placing it in
            the server/default/deploy directory in JBoss. Once we have
            this setup, we can use JNDI to look it up. With Spring, this
            lookup is very simple. The data source configuration looks
            like this.
          </p><pre class="programlisting">&lt;jee:jndi-lookup id="dataSource" jndi-name="java:MySQL_DS"/&gt;</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="connector-j-usagenotes-glassfish-config"></a>5.2.5. Using Connector/J with GlassFish</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#connector-j-usagenotes-glassfish-config-jsp">5.2.5.1. A Simple JSP Application with Glassfish, Connector/J and MySQL</a></span></dt><dt><span class="section"><a href="#connector-j-usagenotes-glassfish-config-servlet">5.2.5.2. A Simple Servlet with Glassfish, Connector/J and MySQL</a></span></dt></dl></div><p>
          This section explains how to use MySQL Connector/J with Glassfish ™
          Server Open Source Edition 3.0.1. Glassfish can be downloaded
          from the
          <a href="https://glassfish.dev.java.net/public/downloadsindex.html#top" target="_top">Glassfish
          website</a>.
        </p><p>
          Once Glassfish is installed you will need to make sure it can
          access MySQL Connector/J. To do this copy the MySQL Connector/J JAR file to the
          directory
          <code class="filename"><em class="replaceable"><code>GLASSFISH_INSTALL</code></em>/glassfish/lib</code>.
          For example, copy
          <code class="filename">mysql-connector-java-5.1.12-bin.jar</code> to
          <code class="filename">C:\glassfishv3\glassfish\lib</code>. Restart the
          Glassfish Application Server.
        </p><p>
          You are now ready to create JDBC Connection Pools and JDBC
          Resources.
        </p><p>
          <span class="bold"><strong>Creating a Connection Pool</strong></span>
        </p><div class="orderedlist"><ol type="1"><li><p>
              In the Glassfish Administration Console, using the
              navigation tree navigate to
              <span class="guilabel">Resources</span>, <span class="guilabel">JDBC</span>,
              <span class="guilabel">Connection Pools</span>.
            </p></li><li><p>
              In the <span class="guilabel">JDBC Connection Pools</span> frame
              click <span class="guibutton">New</span>. You will enter a two
              step wizard.
            </p></li><li><p>
              In the <span class="guilabel">Name</span> field under
              <span class="guilabel">General Settings</span> enter the name for
              the connection pool, for example enter
              <strong class="userinput"><code>MySQLConnPool</code></strong>.
            </p></li><li><p>
              In the <span class="guilabel">Resource Type</span> field, select
              <code class="literal">javax.sql.DataSource</code> from the drop-down
              listbox.
            </p></li><li><p>
              In the <span class="guilabel">Database Vendor</span> field, select
              <code class="literal">MySQL</code> from the drop-down listbox. Click
              <span class="guibutton">Next</span> to go to the next page of the
              wizard.
            </p></li><li><p>
              You can accept the default settings for General Settings,
              Pool Settings and Transactions for this example. Scroll
              down to Additional Properties.
            </p></li><li><p>
              In Additional Properties you will need to ensure the
              following properties are set:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  <span class="bold"><strong>ServerName</strong></span> - The
                  server you wish to connect to. For local testing this
                  will be <code class="literal">localhost</code>.
                </p></li><li><p>
                  <span class="bold"><strong>User</strong></span> - The user name
                  with which to connect to MySQL.
                </p></li><li><p>
                  <span class="bold"><strong>Password</strong></span> - The
                  corresponding password for the user.
                </p></li><li><p>
                  <span class="bold"><strong>DatabaseName</strong></span> - The
                  database you wish to connect to, for example the
                  sample MySQL database <code class="literal">World</code>.
                </p></li></ul></div></li><li><p>
              Click <span class="guibutton">Finish</span> to exit the wizard.
              You will be taken to the <span class="guilabel">JDBC Connection
              Pools</span> page where all current connection pools,
              including the one you just created, will be displayed.
            </p></li><li><p>
              In the <span class="guilabel">JDBC Connection Pools</span> frame
              click on the connection pool you just created. Here you
              can review and edit information about the connection pool.
            </p></li><li><p>
              To test your connection pool click the
              <span class="guibutton">Ping</span> button at the top of the
              frame. A message will be displayed confirming correct
              operation or otherwise. If an error message is received
              recheck the previous steps, and ensure that MySQL Connector/J has been
              correctly copied into the previously specified location.
            </p></li></ol></div><p>
          Now that you have created a connection pool you will also need
          to create a JDBC Resource (data source) for use by your
          application.
        </p><p>
          <span class="bold"><strong>Creating a JDBC Resource</strong></span>
        </p><p>
          Your Java application will usually reference a data source
          object to establish a connection with the database. This needs
          to be created first using the following procedure.
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              Using the navigation tree in the Glassfish Administration
              Console, navigate to <span class="guilabel">Resources</span>,
              <span class="guilabel">JDBC</span>, <span class="guilabel">JDBC
              Resources</span>. A list of resources will be
              displayed in the <span class="guilabel">JDBC Resources</span>
              frame.
            </p></li><li><p>
              Click <span class="guibutton">New</span>. The <span class="guilabel">New JDBC
              Resource</span> frame will be displayed.
            </p></li><li><p>
              In the <span class="guilabel">JNDI Name</span> field, enter the
              JNDI name that will be used to access this resource, for
              example enter <strong class="userinput"><code>jdbc/MySQLDataSource</code></strong>.
            </p></li><li><p>
              In the <span class="guilabel">Pool Name</span> field, select a
              connection pool you want this resource to use from the
              drop-down listbox.
            </p></li><li><p>
              Optionally, you can enter a description into the
              <span class="guilabel">Description</span> field.
            </p></li><li><p>
              Additional properties can be added if required.
            </p></li><li><p>
              Click <span class="guibutton">OK</span> to create the new JDBC
              resource. The <span class="guilabel">JDBC Resources</span> frame
              will list all available JDBC Resources.
            </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-glassfish-config-jsp"></a>5.2.5.1. A Simple JSP Application with Glassfish, Connector/J and MySQL</h4></div></div></div><p>
            This section shows how to deploy a simple JSP application on
            Glassfish, that connects to a MySQL database.
          </p><p>
            This example assumes you have already set up a suitable
            Connection Pool and JDBC Resource, as explained in the
            preceding sections. It is also assumed you have a sample
            database installed, such as <code class="literal">world</code>.
          </p><p>
            The main application code, <code class="filename">index.jsp</code> is
            presented here:
          </p><pre class="programlisting">
&lt;%@ page import="java.sql.*, javax.sql.*, java.io.*, javax.naming.*" %&gt;
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Hello world from JSP&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;%
  InitialContext ctx;
  DataSource ds;
  Connection conn;
  Statement stmt;
  ResultSet rs;
  try {
    ctx = new InitialContext();
    ds = (DataSource) ctx.lookup("java:comp/env/jdbc/MySQLDataSource");
    //ds = (DataSource) ctx.lookup("jdbc/MySQLDataSource");
    conn = ds.getConnection();
    stmt = conn.createStatement();
    rs = stmt.executeQuery("SELECT * FROM Country");
    while(rs.next()) {
%&gt;
    &lt;h3&gt;Name: &lt;%= rs.getString("Name") %&gt;&lt;/h3&gt;
    &lt;h3&gt;Population: &lt;%= rs.getString("Population") %&gt;&lt;/h3&gt;
&lt;%    
    }
  }
  catch (SQLException se) {
%&gt;
    &lt;%= se.getMessage() %&gt;
&lt;%      
  }
  catch (NamingException ne) {
%&gt;  
    &lt;%= ne.getMessage() %&gt;
&lt;%
  }
%&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre><p>
            In addition two XML files are required:
            <code class="filename">web.xml</code>, and
            <code class="filename">sun-web.xml</code>. There may be other files
            present, such as classes and images. These files are
            organized into the directory structure as follows:
          </p><pre class="programlisting">index.jsp
WEB-INF
   |
   - web.xml
   - sun-web.xml
</pre><p>
            The code for <code class="filename">web.xml</code> is:
          </p><pre class="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"&gt;
  &lt;display-name&gt;HelloWebApp&lt;/display-name&gt;  
  &lt;distributable/&gt;
  &lt;resource-ref&gt;
    &lt;res-ref-name&gt;jdbc/MySQLDataSource&lt;/res-ref-name&gt;
    &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;
    &lt;res-auth&gt;Container&lt;/res-auth&gt;
    &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;                
  &lt;/resource-ref&gt;
&lt;/web-app&gt;

</pre><p>
            The code for <code class="filename">sun-web.xml</code> is:
          </p><pre class="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE sun-web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Application Server 8.1 Servlet 2.4//EN" "http://www.sun.com/software/appserver/dtds/sun-web-app_2_4-1.dtd"&gt;
&lt;sun-web-app&gt;
  &lt;context-root&gt;HelloWebApp&lt;/context-root&gt;
  &lt;resource-ref&gt;
    &lt;res-ref-name&gt;jdbc/MySQLDataSource&lt;/res-ref-name&gt;
    &lt;jndi-name&gt;jdbc/MySQLDataSource&lt;/jndi-name&gt;  
  &lt;/resource-ref&gt; 
&lt;/sun-web-app&gt;

</pre><p>
            These XML files illustrate a very important aspect of
            running JDBC applications on Glassfish. On Glassfish it is
            important to map the string specified for a JDBC resource to
            its JNDI name, as set up in the Glassfish administration
            console. In this example, the JNDI name for the JDBC
            resource, as specified in the Glassfish Administration
            console when creating the JDBC Resource, was
            <code class="literal">jdbc/MySQLDataSource</code>. This must be mapped
            to the name given in the application. In this example the
            name specified in the application,
            <code class="literal">jdbc/MySQLDataSource</code>, and the JNDI name,
            happen to be the same, but this does not necessarily have to
            be the case. Note that the XML element &lt;res-ref-name&gt;
            is used to specify the name as used in the application
            source code, and this is mapped to the JNDI name specified
            using the &lt;jndi-name&gt; element, in the file
            <code class="filename">sun-web.xml</code>. The resource also has to
            be created in the <code class="filename">web.xml</code> file,
            although the mapping of the resource to a JNDI name takes
            place in the <code class="filename">sun-web.xml</code> file.
          </p><p>
            If you do not have this mapping set up correctly in the XML
            files you will not be able to lookup the data source using a
            JNDI lookup string such as:
          </p><pre class="programlisting">ds = (DataSource) ctx.lookup("java:comp/env/jdbc/MySQLDataSource");
</pre><p>
            You will still be able to access the data source directly
            using:
          </p><pre class="programlisting">ds = (DataSource) ctx.lookup("jdbc/MySQLDataSource");
</pre><p>
            With the source files in place, in the correct directory
            structure, you are ready to deploy the application:
          </p><div class="orderedlist"><ol type="1"><li><p>
                In the navigation tree, navigate to
                <span class="guilabel">Applications</span> - the
                <span class="guilabel">Applications</span> frame will be
                displayed. Click <span class="guibutton">Deploy</span>.
              </p></li><li><p>
                You can now deploy an application packaged into a single
                WAR file from a remote client, or you can choose a
                packaged file or directory that is locally accessible to
                the server. If you are simply testing an application
                locally you can simply point Glassfish at the directory
                that contains your application, without needing to
                package the application into a WAR file.
              </p></li><li><p>
                Now select the application type from the
                <span class="guilabel">Type</span> drop-down listbox, which in
                this example is <code class="literal">Web application</code>.
              </p></li><li><p>
                Click OK.
              </p></li></ol></div><p>
            Now, when you navigate to the
            <span class="guilabel">Applications</span> frame, you will have the
            option to <span class="guilabel">Launch</span>,
            <span class="guilabel">Redeploy</span>, or
            <span class="guilabel">Restart</span> your application. You can test
            your application by clicking <span class="guilabel">Launch</span>.
            The application will connection to the MySQL database and
            display the Name and Population of countries in the
            <code class="literal">Country</code> table.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="connector-j-usagenotes-glassfish-config-servlet"></a>5.2.5.2. A Simple Servlet with Glassfish, Connector/J and MySQL</h4></div></div></div><p>
            This section describes a simple servlet that can be used in
            the Glassfish environment to access a MySQL database. As
            with the previous section, this example assumes the sample
            database <code class="literal">world</code> is installed.
          </p><p>
            The project is set up with the following directory
            structure:
          </p><pre class="programlisting">index.html
WEB-INF
   |
   - web.xml
   - sun-web.xml
   - classes
        |
        - HelloWebServlet.java
        - HelloWebServlet.class
</pre><p>
            The code for the servlet, located in
            <code class="filename">HelloWebServlet.java</code>, is as follows:
          </p><pre class="programlisting">
import javax.servlet.http.*;
import javax.servlet.*;
import java.io.*;
import java.sql.*;
import javax.sql.*;
import javax.naming.*;
public class HelloWebServlet extends HttpServlet {
  InitialContext ctx = null;
  DataSource ds = null;
  Connection conn = null;
  PreparedStatement ps = null;
  ResultSet rs = null;
  String sql = "SELECT Name, Population FROM Country WHERE Name=?";
  public void init () throws ServletException {
    try {
      ctx = new InitialContext();
      ds = (DataSource) ctx.lookup("java:comp/env/jdbc/MySQLDataSource");
      conn = ds.getConnection();
      ps = conn.prepareStatement(sql);
    }
    catch (SQLException se) {
      System.out.println("SQLException: "+se.getMessage());
    }
    catch (NamingException ne) {
      System.out.println("NamingException: "+ne.getMessage());  
    }  
  }
  public void destroy () {
    try {
      if (rs != null)
        rs.close();
      if (ps != null)
        ps.close();
      if (conn != null)
        conn.close();
      if (ctx != null)
        ctx.close(); 
    }     
    catch (SQLException se) {
      System.out.println("SQLException: "+se.getMessage());
    }
    catch (NamingException ne) {
      System.out.println("NamingException: "+ne.getMessage());  
    }  
  }
  public void doPost(HttpServletRequest req, HttpServletResponse resp){
    try {
      String country_name = req.getParameter("country_name");    
      resp.setContentType("text/html");
      PrintWriter writer = resp.getWriter();
      writer.println("&lt;html&gt;&lt;body&gt;");
      writer.println("&lt;p&gt;Country: "+country_name+"&lt;/p&gt;");
      ps.setString(1, country_name);
      rs = ps.executeQuery();
      if (!rs.next()){
        writer.println("&lt;p&gt;Country does not exist!&lt;/p&gt;");
      }
      else {
        rs.beforeFirst();
        while(rs.next()) {
          writer.println("&lt;p&gt;Name: "+rs.getString("Name")+"&lt;/p&gt;");
          writer.println("&lt;p&gt;Population: "+rs.getString("Population")+"&lt;/p&gt;");
        }
      }
      writer.println("&lt;/body&gt;&lt;/html&gt;");
      writer.close(); 
    }
    catch (Exception e) {
      e.printStackTrace();
    }  
  }
  public void doGet(HttpServletRequest req, HttpServletResponse resp){
    try {    
      resp.setContentType("text/html");
      PrintWriter writer = resp.getWriter();
      writer.println("&lt;html&gt;&lt;body&gt;");
      writer.println("&lt;p&gt;Hello from servlet doGet()&lt;/p&gt;");
      writer.println("&lt;/body&gt;&lt;/html&gt;");
      writer.close(); 
    }
    catch (Exception e) {
      e.printStackTrace();
    }  
  }
}

</pre><p>
            In the preceding code a basic <code class="literal">doGet()</code>
            method is implemented, but is not used in the example. The
            code to establish the connection with the database is as
            shown in the previous example,
            <a href="#connector-j-usagenotes-glassfish-config-jsp" title="5.2.5.1. A Simple JSP Application with Glassfish, Connector/J and MySQL">Section 5.2.5.1, “A Simple JSP Application with Glassfish, Connector/J and MySQL”</a>,
            and is most conveniently located in the servlet
            <code class="literal">init()</code> method. The corresponding freeing
            of resources is located in the destroy method. The main
            functionality of the servlet is located in the
            <code class="literal">doPost()</code> method. If the user enters nto
            the input form a country name that can be located in the
            database, the population of the country is returned. The
            code is invoked using a POST action associated with the
            input form. The form is defined in the file
            <code class="filename">index.html</code>:
          </p><pre class="programlisting">
&lt;html&gt;
  &lt;head&gt;&lt;title&gt;HelloWebServlet&lt;/title&gt;&lt;/head&gt;
  
  &lt;body&gt;
    &lt;h1&gt;HelloWebServlet&lt;/h1&gt;
    
    &lt;p&gt;Please enter country name:&lt;/p&gt;
    
    &lt;form action="HelloWebServlet" method="POST"&gt;
      &lt;input type="text" name="country_name" length="50" /&gt;
      &lt;input type="submit" value="Submit" /&gt;
    &lt;/form&gt;
    
  &lt;/body&gt;
&lt;/html&gt;

</pre><p>
            The XML files <code class="filename">web.xml</code> and
            <code class="filename">sun-web.xml</code> are as for the example in
            the preceding section,
            <a href="#connector-j-usagenotes-glassfish-config-jsp" title="5.2.5.1. A Simple JSP Application with Glassfish, Connector/J and MySQL">Section 5.2.5.1, “A Simple JSP Application with Glassfish, Connector/J and MySQL”</a>,
            no additional changes are required.
          </p><p>
            Whe compiling the Java source code, you will need to specify
            the path to the file <code class="filename">javaee.jar</code>. On
            Windows, this can be done as follows:
          </p><pre class="programlisting">shell&gt; javac -classpath c:\glassfishv3\glassfish\lib\javaee.jar HelloWebServlet.java 
</pre><p>
            Once the code is correctly located within its directory
            structure, and compiled, the application can be deployed in
            Glassfish. This is done in exactly the same way as described
            in the preceding section,
            <a href="#connector-j-usagenotes-glassfish-config-jsp" title="5.2.5.1. A Simple JSP Application with Glassfish, Connector/J and MySQL">Section 5.2.5.1, “A Simple JSP Application with Glassfish, Connector/J and MySQL”</a>.
          </p><p>
            Once deployed the application can be launched from within
            the Glassfish Administration Console. Enter a country name
            such as “<span class="quote">England</span>”, and the application will
            return “<span class="quote">Country does not exist!</span>”. Enter
            “<span class="quote">France</span>”, and the application will return a
            population of 59225700.
          </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-usagenotes-troubleshooting"></a>5.3. Connector/J: Common Problems and Solutions</h2></div></div></div><p>
        There are a few issues that seem to be commonly encountered
        often by users of MySQL Connector/J. This section deals with
        their symptoms, and their resolutions.
      </p><p><span class="bold"><strong>Questions</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p><a href="#qandaitem-5-3-1-1">5.3.1: </a>
              When I try to connect to the database with MySQL
              Connector/J, I get the following exception:
            </p><pre class="programlisting">SQLException: Server configuration denies access to data source
SQLState: 08001
VendorError: 0</pre><p>
              What is going on? I can connect just fine with the MySQL
              command-line client.
            </p></li><li><p><a href="#qandaitem-5-3-1-2">5.3.2: </a>
              My application throws an SQLException 'No Suitable
              Driver'. Why is this happening?
            </p></li><li><p><a href="#qandaitem-5-3-1-3">5.3.3: </a>
              I'm trying to use MySQL Connector/J in an applet or
              application and I get an exception similar to:
            </p><pre class="programlisting">SQLException: Cannot connect to MySQL server on host:3306.
Is there a MySQL server running on the machine/port you
are trying to connect to?
(java.security.AccessControlException)
SQLState: 08S01
VendorError: 0 </pre></li><li><p><a href="#qandaitem-5-3-1-4">5.3.4: </a>
              I have a servlet/application that works fine for a day,
              and then stops working overnight
            </p></li><li><p><a href="#qandaitem-5-3-1-5">5.3.5: </a>
              I'm trying to use JDBC-2.0 updatable result sets, and I
              get an exception saying my result set is not updatable.
            </p></li><li><p><a href="#qandaitem-5-3-1-6">5.3.6: </a>
              I cannot connect to the MySQL server using Connector/J,
              and I'm sure the connection paramters are correct.
            </p></li><li><p><a href="#qandaitem-5-3-1-7">5.3.7: </a>
              I am trying to connect to my MySQL server within my
              application, but I get the following error and stack
              trace:
            </p><pre class="programlisting">java.net.SocketException
MESSAGE: Software caused connection abort: recv failed
STACKTRACE:
java.net.SocketException: Software caused connection abort: recv failed
at java.net.SocketInputStream.socketRead0(Native Method)
at java.net.SocketInputStream.read(Unknown Source)
at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1392)
at com.mysql.jdbc.MysqlIO.readPacket(MysqlIO.java:1414)
at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:625)
at com.mysql.jdbc.Connection.createNewIO(Connection.java:1926)
at com.mysql.jdbc.Connection.&lt;init&gt;(Connection.java:452)
at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:411)</pre></li><li><p><a href="#qandaitem-5-3-1-8">5.3.8: </a>
              My application is deployed through JBoss and I am using
              transactions to handle the statements on the MySQL
              database. Under heavy loads I am getting a error and stack
              trace, but these only occur after a fixed period of heavy
              activity.
            </p></li><li><p><a href="#qandaitem-5-3-1-9">5.3.9: </a>
              When using <span><strong class="command">gcj</strong></span> an
              <code class="literal">java.io.CharConversionException</code> is
              raised when working with certain character sequences.
            </p></li><li><p><a href="#qandaitem-5-3-1-10">5.3.10: </a>
              Updating a table that contains a primary key that is
              either <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a> or compound
              primary key that uses <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a>
              fails to update the table and raises an exception.
            </p></li><li><p><a href="#qandaitem-5-3-1-11">5.3.11: </a>
              You get an
              <a href="http://dev.mysql.com/doc/refman/5.5/en/error_er_net_packet_too_large.html#error_er_net_packet_too_large" target="_top"><code class="literal">ER_NET_PACKET_TOO_LARGE</code></a>
              exception, even though the binary blob size you want to
              insert using JDBC is safely below the
              <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> size.
            </p></li><li><p><a href="#qandaitem-5-3-1-12">5.3.12: </a>
              What should you do if you receive error messages similar
              to the following: “<span class="quote">Communications link failure –
              Last packet sent to the server was X ms ago</span>”?
            </p></li><li><p><a href="#qandaitem-5-3-1-13">5.3.13: </a>
              Why does Connector/J not reconnect to MySQL and re-issue
              the statement after a communication failure, instead of
              throwing an Exception, even though I use the
              <code class="literal">autoReconnect</code> connection string option?
            </p></li><li><p><a href="#qandaitem-5-3-1-14">5.3.14: </a>
              How can I use 3-byte UTF8 with Connector/J?
            </p></li><li><p><a href="#qandaitem-5-3-1-15">5.3.15: </a>
              How can I use 4-byte UTF8, <code class="literal">utf8mb4</code> with
              Connector/J?
            </p></li><li><p><a href="#qandaitem-5-3-1-16">5.3.16: </a>
              Using <code class="literal">useServerPrepStmts=false</code> and
              certain character encodings can lead to corruption when
              inserting BLOBs. How can this be avoided?
            </p></li></ul></div><p><span class="bold"><strong>Questions and Answers</strong></span></p><p><a name="qandaitem-5-3-1-1"></a><span class="bold"><strong>5.3.1: </strong></span><span class="bold"><strong>
              When I try to connect to the database with MySQL
              Connector/J, I get the following exception:
            </strong></span></p><pre class="programlisting">SQLException: Server configuration denies access to data source
SQLState: 08001
VendorError: 0</pre><p><span class="bold"><strong>
              What is going on? I can connect just fine with the MySQL
              command-line client.
            </strong></span></p><p>
              MySQL Connector/J must use TCP/IP sockets to connect to
              MySQL, as Java does not support Unix Domain Sockets.
              Therefore, when MySQL Connector/J connects to MySQL, the
              security manager in MySQL server will use its grant tables
              to determine whether the connection should be permitted.
            </p><p>
              You must add the necessary security credentials to the
              MySQL server for this to happen, using the
              <a href="http://dev.mysql.com/doc/refman/5.5/en/grant.html" target="_top"><code class="literal">GRANT</code></a> statement to your
              MySQL Server. See <a href="http://dev.mysql.com/doc/refman/5.5/en/grant.html" target="_top"><code class="literal">GRANT</code> Syntax</a>, for more
              information.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
                Testing your connectivity with the
                <span><strong class="command">mysql</strong></span> command-line client will not
                work unless you add the
                <a href="http://dev.mysql.com/doc/refman/5.5/en/mysql.html#option_mysql_host" target="_top"><code class="option">--host</code></a> flag, and use
                something other than <code class="literal">localhost</code> for
                the host. The <span><strong class="command">mysql</strong></span> command-line
                client will use Unix domain sockets if you use the
                special host name <code class="literal">localhost</code>. If you
                are testing connectivity to
                <code class="literal">localhost</code>, use
                <code class="literal">127.0.0.1</code> as the host name instead.
              </p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Warning</div><p>
                Changing privileges and permissions improperly in MySQL
                can potentially cause your server installation to not
                have optimal security properties.
              </p></div><p><a name="qandaitem-5-3-1-2"></a><span class="bold"><strong>5.3.2: </strong></span><span class="bold"><strong>
              My application throws an SQLException 'No Suitable
              Driver'. Why is this happening?
            </strong></span></p><p>
              There are three possible causes for this error:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  The Connector/J driver is not in your
                  <code class="literal">CLASSPATH</code>, see
                  <a href="#connector-j-installing" title="Chapter 2. Connector/J Installation">Chapter 2, <i>Connector/J Installation</i></a>.
                </p></li><li><p>
                  The format of your connection URL is incorrect, or you
                  are referencing the wrong JDBC driver.
                </p></li><li><p>
                  When using DriverManager, the
                  <code class="literal">jdbc.drivers</code> system property has
                  not been populated with the location of the
                  Connector/J driver.
                </p></li></ul></div><p><a name="qandaitem-5-3-1-3"></a><span class="bold"><strong>5.3.3: </strong></span><span class="bold"><strong>
              I'm trying to use MySQL Connector/J in an applet or
              application and I get an exception similar to:
            </strong></span></p><pre class="programlisting">SQLException: Cannot connect to MySQL server on host:3306.
Is there a MySQL server running on the machine/port you
are trying to connect to?
(java.security.AccessControlException)
SQLState: 08S01
VendorError: 0 </pre><p>
              Either you're running an Applet, your MySQL server has
              been installed with the "--skip-networking" option set, or
              your MySQL server has a firewall sitting in front of it.
            </p><p>
              Applets can only make network connections back to the
              machine that runs the web server that served the .class
              files for the applet. This means that MySQL must run on
              the same machine (or you must have some sort of port
              re-direction) for this to work. This also means that you
              will not be able to test applets from your local file
              system, you must always deploy them to a web server.
            </p><p>
              MySQL Connector/J can only communicate with MySQL using
              TCP/IP, as Java does not support Unix domain sockets.
              TCP/IP communication with MySQL might be affected if MySQL
              was started with the "--skip-networking" flag, or if it is
              firewalled.
            </p><p>
              If MySQL has been started with the "--skip-networking"
              option set (the Debian Linux package of MySQL server does
              this for example), you need to comment it out in the file
              /etc/mysql/my.cnf or /etc/my.cnf. Of course your my.cnf
              file might also exist in the <code class="filename">data</code>
              directory of your MySQL server, or anywhere else
              (depending on how MySQL was compiled for your system).
              Binaries created by us always look in /etc/my.cnf and
              [datadir]/my.cnf. If your MySQL server has been
              firewalled, you will need to have the firewall configured
              to allow TCP/IP connections from the host where your Java
              code is running to the MySQL server on the port that MySQL
              is listening to (by default, 3306).
            </p><p><a name="qandaitem-5-3-1-4"></a><span class="bold"><strong>5.3.4: </strong></span><span class="bold"><strong>
              I have a servlet/application that works fine for a day,
              and then stops working overnight
            </strong></span></p><p>
              MySQL closes connections after 8 hours of inactivity. You
              either need to use a connection pool that handles stale
              connections or use the "autoReconnect" parameter (see
              <a href="#connector-j-reference-configuration-properties" title="4.1. Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J">Section 4.1, “Driver/Datasource Class Names, URL Syntax and Configuration Properties
        for Connector/J”</a>).
            </p><p>
              Also, you should be catching SQLExceptions in your
              application and dealing with them, rather than propagating
              them all the way until your application exits, this is
              just good programming practice. MySQL Connector/J will set
              the SQLState (see
              <code class="literal">java.sql.SQLException.getSQLState()</code> in
              your APIDOCS) to "08S01" when it encounters
              network-connectivity issues during the processing of a
              query. Your application code should then attempt to
              re-connect to MySQL at this point.
            </p><p>
              The following (simplistic) example shows what code that
              can handle these exceptions might look like:
            </p><p>
              </p><div class="example"><a name="connector-j-examples-transaction-retry"></a><p class="title"><b>Example 5.12. Connector/J: Example of transaction with retry logic</b></p><pre class="programlisting">public void doBusinessOp() throws SQLException {
    Connection conn = null;
    Statement stmt = null;
    ResultSet rs = null;
    //
    // How many times do you want to retry the transaction
    // (or at least _getting_ a connection)?
    //
    int retryCount = 5;
    boolean transactionCompleted = false;
    do {
        try {
            conn = getConnection(); // assume getting this from a
                                    // javax.sql.DataSource, or the
                                    // java.sql.DriverManager
            conn.setAutoCommit(false);
            //
            // Okay, at this point, the 'retry-ability' of the
            // transaction really depends on your application logic,
            // whether or not you're using autocommit (in this case
            // not), and whether you're using transactional storage
            // engines
            //
            // For this example, we'll assume that it's _not_ safe
            // to retry the entire transaction, so we set retry
            // count to 0 at this point
            //
            // If you were using exclusively transaction-safe tables,
            // or your application could recover from a connection going
            // bad in the middle of an operation, then you would not
            // touch 'retryCount' here, and just let the loop repeat
            // until retryCount == 0.
            //
            retryCount = 0;
            stmt = conn.createStatement();
            String query = "SELECT foo FROM bar ORDER BY baz";
            rs = stmt.executeQuery(query);
            while (rs.next()) {
            }
            rs.close();
            rs = null;
            stmt.close();
            stmt = null;
            conn.commit();
            conn.close();
            conn = null;
            transactionCompleted = true;
        } catch (SQLException sqlEx) {
            //
            // The two SQL states that are 'retry-able' are 08S01
            // for a communications error, and 40001 for deadlock.
            //
            // Only retry if the error was due to a stale connection,
            // communications problem or deadlock
            //
            String sqlState = sqlEx.getSQLState();
            if ("08S01".equals(sqlState) || "40001".equals(sqlState)) {
                retryCount--;
            } else {
                retryCount = 0;
            }
        } finally {
            if (rs != null) {
                try {
                    rs.close();
                } catch (SQLException sqlEx) {
                    // You'd probably want to log this . . .
                }
            }
            if (stmt != null) {
                try {
                    stmt.close();
                } catch (SQLException sqlEx) {
                    // You'd probably want to log this as well . . .
                }
            }
            if (conn != null) {
                try {
                    //
                    // If we got here, and conn is not null, the
                    // transaction should be rolled back, as not
                    // all work has been done
                    try {
                        conn.rollback();
                    } finally {
                        conn.close();
                    }
                } catch (SQLException sqlEx) {
                    //
                    // If we got an exception here, something
                    // pretty serious is going on, so we better
                    // pass it up the stack, rather than just
                    // logging it. . .
                    throw sqlEx;
                }
            }
        }
    } while (!transactionCompleted &amp;&amp; (retryCount &gt; 0));
}</pre></div><p>
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
                Use of the <code class="option">autoReconnect</code> option is not
                recommended because there is no safe method of
                reconnecting to the MySQL server without risking some
                corruption of the connection state or database state
                information. Instead, you should use a connection pool
                which will enable your application to connect to the
                MySQL server using an available connection from the
                pool. The <code class="option">autoReconnect</code> facility is
                deprecated, and may be removed in a future release.
              </p></div><p><a name="qandaitem-5-3-1-5"></a><span class="bold"><strong>5.3.5: </strong></span><span class="bold"><strong>
              I'm trying to use JDBC-2.0 updatable result sets, and I
              get an exception saying my result set is not updatable.
            </strong></span></p><p>
              Because MySQL does not have row identifiers, MySQL
              Connector/J can only update result sets that have come
              from queries on tables that have at least one primary key,
              the query must select every primary key and the query can
              only span one table (that is, no joins). This is outlined
              in the JDBC specification.
            </p><p>
              Note that this issue only occurs when using updatable
              result sets, and is caused because Connector/J is unable
              to guarantee that it can identify the correct rows within
              the result set to be updated without having a unique
              reference to each row. There is no requirement to have a
              unique field on a table if you are using
              <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a> or
              <a href="http://dev.mysql.com/doc/refman/5.5/en/delete.html" target="_top"><code class="literal">DELETE</code></a> statements on a
              table where you can individually specify the criteria to
              be matched using a <code class="literal">WHERE</code> clause.
            </p><p><a name="qandaitem-5-3-1-6"></a><span class="bold"><strong>5.3.6: </strong></span><span class="bold"><strong>
              I cannot connect to the MySQL server using Connector/J,
              and I'm sure the connection paramters are correct.
            </strong></span></p><p>
              Make sure that the
              <a href="http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_skip-networking" target="_top"><code class="option">skip-networking</code></a> option has
              not been enabled on your server. Connector/J must be able
              to communicate with your server over TCP/IP, named sockets
              are not supported. Also ensure that you are not filtering
              connections through a Firewall or other network security
              system. For more information, see
              <a href="http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html" target="_top"><code class="literal">Can't connect to [local] MySQL server</code></a>.
            </p><p><a name="qandaitem-5-3-1-7"></a><span class="bold"><strong>5.3.7: </strong></span><span class="bold"><strong>
              I am trying to connect to my MySQL server within my
              application, but I get the following error and stack
              trace:
            </strong></span></p><pre class="programlisting">java.net.SocketException
MESSAGE: Software caused connection abort: recv failed
STACKTRACE:
java.net.SocketException: Software caused connection abort: recv failed
at java.net.SocketInputStream.socketRead0(Native Method)
at java.net.SocketInputStream.read(Unknown Source)
at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1392)
at com.mysql.jdbc.MysqlIO.readPacket(MysqlIO.java:1414)
at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:625)
at com.mysql.jdbc.Connection.createNewIO(Connection.java:1926)
at com.mysql.jdbc.Connection.&lt;init&gt;(Connection.java:452)
at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:411)</pre><p>
              The error probably indicates that you are using a older
              version of the Connector/J JDBC driver (2.0.14 or 3.0.x)
              and you are trying to connect to a MySQL server with
              version 4.1x or newer. The older drivers are not
              compatible with 4.1 or newer of MySQL as they do not
              support the newer authentication mechanisms.
            </p><p>
              It is likely that the older version of the Connector/J
              driver exists within your application directory or your
              <code class="literal">CLASSPATH</code> includes the older
              Connector/J package.
            </p><p><a name="qandaitem-5-3-1-8"></a><span class="bold"><strong>5.3.8: </strong></span><span class="bold"><strong>
              My application is deployed through JBoss and I am using
              transactions to handle the statements on the MySQL
              database. Under heavy loads I am getting a error and stack
              trace, but these only occur after a fixed period of heavy
              activity.
            </strong></span></p><p>
              This is a JBoss, not Connector/J, issue and is connected
              to the use of transactions. Under heavy loads the time
              taken for transactions to complete can increase, and the
              error is caused because you have exceeded the predefined
              timeout.
            </p><p>
              You can increase the timeout value by setting the
              <code class="literal">TransactionTimeout</code> attribute to the
              <code class="literal">TransactionManagerService</code> within the
              <code class="filename">/conf/jboss-service.xml</code> file
              (pre-4.0.3) or
              <code class="filename">/deploy/jta-service.xml</code> for JBoss
              4.0.3 or later. See
              <a href="http://wiki.jboss.org/wiki/Wiki.jsp?page=TransactionTimeout" target="_top">TransactionTimeoute</a>
              within the JBoss wiki for more information.
            </p><p><a name="qandaitem-5-3-1-9"></a><span class="bold"><strong>5.3.9: </strong></span><span class="bold"><strong>
              When using <span><strong class="command">gcj</strong></span> an
              <code class="literal">java.io.CharConversionException</code> is
              raised when working with certain character sequences.
            </strong></span></p><p>
              This is a known issue with <span><strong class="command">gcj</strong></span> which
              raises an exception when it reaches an unknown character
              or one it cannot convert. You should add
              <code class="literal">useJvmCharsetConverters=true</code> to your
              connection string to force character conversion outside of
              the <span><strong class="command">gcj</strong></span> libraries, or try a different
              JDK.
            </p><p><a name="qandaitem-5-3-1-10"></a><span class="bold"><strong>5.3.10: </strong></span><span class="bold"><strong>
              Updating a table that contains a primary key that is
              either <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a> or compound
              primary key that uses <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a>
              fails to update the table and raises an exception.
            </strong></span></p><p>
              Connector/J adds conditions to the
              <code class="literal">WHERE</code> clause during an
              <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a> to check the old
              values of the primary key. If there is no match then
              Connector/J considers this a failure condition and raises
              an exception.
            </p><p>
              The problem is that rounding differences between supplied
              values and the values stored in the database may mean that
              the values never match, and hence the update fails. The
              issue will affect all queries, not just those from
              Connector/J.
            </p><p>
              To prevent this issue, use a primary key that does not use
              <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a>. If you have to use a
              floating point column in your primary key use
              <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DOUBLE</code></a> or
              <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> types in place of
              <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a>.
            </p><p><a name="qandaitem-5-3-1-11"></a><span class="bold"><strong>5.3.11: </strong></span><span class="bold"><strong>
              You get an
              <a href="http://dev.mysql.com/doc/refman/5.5/en/error_er_net_packet_too_large.html#error_er_net_packet_too_large" target="_top"><code class="literal">ER_NET_PACKET_TOO_LARGE</code></a>
              exception, even though the binary blob size you want to
              insert using JDBC is safely below the
              <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> size.
            </strong></span></p><p>
              This is because the <code class="literal">hexEscapeBlock()</code>
              method in
              <code class="literal">com.mysql.jdbc.PreparedStatement.streamToBytes()</code>
              may almost double the size of your data.
            </p><p><a name="qandaitem-5-3-1-12"></a><span class="bold"><strong>5.3.12: </strong></span><span class="bold"><strong>
              What should you do if you receive error messages similar
              to the following: “<span class="quote">Communications link failure –
              Last packet sent to the server was X ms ago</span>”?
            </strong></span></p><p>
              Generally speaking, this error suggests that the network
              connection has been closed. There can be several root
              causes:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  Firewalls or routers may clamp down on idle
                  connections (the MySQL client/server protocol does not
                  ping).
                </p></li><li><p>
                  The MySQL Server may be closing idle connections which
                  exceed the <code class="literal">wait_timeout</code> or
                  <code class="literal">interactive_timeout</code> threshold.
                </p></li></ul></div><p>
              To help troubleshoot these issues, the following tips can
              be used. If a recent (5.1.13+) version of Connector/J is
              used, you will see an improved level of information
              compared to earlier versions. Older versions simply
              display the last time a packet was sent to the server,
              which is frequently 0 ms ago. This is of limited use, as
              it may be that a packet was just sent, while a packet from
              the server has not been received for several hours.
              Knowing the period of time since Connector/J last received
              a packet from the server is useful information, so if this
              is not displayed in your exception message, it is
              recommended that you update Connector/J.
            </p><p>
              Further, if the time a packet was last sent/received
              exceeds the <code class="literal">wait_timeout</code> or
              <code class="literal">interactive_timeout</code> threshold, this is
              noted in the exception message.
            </p><p>
              Although network connections can be volatile, the
              following can be helpful in avoiding problems:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  Ensure connections are valid when used from the
                  connection pool. Use a query that starts with
                  <code class="literal">/* ping */</code> to execute a lightweight
                  ping instead of full query. Note, the syntax of the
                  ping needs to be exactly as specified here.
                </p></li><li><p>
                  Minimize the duration a connection object is left idle
                  while other application logic is executed.
                </p></li><li><p>
                  Explicitly validate the connection before using it if
                  the connection has been left idle for an extended
                  period of time.
                </p></li><li><p>
                  Ensure that <code class="literal">wait_timeout</code> and
                  <code class="literal">interactive_timeout</code> are set
                  sufficiently high.
                </p></li><li><p>
                  Ensure that <code class="literal">tcpKeepalive</code> is
                  enabled.
                </p></li><li><p>
                  Ensure that any configurable firewall or router
                  timeout settings allow for the maximum expected
                  connection idle time.
                </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
                Do not expect to be able to reuse a connection without
                problems, if it has being lying idle for a period. If a
                connection is to be reused after being idle for any
                length of time, ensure that you explicitly test it
                before reusing it.
              </p></div><p><a name="qandaitem-5-3-1-13"></a><span class="bold"><strong>5.3.13: </strong></span><span class="bold"><strong>
              Why does Connector/J not reconnect to MySQL and re-issue
              the statement after a communication failure, instead of
              throwing an Exception, even though I use the
              <code class="literal">autoReconnect</code> connection string option?
            </strong></span></p><p>
              There are several reasons for this. The first is
              transactional integrity. The MySQL Reference Manual states
              that “<span class="quote">there is no safe method of reconnecting to the
              MySQL server without risking some corruption of the
              connection state or database state information</span>”.
              Consider the following series of statements for example:
            </p><pre class="programlisting">
conn.createStatement().execute(
  "UPDATE checking_account SET balance = balance - 1000.00 WHERE customer='Smith'");
conn.createStatement().execute(
  "UPDATE savings_account SET balance = balance + 1000.00 WHERE customer='Smith'");
conn.commit();

</pre><p>
              Consider the case where the connection to the server fails
              after the <code class="literal">UPDATE</code> to
              <code class="literal">checking_account</code>. If no exception is
              thrown, and the application never learns about the
              problem, it will continue executing. However, the server
              did not commit the first transaction in this case, so that
              will get rolled back. But execution continues with the
              next transaction, and increases the
              <code class="literal">savings_account</code> balance by 1000. The
              application did not receive an exception, so it continued
              regardless, eventually committing the second transaction,
              as the commit only applies to the changes made in the new
              connection. Rather than a transfer taking place, a deposit
              was made in this example.
            </p><p>
              Note that running with <code class="literal">auto-commit</code>
              enabled does not solve this problem. When Connector/J
              encounters a communication problem, there is no means to
              determine whether the server processed the currently
              executing statement or not. The following theoretical
              states are equally possible:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  The server never received the statement, and therefore
                  no related processing occurred on the server.
                </p></li><li><p>
                  The server received the statement, executed it in
                  full, but the response was not received by the client.
                </p></li></ul></div><p>
              If you are running with <code class="literal">auto-commit</code>
              enabled, it is not possible to guarantee the state of data
              on the server when a communication exception is
              encountered. The statement may have reached the server, or
              it may not. All you know is that communication failed at
              some point, before the client received confirmation (or
              data) from the server. This does not only affect
              <code class="literal">auto-commit</code> statements though. If the
              communication problem occurred during
              <code class="literal">Connection.commit()</code>, the question
              arises of whether the transaction was committed on the
              server before the communication failed, or whether the
              server received the commit request at all.
            </p><p>
              The second reason for the generation of exceptions is that
              transaction-scoped contextual data may be vulnerable, for
              example:
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                  Temporary tables
                </p></li><li><p>
                  User-defined variables
                </p></li><li><p>
                  Server-side prepared statements
                </p></li></ul></div><p>
              These items are lost when a connection fails, and if the
              connection silently reconnects without generating an
              exception, this could be detrimental to the correct
              execution of your application.
            </p><p>
              In summary, communication errors generate conditions that
              may well be unsafe for Connector/J to simply ignore by
              silently reconnecting. It is necessary for the application
              to be notified. It is then for the application developer
              to decide how to proceed in the event of connection errors
              and failures.
            </p><p><a name="qandaitem-5-3-1-14"></a><span class="bold"><strong>5.3.14: </strong></span><span class="bold"><strong>
              How can I use 3-byte UTF8 with Connector/J?
            </strong></span></p><p>
              To use 3-byte UTF8 with Connector/J set
              <code class="literal">characterEncoding=utf8</code> and set
              <code class="literal">useUnicode=true</code> in the connection
              string.
            </p><p><a name="qandaitem-5-3-1-15"></a><span class="bold"><strong>5.3.15: </strong></span><span class="bold"><strong>
              How can I use 4-byte UTF8, <code class="literal">utf8mb4</code> with
              Connector/J?
            </strong></span></p><p>
              To use 4-byte UTF8 with Connector/J configure the MySQL
              server with
              <code class="literal">character_set_server=utf8mb4</code>.
              Connector/J will then use that setting as long as
              <code class="literal">characterEncoding</code> has not been set in
              the connection string. This is equivalent to autodetection
              of the character set.
            </p><p><a name="qandaitem-5-3-1-16"></a><span class="bold"><strong>5.3.16: </strong></span><span class="bold"><strong>
              Using <code class="literal">useServerPrepStmts=false</code> and
              certain character encodings can lead to corruption when
              inserting BLOBs. How can this be avoided?
            </strong></span></p><p>
              When using certain character encodings, such as SJIS,
              CP932, and BIG5, it is possible that BLOB data contains
              characters that can be interpreted as control characters,
              for example, backslash, '\'. This can lead to corrupted
              data when inserting BLOBs into the database. There are two
              things that need to be done to avoid this:
            </p><div class="orderedlist"><ol type="1"><li><p>
                  Set the connection string option
                  <code class="literal">useServerPrepStmts</code> to
                  <code class="literal">true</code>.
                </p></li><li><p>
                  Set <code class="literal">SQL_MODE</code> to
                  <code class="literal">NO_BACKSLASH_ESCAPES</code>.
                </p></li></ol></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-support"></a>Chapter 6. Connector/J Support</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#connector-j-support-community">6.1. Connector/J Community Support</a></span></dt><dt><span class="section"><a href="#connector-j-support-bug-report">6.2. How to Report Connector/J Bugs or Problems</a></span></dt><dt><span class="section"><a href="#connector-j-support-changelog">6.3. Connector/J Change History</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-support-community"></a>6.1. Connector/J Community Support</h2></div></div></div><p>
        Oracle provides assistance to the user community by means of its
        mailing lists. For Connector/J related issues, you can get help
        from experienced users by using the MySQL and Java mailing list.
        Archives and subscription information is available online at
        <a href="http://lists.mysql.com/java" target="_top">http://lists.mysql.com/java</a>.
      </p><p>
        For information about subscribing to MySQL mailing lists or to
        browse list archives, visit
        <a href="http://lists.mysql.com/" target="_top">http://lists.mysql.com/</a>. See
        <a href="http://dev.mysql.com/doc/refman/5.1/en/mailing-lists.html" target="_top">MySQL Mailing Lists</a>.
      </p><p>
        Community support from experienced users is also available
        through the <a href="http://forums.mysql.com/list.php?39" target="_top">JDBC
        Forum</a>. You may also find help from other users in the
        other MySQL Forums, located at
        <a href="http://forums.mysql.com" target="_top">http://forums.mysql.com</a>. See
        <a href="http://dev.mysql.com/doc/refman/5.1/en/forums.html" target="_top">MySQL Community Support at the MySQL Forums</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-support-bug-report"></a>6.2. How to Report Connector/J Bugs or Problems</h2></div></div></div><p>
        The normal place to report bugs is
        <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a>, which is the address for
        our bugs database. This database is public, and can be browsed
        and searched by anyone. If you log in to the system, you will
        also be able to enter new reports.
      </p><p>
        If you have found a sensitive security bug in MySQL, you can
        send email to <code class="email">&lt;<a href="mailto:security@mysql.com">security@mysql.com</a>&gt;</code>.
      </p><p>
        Writing a good bug report takes patience, but doing it right the
        first time saves time both for us and for yourself. A good bug
        report, containing a full test case for the bug, makes it very
        likely that we will fix the bug in the next release.
      </p><p>
        This section will help you write your report correctly so that
        you do not waste your time doing things that may not help us
        much or at all.
      </p><p>
        If you have a repeatable bug report, please report it to the
        bugs database at <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a>. Any bug
        that we are able to repeat has a high chance of being fixed in
        the next MySQL release.
      </p><p>
        To report other problems, you can use one of the MySQL mailing
        lists.
      </p><p>
        Remember that it is possible for us to respond to a message
        containing too much information, but not to one containing too
        little. People often omit facts because they think they know the
        cause of a problem and assume that some details do not matter.
      </p><p>
        A good principle is this: If you are in doubt about stating
        something, state it. It is faster and less troublesome to write
        a couple more lines in your report than to wait longer for the
        answer if we must ask you to provide information that was
        missing from the initial report.
      </p><p>
        The most common errors made in bug reports are (a) not including
        the version number of Connector/J or MySQL used, and (b) not
        fully describing the platform on which Connector/J is installed
        (including the JVM version, and the platform type and version
        number that MySQL itself is installed on).
      </p><p>
        This is highly relevant information, and in 99 cases out of 100,
        the bug report is useless without it. Very often we get
        questions like, “<span class="quote">Why doesn't this work for me?</span>”
        Then we find that the feature requested wasn't implemented in
        that MySQL version, or that a bug described in a report has
        already been fixed in newer MySQL versions.
      </p><p>
        Sometimes the error is platform-dependent; in such cases, it is
        next to impossible for us to fix anything without knowing the
        operating system and the version number of the platform.
      </p><p>
        If at all possible, you should create a repeatable, standalone
        testcase that doesn't involve any third-party classes.
      </p><p>
        To streamline this process, we ship a base class for testcases
        with Connector/J, named
        '<code class="classname">com.mysql.jdbc.util.BaseBugReport</code>'. To
        create a testcase for Connector/J using this class, create your
        own class that inherits from
        <code class="classname">com.mysql.jdbc.util.BaseBugReport</code> and
        override the methods <code class="function">setUp()</code>,
        <code class="function">tearDown()</code> and
        <code class="function">runTest()</code>.
      </p><p>
        In the <code class="function">setUp()</code> method, create code that
        creates your tables, and populates them with any data needed to
        demonstrate the bug.
      </p><p>
        In the <code class="function">runTest()</code> method, create code that
        demonstrates the bug using the tables and data you created in
        the <code class="literal">setUp</code> method.
      </p><p>
        In the <code class="function">tearDown()</code> method, drop any tables
        you created in the <code class="function">setUp()</code> method.
      </p><p>
        In any of the above three methods, you should use one of the
        variants of the <code class="function">getConnection()</code> method to
        create a JDBC connection to MySQL:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="function">getConnection()</code> - Provides a connection
            to the JDBC URL specified in <code class="function">getUrl()</code>.
            If a connection already exists, that connection is returned,
            otherwise a new connection is created.
          </p></li><li><p>
            <code class="function">getNewConnection()</code> - Use this if you
            need to get a new connection for your bug report (that is,
            there is more than one connection involved).
          </p></li><li><p>
            <code class="function">getConnection(String url)</code> - Returns a
            connection using the given URL.
          </p></li><li><p>
            <code class="function">getConnection(String url, Properties
            props)</code> - Returns a connection using the given URL
            and properties.
          </p></li></ul></div><p>
        If you need to use a JDBC URL that is different from
        'jdbc:mysql:///test', override the method
        <code class="function">getUrl()</code> as well.
      </p><p>
        Use the <code class="function">assertTrue(boolean expression)</code> and
        <code class="function">assertTrue(String failureMessage, boolean
        expression)</code> methods to create conditions that must be
        met in your testcase demonstrating the behavior you are
        expecting (vs. the behavior you are observing, which is why you
        are most likely filing a bug report).
      </p><p>
        Finally, create a <code class="function">main()</code> method that
        creates a new instance of your testcase, and calls the
        <code class="literal">run</code> method:
      </p><pre class="programlisting">public static void main(String[] args) throws Exception {
      new MyBugReport().run();
 }</pre><p>
        Once you have finished your testcase, and have verified that it
        demonstrates the bug you are reporting, upload it with your bug
        report to <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="connector-j-support-changelog"></a>6.3. Connector/J Change History</h2></div></div></div><p>
        The Connector/J Change History (Changelog) is located with the
        main Changelog for MySQL. See <a href="#cj-news" title="Appendix A. MySQL Connector/J Change History">Appendix A, <i>MySQL Connector/J Change History</i></a>.
      </p></div></div><div class="appendix" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="cj-news"></a>Appendix A. MySQL Connector/J Change History</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#cj-news-5-1">A.1. Changes in MySQL Connector/J 5.1.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-5-1-15">A.1.1. Changes in MySQL Connector/J 5.1.15 (09 February 2011)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-14">A.1.2. Changes in MySQL Connector/J 5.1.14 (6th December 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-13">A.1.3. Changes in MySQL Connector/J 5.1.13 (24 June 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-12">A.1.4. Changes in MySQL Connector/J 5.1.12 (18 February 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-11">A.1.5. Changes in MySQL Connector/J 5.1.11 (21 January 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-10">A.1.6. Changes in MySQL Connector/J 5.1.10 (23 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-9">A.1.7. Changes in MySQL Connector/J 5.1.9 (21 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-8">A.1.8. Changes in MySQL Connector/J 5.1.8 (16 July 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-7">A.1.9. Changes in MySQL Connector/J 5.1.7 (21 October 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-6">A.1.10. Changes in MySQL Connector/J 5.1.6 (07 March 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-5">A.1.11. Changes in MySQL Connector/J 5.1.5 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-4">A.1.12. Changes in MySQL Connector/J 5.1.4 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-3">A.1.13. Changes in MySQL Connector/J 5.1.3 (10 September 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-2">A.1.14. Changes in MySQL Connector/J 5.1.2 (29 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-1">A.1.15. Changes in MySQL Connector/J 5.1.1 (22 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-0">A.1.16. Changes in MySQL Connector/J 5.1.0 (11 April 2007)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-5-0">A.2. Changes in MySQL Connector/J 5.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-5-0-8">A.2.1. Changes in MySQL Connector/J 5.0.8 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-7">A.2.2. Changes in MySQL Connector/J 5.0.7 (20 July 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-6">A.2.3. Changes in MySQL Connector/J 5.0.6 (15 May 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-5">A.2.4. Changes in MySQL Connector/J 5.0.5 (02 March 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-4">A.2.5. Changes in MySQL Connector/J 5.0.4 (20 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-3">A.2.6. Changes in MySQL Connector/J 5.0.3 (26 July 2006 beta)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-2">A.2.7. Changes in MySQL Connector/J 5.0.2 (11 July 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-1">A.2.8. Changes in MySQL Connector/J 5.0.1 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-0">A.2.9. Changes in MySQL Connector/J 5.0.0 (22 December 2005)</a></span></dt></dl></dd><dt><span class="section"><a href="#cg-news-3-1">A.3. Changes in MySQL Connector/J 3.1.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-3-1-15">A.3.1. Changes in MySQL Connector/J 3.1.15 (Not yet released)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-14">A.3.2. Changes in MySQL Connector/J 3.1.14 (19 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-13">A.3.3. Changes in MySQL Connector/J 3.1.13 (26 May 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-12">A.3.4. Changes in MySQL Connector/J 3.1.12 (30 November 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-11">A.3.5. Changes in MySQL Connector/J 3.1.11 (07 October 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-10">A.3.6. Changes in MySQL Connector/J 3.1.10 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-9">A.3.7. Changes in MySQL Connector/J 3.1.9 (22 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-8">A.3.8. Changes in MySQL Connector/J 3.1.8 (14 April 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-7">A.3.9. Changes in MySQL Connector/J 3.1.7 (18 February 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-6">A.3.10. Changes in MySQL Connector/J 3.1.6 (23 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-5">A.3.11. Changes in MySQL Connector/J 3.1.5 (02 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-4">A.3.12. Changes in MySQL Connector/J 3.1.4 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-3">A.3.13. Changes in MySQL Connector/J 3.1.3 (07 July 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-2">A.3.14. Changes in MySQL Connector/J 3.1.2 (09 June 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-1">A.3.15. Changes in MySQL Connector/J 3.1.1 (14 February 2004 alpha)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-0">A.3.16. Changes in MySQL Connector/J 3.1.0 (18 February 2003 alpha)</a></span></dt></dl></dd><dt><span class="section"><a href="#cg-news-3-0">A.4. Changes in MySQL Connector/J 3.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-3-0-17">A.4.1. Changes in MySQL Connector/J 3.0.17 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-16">A.4.2. Changes in MySQL Connector/J 3.0.16 (15 November 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-15">A.4.3. Changes in MySQL Connector/J 3.0.15 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-14">A.4.4. Changes in MySQL Connector/J 3.0.14 (28 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-13">A.4.5. Changes in MySQL Connector/J 3.0.13 (27 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-12">A.4.6. Changes in MySQL Connector/J 3.0.12 (18 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-11">A.4.7. Changes in MySQL Connector/J 3.0.11 (19 February 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-10">A.4.8. Changes in MySQL Connector/J 3.0.10 (13 January 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-9">A.4.9. Changes in MySQL Connector/J 3.0.9 (07 October 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-8">A.4.10. Changes in MySQL Connector/J 3.0.8 (23 May 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-7">A.4.11. Changes in MySQL Connector/J 3.0.7 (08 April 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-6">A.4.12. Changes in MySQL Connector/J 3.0.6 (18 February 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-5">A.4.13. Changes in MySQL Connector/J 3.0.5 (22 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-4">A.4.14. Changes in MySQL Connector/J 3.0.4 (06 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-3">A.4.15. Changes in MySQL Connector/J 3.0.3 (17 December 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-2">A.4.16. Changes in MySQL Connector/J 3.0.2 (08 November 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-1">A.4.17. Changes in MySQL Connector/J 3.0.1 (21 September 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-0">A.4.18. Changes in MySQL Connector/J 3.0.0 (31 July 2002)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-2-0">A.5. Changes in MySQL Connector/J 2.0.x</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-2-0-14">A.5.1. Changes in MySQL Connector/J 2.0.14 (16 May 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-13">A.5.2. Changes in MySQL Connector/J 2.0.13 (24 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-12">A.5.3. Changes in MySQL Connector/J 2.0.12 (07 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-11">A.5.4. Changes in MySQL Connector/J 2.0.11 (27 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-10">A.5.5. Changes in MySQL Connector/J 2.0.10 (24 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-9">A.5.6. Changes in MySQL Connector/J 2.0.9 (13 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-8">A.5.7. Changes in MySQL Connector/J 2.0.8 (25 November 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-7">A.5.8. Changes in MySQL Connector/J 2.0.7 (24 October 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-6">A.5.9. Changes in MySQL Connector/J 2.0.6 (16 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-5">A.5.10. Changes in MySQL Connector/J 2.0.5 (13 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-3">A.5.11. Changes in MySQL Connector/J 2.0.3 (03 December 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-1">A.5.12. Changes in MySQL Connector/J 2.0.1 (06 April 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre5">A.5.13. Changes in MySQL Connector/J 2.0.0pre5 (21 February 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre4">A.5.14. Changes in MySQL Connector/J 2.0.0pre4 (10 January 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre">A.5.15. Changes in MySQL Connector/J 2.0.0pre (17 August 1999)</a></span></dt></dl></dd><dt><span class="section"><a href="#cj-news-1-2b">A.6. Changes in MySQL Connector/J 1.2b (04 July 1999)</a></span></dt><dt><span class="section"><a href="#cg-news-1-0">A.7. Changes in MySQL Connector/J 1.2.x and lower</a></span></dt><dd><dl><dt><span class="section"><a href="#cj-news-1-2a">A.7.1. Changes in MySQL Connector/J 1.2a (14 April 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1i">A.7.2. Changes in MySQL Connector/J 1.1i (24 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1h">A.7.3. Changes in MySQL Connector/J 1.1h (08 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1g">A.7.4. Changes in MySQL Connector/J 1.1g (19 February 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1f">A.7.5. Changes in MySQL Connector/J 1.1f (31 December 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1b">A.7.6. Changes in MySQL Connector/J 1.1b (03 November 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1">A.7.7. Changes in MySQL Connector/J 1.1 (02 September 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-0">A.7.8. Changes in MySQL Connector/J 1.0 (24 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9d">A.7.9. Changes in MySQL Connector/J 0.9d (04 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9">A.7.10. Changes in MySQL Connector/J 0.9 (28 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-8">A.7.11. Changes in MySQL Connector/J 0.8 (06 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-7">A.7.12. Changes in MySQL Connector/J 0.7 (01 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-6">A.7.13. Changes in MySQL Connector/J 0.6 (21 May 1998)</a></span></dt></dl></dd></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cj-news-5-1"></a>A.1. Changes in MySQL Connector/J 5.1.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-5-1-15">A.1.1. Changes in MySQL Connector/J 5.1.15 (09 February 2011)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-14">A.1.2. Changes in MySQL Connector/J 5.1.14 (6th December 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-13">A.1.3. Changes in MySQL Connector/J 5.1.13 (24 June 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-12">A.1.4. Changes in MySQL Connector/J 5.1.12 (18 February 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-11">A.1.5. Changes in MySQL Connector/J 5.1.11 (21 January 2010)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-10">A.1.6. Changes in MySQL Connector/J 5.1.10 (23 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-9">A.1.7. Changes in MySQL Connector/J 5.1.9 (21 September 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-8">A.1.8. Changes in MySQL Connector/J 5.1.8 (16 July 2009)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-7">A.1.9. Changes in MySQL Connector/J 5.1.7 (21 October 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-6">A.1.10. Changes in MySQL Connector/J 5.1.6 (07 March 2008)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-5">A.1.11. Changes in MySQL Connector/J 5.1.5 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-4">A.1.12. Changes in MySQL Connector/J 5.1.4 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-3">A.1.13. Changes in MySQL Connector/J 5.1.3 (10 September 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-2">A.1.14. Changes in MySQL Connector/J 5.1.2 (29 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-1">A.1.15. Changes in MySQL Connector/J 5.1.1 (22 June 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-1-0">A.1.16. Changes in MySQL Connector/J 5.1.0 (11 April 2007)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-15"></a>A.1.1. Changes in MySQL Connector/J 5.1.15 (09 February 2011)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.14.
      </p><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Optional logging class
        <code class="literal">com.mysql.jdbc.log.Log4JLogger</code> was not
        included in the source/binary package for 5.1.14.
      </p><p>
        5.1.15 will ship with an SLF4J logger (which can then be plugged
        into Log4J). Unfortunately, it is not possible to ship a direct
        Log4J integration because the GPL is not compatible with Log4J's
        license.
       (Bug #59511, Bug #11766408)</p></li><li><p>
        The hard-coded list of reserved words in Connector/J was not
        updated to reflect the list of reserved words in MySQL Server
        5.5.
       (Bug #59224)</p></li><li><p>
        MySqlProcedure accepted null arguments as parameters, however
        the JDBC meta data did not indicate that.
       (Bug #38367, Bug #11749186)</p></li><li><p>
        Using Connector/J to connect from a z/OS machine to a MySQL
        Server failed when the database name to connect to was included
        in the connection URL. This was because the name was sent in
        z/OS default platform encoding, but the MySQL Server expected
        Latin1.
      </p><p>
        It should be noted that when connecting from systems that do not
        use Latin1 as the default platform encoding, the following
        connection string options can be useful:
        <code class="literal">passwordCharacterEncoding=ASCII</code> and
        <code class="literal">characterEncoding=ASCII</code>.
       (Bug #18086, Bug #11745647)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-14"></a>A.1.2. Changes in MySQL Connector/J 5.1.14 (6th December 2010)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.13.
      </p><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connector/J's load-balancing functionality only allowed the
        following events to trigger failover:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            Transaction commit/rollback
          </p></li><li><p>
            CommunicationExceptions
          </p></li><li><p>
            Matches to user-defined Exceptions using the
            loadBalanceSQLStateFailover,
            loadBalanceSQLExceptionSubclassFailover or
            loadBalanceExceptionChecker property.
          </p></li></ul></div><p>
        This meant that connections where auto-commit was enabled were
        not balanced, except for Exceptions, and this was problematic in
        the case of distribution of read-only work across slaves in a
        replication deployment.
      </p><p>
        The ability to load-balance while auto-commit is enabled has now
        been added to Connector/J. This introduces two new properties:
      </p><div class="orderedlist"><ol type="1"><li><p>
            loadBalanceAutoCommitStatementThreshold - defines the number
            of matching statements which will trigger the driver to
            (potentially) swap physical server connections. The default
            value (0) retains the previously-established behavior that
            connections with auto-commit enabled are never balanced.
          </p></li><li><p>
            loadBalanceAutoCommitStatementRegex - the regular expression
            against which statements must match. The default value
            (blank) matches all statements.
          </p></li></ol></div><p>
        Load-balancing will be done after the statement is executed,
        before control is returned to the application. If rebalancing
        fails, the driver will silently swallow the resulting Exception
        (as the statement itself completed successfully).
       (Bug #55723)</p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connection failover left slave/secondary in read-only mode.
        Failover attempts between two read-write masters did not
        properly set
        <code class="literal">this.currentConn.setReadOnly(false)</code>.
       (Bug #58706)</p></li><li><p>
        Connector/J mapped both 3-byte and 4-byte UTF8 encodings to the
        same Java UTF8 encoding.
      </p><p>
        To use 3-byte UTF8 with Connector/J set
        <code class="literal">characterEncoding=utf8</code> and set
        <code class="literal">useUnicode=true</code> in the connection string.
      </p><p>
        To use 4-byte UTF8 with Connector/J configure the MySQL server
        with <code class="literal">character_set_server=utf8mb4</code>.
        Connector/J will then use that setting as long as
        <code class="literal">characterEncoding</code> has not been set in the
        connection string. This is equivalent to autodetection of the
        character set.
       (Bug #58232)</p></li><li><p>
        The <code class="literal">CallableStatementRegression</code> test suite
        failed with a Null Pointer Exception because the
        <code class="literal">OUT</code> parameter in the
        <code class="literal">I__S.PARAMETERS</code> table had no name, that is
        <code class="literal">COLUMN_NAME</code> had the value
        <code class="literal">NULL</code>.
       (Bug #58232)</p></li><li><p>
        <code class="literal">DatabaseMetaData.supportsMultipleResultSets()</code>
        was hard-coded to return <code class="literal">false</code>, even though
        Connector/J supports multiple result sets.
       (Bug #57380)</p></li><li><p>
        Using the <code class="literal">useOldUTF8Behavior</code> parameter failed
        to set the connection character set to <code class="literal">latin1</code>
        as required.
      </p><p>
        In versions prior to 5.1.3, the handshake was done using
        <code class="literal">latin1</code>, and while there was logic in place to
        explicitly set the character set after the handshake was
        complete, this was bypassed when
        <code class="literal">useOldUTF8Behavior</code> was true. This was not a
        problem until 5.1.3, when the handshake was modified to use
        <code class="literal">utf8</code>, but the logic continued to allow the
        character set configured during that handshake process to be
        retained for later use. As a result,
        <code class="literal">useOldUTF8Behavior</code> effectively failed.
       (Bug #57262)</p></li><li><p>
        Invoking a stored procedure containing output parameters by its
        full name, where the procedure was located in another database,
        generated the following exception:
      </p><pre class="programlisting">Parameter index of 1 is out of range (1, 0)
</pre><p>(Bug #57022)</p></li><li><p>
        When a JDBC client disconnected from a remote server using
        <code class="literal">Connection.close()</code>, the TCP connection
        remained in the <code class="literal">TIME_WAIT</code> state on the server
        side, rather than on the client side.
       (Bug #56979)</p></li><li><p>
        Leaving Trust/ClientCertStoreType properties unset caused an
        exception to be thrown when connecting with
        <code class="literal">useSSL=true</code>, as no default was used.
       (Bug #56955)</p></li><li><p>
        When load-balanced connections swap servers, certain session
        state was copied from the previously active connection to the
        newly-selected connection. State synchronized included:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            Auto-commit state
          </p></li><li><p>
            Transaction isolation state
          </p></li><li><p>
            Current schema/catalog
          </p></li></ul></div><p>
        However, the read-only state was not synchronized, which caused
        problems if a write was attempted on a read-only connection.
       (Bug #56706)</p></li><li><p>
        When using Connector/J configured for failover
        (jdbc:mysql://host1,host2,... URLs), the non-primary servers
        re-balanced when the transactions on the master were committed
        or rolled-back.
       (Bug #56429)</p></li><li><p>
        An unhandled Null Pointer Exception (NPE) was generated in
        <code class="literal">DatabaseMetaData.java</code> when calling an
        incorrectly cased function name where no permission to access
        <code class="literal">mysql.proc</code> was available.
      </p><p>
        In addition to catching potential NPEs, a guard against calling
        JDBC functions with <code class="literal">db_name.proc_name</code>
        notation was also added.
       (Bug #56305)</p></li><li><p>
        Attempting to use JDBC4 functions on
        <code class="literal">Connection</code> objects resulted in errors being
        generated:
      </p><pre class="programlisting">Exception in thread "main" java.lang.AbstractMethodError:
com.mysql.jdbc.LoadBalancedMySQLConnection.createBlob()Ljava/sql/Blob;
   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
   at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
   at java.lang.reflect.Method.invoke(Method.java:597)
   at
com.mysql.jdbc.LoadBalancingConnectionProxy.invoke(LoadBalancingConnectionProxy.java:476)
   at $Proxy0.createBlob(Unknown Source)
</pre><p>(Bug #56099)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-13"></a>A.1.3. Changes in MySQL Connector/J 5.1.13 (24 June 2010)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.12.
      </p><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connector/J did not support <code class="literal">utf8mb4</code> for
        servers 5.5.2 and newer.
      </p><p>
        Connector/J now auto-detects servers configured with
        <code class="literal">character_set_server=utf8mb4</code> or treats the
        Java encoding <code class="literal">utf-8</code> passed using
        <code class="literal">characterEncoding=...</code> as
        <code class="literal">utf8mb4</code> in the <code class="literal">SET NAMES=</code>
        calls it makes when establishing the connection.
       (Bug #54175)</p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The method <code class="literal">unSafeStatementInterceptors()</code>
        contained an erroneous line of code, which resulted in the
        interceptor being called, but the result being thrown away.
       (Bug #53041)</p></li><li><p>
        There was a performance regression of roughly 25% between r906
        and r907, which appeared to be caused by pushing the Proxy down
        to the I/O layer.
       (Bug #52534)</p></li><li><p>
        Logic in implementations of
        <code class="literal">LoadBalancingConnectionProxy</code> and
        <code class="literal">LoadBalanceStrategy</code> behaved differently as to
        which <code class="literal">SQLException</code>s trigger failover to a new
        host. The former looked at the first two characters of the
        SQLState:
      </p><pre class="programlisting">if (sqlState.startsWith("08"))
...
</pre><p>
        The latter used a different test:
      </p><pre class="programlisting">if (sqlEx instanceof CommunicationsException
  || "08S01".equals(sqlEx.getSQLState())) {
...
</pre><p>
        This meant it was possible for a new
        <code class="literal">Connection</code> object to throw an
        <code class="literal">Exception</code> when the first selected host was
        unavailable. This happened because
        <code class="literal">MySqlIO.createNewIO()</code> could throw an
        <code class="literal">SQLException</code> with a
        <code class="literal">SQLState</code> of “<span class="quote">08001</span>”, which did
        not trigger the “<span class="quote">try another host</span>” logic in the
        <code class="literal">LoadBalanceStrategy</code> implementations, so an
        <code class="literal">Exception</code> was thrown after having only
        attempted connecting to a single host.
       (Bug #52231)</p></li><li><p>
        In the file <code class="filename">DatabaseMetadata.java</code>, the
        function <code class="literal">private void
        getCallStmtParameterTypes</code> failed if the parameter was
        defined over more than one line by using the '\n' character.
       (Bug #52167)</p></li><li><p>
        The catalog parameter, <code class="literal">PARAM_CAT</code>, was not
        correctly processed when calling for metadata with
        <code class="literal">getMetaData()</code> on stored procedures. This was
        because <code class="literal">PARAM_CAT</code> was hardcoded in the code
        to <code class="literal">NULL</code>. In the case where
        <code class="literal">nullcatalogmeanscurrent</code> was
        <code class="literal">true</code>, which is its default value, a crash did
        not occur, but the metadata returned was for the stored
        procedures from the catalog currently attached to. If, however,
        <code class="literal">nullcatalogmeanscurrent</code> was set to
        <code class="literal">false</code> then a crash resulted.
      </p><p>
        Connector/J has been changed so that when
        <code class="literal">NULL</code> is passed as
        <code class="literal">PARAM_CAT</code> it will not crash when
        <code class="literal">nullcatalogmeanscurrent</code> is
        <code class="literal">false</code>, but rather iterate all catalogs in
        search of stored procedures. This means that
        <code class="literal">PARAM_CAT</code> is no longer hardcoded to
        <code class="literal">NULL</code> (see Bug #51904).
       (Bug #51912)</p></li><li><p>
        A load balanced <code class="literal">Connection</code> object with
        multiple open underlying physical connections rebalanced on
        <code class="literal">commit()</code>, <code class="literal">rollback()</code>, or
        on a communication exception, without validating the existing
        connection. This caused a problem when there was no pinging of
        the physical connections, using queries starting with “<span class="quote">/*
        ping */</span>”, to ensure they remained active. This meant that
        calls to <code class="literal">Connection.commit()</code> could throw a
        <code class="literal">SQLException</code>. This did not occur when the
        transaction was actually committed; it occurred when the new
        connection was chosen and the driver attempted to set the
        auto-commit or transaction isolation state on the newly chosen
        physical connection.
       (Bug #51783)</p></li><li><p>
        The <code class="literal">rollback()</code> method could fail to rethrow a
        <code class="literal">SQLException</code> if the server became unavailable
        during a rollback. The errant code only rethrew when
        <code class="literal">ignoreNonTxTables</code> was true and the exception
        did not have the error code 1196,
        <code class="literal">SQLError.ER_WARNING_NOT_COMPLETE_ROLLBACK</code>.
       (Bug #51776)</p></li><li><p>
        When the <code class="literal">allowMultiQueries</code> connection string
        option was set to <code class="literal">true</code>, a call to
        <code class="literal">Statement.executeBatch()</code> scanned the query
        for escape codes, even though
        <code class="literal">setEscapeProcessing(false)</code> had been called
        previously.
       (Bug #51704)</p></li><li><p>
        When a <code class="literal">StatementInterceptor</code> was used and an
        alternate <code class="literal">ResultSet</code> was returned from
        <code class="literal">preProcess()</code>, the original statement was
        still executed.
       (Bug #51666)</p></li><li><p>
        Objects created by <code class="literal">ConnectionImpl</code>, such as
        prepared statements, hold a reference to the
        <code class="literal">ConnectionImpl</code> that created them. However,
        when the load balancer picked a new connection, it did not
        update the reference contained in, for example, the
        <code class="literal">PreparedStatement</code>. This resulted in inserts
        and updates being directed to invalid connections, while commits
        were directed to the new connection. This resulted in silent
        data loss.
       (Bug #51643)</p></li><li><p>
        <code class="literal">jdbc:mysql:loadbalance://</code> would connect to
        the same host, even though
        <code class="literal">loadBalanceStrategy</code> was set to a value of
        <code class="literal">random</code>, and multiple hosts were specified.
       (Bug #51266)</p></li><li><p>
        An unexpected exception when trying to register
        <code class="literal">OUT</code> parameters in
        <code class="literal">CallableStatement</code>.
      </p><p>
        Sometimes Connector/J was not able to register
        <code class="literal">OUT</code> parameters for
        <code class="literal">CallableStatements</code>.
       (Bug #43576)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-12"></a>A.1.4. Changes in MySQL Connector/J 5.1.12 (18 February 2010)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.11.
      </p><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The catalog parameter was ignored in the
        <code class="literal">DatabaseMetaData.getProcedure()</code> method. It
        returned all procedures in all databases.
       (Bug #51022)</p></li><li><p>
        A call to <code class="literal">DatabaseMetaData.getDriverVersion()</code>
        returned the revision as <code class="literal">mysql-connector-java-5.1.11 (
        Revision: ${svn.Revision} )</code>. The variable
        <code class="literal">${svn.Revision}</code> was not replaced by the SVN
        revision number.
       (Bug #50288)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-11"></a>A.1.5. Changes in MySQL Connector/J 5.1.11 (21 January 2010)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.10.
      </p><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Replication connections, those with URLs that start with
        jdbc:mysql:replication, now use a jdbc:mysql:loadbalance
        connection for the slave pool. This means that it is possible to
        set load balancing properties such as
        <code class="literal">loadBalanceBlacklistTimeout</code> and
        <code class="literal">loadBalanceStrategy</code> to choose a mechanism for
        balancing the load, and failover or fault tolerance strategy for
        the slave pool.
       (Bug #49537)</p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">NullPointerException</code> sometimes occurred in
        <code class="literal">invalidateCurrentConnection()</code> for
        load-balanced connections.
       (Bug #50288)</p></li><li><p>
        The <code class="literal">deleteRow</code> method caused a full table
        scan, when using an updatable cursor and a multibyte character
        set.
       (Bug #49745)</p></li><li><p>
        For pooled connections, Connector/J did not process the session
        variable <code class="literal">time_zone</code> when set using the URL,
        resulting in incorrect timestamp values being stored.
       (Bug #49700)</p></li><li><p>
        The <code class="literal">ExceptionInterceptor</code> class did not
        provide a <code class="literal">Connection</code> context.
       (Bug #49607)</p></li><li><p>
        Ping left closed connections in the liveConnections map, causing
        subsequent Exceptions when that connection was used.
       (Bug #48605)</p></li><li><p>
        Using <code class="literal">MysqlConnectionPoolDataSource</code> with a
        load-balanced URL generated exceptions of type
        <code class="literal">ClassCastException</code>:
      </p><pre class="programlisting">ClassCastException in MysqlConnectionPoolDataSource
Caused by: java.lang.ClassCastException: $Proxy0
   at
com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource.getPooledConnection(MysqlConne
ctionPoolDataSource.java:80)
</pre><pre class="programlisting">java.lang.ClassCastException: $Proxy2
 at com.mysql.jdbc.jdbc2.optional.StatementWrapper.executeQuery(StatementWrapper.java:744)
</pre><p>(Bug #48486)</p></li><li><p>
        The implementation for load-balanced
        <code class="literal">Connection</code> used a proxy, which delegated
        method calls, including <code class="literal">equals()</code> and
        <code class="literal">hashCode()</code>, to underlying
        <code class="literal">Connection</code> objects. This meant that
        successive calls to <code class="literal">hashCode()</code> on the same
        object potentially returned different values, if the proxy state
        had changed such that it was utilizing a different underlying
        connection.
       (Bug #48442)</p></li><li><p>
        The batch rewrite functionality attempted to identify the start
        of the <code class="literal">VALUES</code> list by looking for
        “<span class="quote">VALUES </span>” (with trailing space). However, valid
        MySQL syntax permits <code class="literal">VALUES</code> to be followed by
        whitespace or an opening parenthesis:
      </p><pre class="programlisting">INSERT INTO tbl VALUES
(1);

INSERT INTO tbl VALUES(1);
</pre><p>
        Queries written with the above formats did not therefore gain
        the performance benefits of the batch rewrite.
       (Bug #48172)</p></li><li><p>
        A PermGen memory leaked was caused by the Connector/J statement
        cancellation timer (<code class="literal">java.util.Timer</code>). When
        the application was unloaded the cancellation timer did not
        terminate, preventing the ClassLoader from being garbage
        collected.
       (Bug #36565)</p></li><li><p>
        With the connection string option
        <code class="literal">noDatetimeStringSync</code> set to
        <code class="literal">true</code>, and server-side prepared statements
        enabled, the following exception was generated if an attempt was
        made to obtain, using <code class="literal">ResultSet.getString()</code>,
        a datetime value containing all zero components:
      </p><pre class="programlisting">java.sql.SQLException: Value '0000-00-00' can not be represented as java.sql.Date
</pre><p>(Bug #32525)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-10"></a>A.1.6. Changes in MySQL Connector/J 5.1.10 (23 September 2009)</h3></div></div></div><p>
        Fixes bugs found since release 5.1.9.
      </p><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The <code class="literal">DriverManager.getConnection()</code> method
        ignored a non-standard port if it was specified in the JDBC
        connection string. Connector/J always used the standard port
        3306 for connection creation. For example, if the string was
        <code class="literal">jdbc:mysql://localhost:6777</code>, Connector/J
        would attempt to connect to port 3306, rather than 6777.
       (Bug #47494)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-9"></a>A.1.7. Changes in MySQL Connector/J 5.1.9 (21 September 2009)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        In the class
        <code class="literal">com.mysql.jdbc.jdbc2.optional.SuspendableXAConnection</code>,
        which is used when
        <code class="literal">pinGlobalTxToPhysicalConnection=true</code>, there
        is a static map (XIDS_TO_PHYSICAL_CONNECTIONS) that tracks the
        Xid with the XAConnection, however this map was not populated.
        The effect was that the
        <code class="literal">SuspendableXAConnection</code> was never pinned to
        the real XA connection. Instead it created new connections on
        calls to <code class="literal">start</code>, <code class="literal">end</code>,
        <code class="literal">resume</code>, and <code class="literal">prepare</code>.
       (Bug #46925)</p></li><li><p>
        When using the ON DUPLICATE KEY UPDATE functionality together
        with the rewriteBatchedStatements option set to true, an
        exception was generated when trying to execute the prepared
        statement:
      </p><pre class="programlisting">INSERT INTO config_table (modified,id_) VALUES (?,?) ON DUPLICATE KEY UPDATE modified=?
</pre><p>
        The exception generated was:
      </p><pre class="programlisting">java.sql.SQLException: Parameter index out of range (3 &gt; number of parameters, which is
2).
	at com.sag.etl.job.processors.JdbcInsertProcessor.flush(JdbcInsertProcessor.java:135)
......
Caused by: java.sql.SQLException: Parameter index out of range (3 &gt; number of parameters,
which is 2).
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926)
	at com.mysql.jdbc.PreparedStatement.checkBounds(PreparedStatement.java:3657)
	at com.mysql.jdbc.PreparedStatement.setInternal(PreparedStatement.java:3641)
	at
com.mysql.jdbc.PreparedStatement.setBytesNoEscapeNoQuotes(PreparedStatement.java:3391)
	at
com.mysql.jdbc.PreparedStatement.setOneBatchedParameterSet(PreparedStatement.java:4203)
	at com.mysql.jdbc.PreparedStatement.executeBatchedInserts(PreparedStatement.java:1759)
	at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1441)
	at com.sag.etl.job.processors.JdbcInsertProcessor.flush(JdbcInsertProcessor.java:131)
	... 16 more
</pre><p>(Bug #46788)</p></li><li><p>
        When Connector/J encountered an error condition that caused it
        to create a <code class="literal">CommunicationsException</code>, it tried
        to build a friendly error message that helped diagnose what was
        wrong. However, if there had been no network packets received
        from the server, the error message contained the following
        incorrect text:
      </p><pre class="programlisting">The last packet successfully received from the server was 1,249,932,468,916 milliseconds
ago.  The last packet sent successfully to the server was 0 milliseconds ago.
</pre><p>(Bug #46637)</p></li><li><p>
        The <code class="literal">getSuperTypes</code> method returned a result
        set with incorrect names for the first two columns. The name of
        the first column in the result set was expected to be
        <code class="literal">TYPE_CAT</code> and that of the second column
        <code class="literal">TYPE_SCHEM</code>. The method however returned the
        names as <code class="literal">TABLE_CAT</code> and
        <code class="literal">TABLE_SCHEM</code> for first and second column
        respectively.
       (Bug #44508)</p></li><li><p>
        SQLException for data truncation error gave the error code as 0
        instead of 1265.
       (Bug #44324)</p></li><li><p>
        Calling <code class="literal">ResultSet.deleteRow()</code> on a table with
        a primary key of type <code class="literal">BINARY(8)</code> silently
        failed to delete the row, but only in some repeatable cases. The
        generated <code class="literal">DELETE</code> statement generated
        corrupted part of the primary key data. Specifically, one of the
        bytes was changed from 0x90 to 0x9D, although the corruption
        appeared to be different depending on whether the application
        was run on Windows or Linux.
       (Bug #43759)</p></li><li><p>
        Accessing result set columns by name after the result set had
        been closed resulted in a NullPointerException instead of a
        SQLException.
       (Bug #41484)</p></li><li><p>
        <code class="literal">QueryTimeout</code> did not work for batch
        statements waiting on a locked table.
      </p><p>
        When a batch statement was issued to the server and was forced
        to wait because of a locked table, Connector/J only terminated
        the first statement in the batch when the timeout was exceeded,
        leaving the rest hanging.
       (Bug #34555)</p></li><li><p>
        The <code class="literal">parseURL</code> method in class
        <code class="literal">com.mysql.jdbc.Driver</code> did not work as
        expected. When given a URL such as
        “<span class="quote">jdbc:mysql://www.mysql.com:12345/my_database</span>” to
        parse, the property <code class="literal">PORT_PROPERTY_KEY</code> was
        found to be <code class="literal">null</code> and the
        <code class="literal">HOST_PROPERTY_KEY</code> property was found to be
        “<span class="quote">www.mysql.com:12345</span>”.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          Connector/J has been fixed so that it will now always fill in
          the <code class="literal">PORT</code> property (using 3306 if not
          specified), and the <code class="literal">HOST</code> property (using
          <code class="literal">localhost</code> if not specified) when
          <code class="literal">parseURL()</code> is called. The driver also
          parses a list of hosts into <code class="literal">HOST.n</code> and
          <code class="literal">PORT.n</code> properties as well as adding a
          property <code class="literal">NUM_HOSTS</code> for the number of hosts
          it has found. If a list of hosts is passed to the driver,
          <code class="literal">HOST</code> and <code class="literal">PORT</code> will be
          set to the values given by <code class="literal">HOST.1</code> and
          <code class="literal">PORT.1</code> respectively. This change has
          centralized and cleaned up a large section of code used to
          generate lists of hosts, both for load-balanced and fault
          tolerant connections and their tests.
        </p></div><p>(Bug #32216)</p></li><li><p>
        Attempting to delete rows using
        <code class="literal">ResultSet.deleteRow()</code> did not delete rows
        correctly.
       (Bug #27431)</p></li><li><p>
        The <code class="literal">setDate</code> method silently ignored the
        Calendar parameter. The code was implemented as follows:
      </p><pre class="programlisting">public void setDate(int parameterIndex, java.sql.Date x, Calendar cal) throws SQLException {
   setDate(parameterIndex, x);
}        
      </pre><p>
        From reviewing the code it was apparent that the Calendar
        parameter <code class="literal">cal</code> was ignored.
       (Bug #23584)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-8"></a>A.1.8. Changes in MySQL Connector/J 5.1.8 (16 July 2009)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The reported milliseconds since the last server packets were
        received/sent was incorrect by a factor of 1000. For example,
        the following method call:
      </p><pre class="programlisting">SQLError.createLinkFailureMessageBasedOnHeuristics(
(ConnectionImpl) this.conn, 
System.currentTimeMillis() - 1000,
System.currentTimeMillis() - 2000,
e, 
false);</pre><p>
        returned the following string:
      </p><pre class="programlisting">The last packet successfully received from the server 
was 2 milliseconds ago. The last packet sent successfully to the 
server was 1 milliseconds ago.</pre><p>(Bug #45419)</p></li><li><p>
        Calling <code class="literal">Connection.serverPrepareStatement()</code>
        variants that do not take result set type or concurrency
        arguments returned statements that produced result sets with
        incorrect defaults, namely
        <code class="literal">TYPE_SCROLL_SENSITIVE</code>.
       (Bug #45171)</p></li><li><p>
        The result set returned by <code class="literal">getIndexInfo()</code> did
        not have the format defined in the JDBC API specifications. The
        fourth column, <code class="literal">DATA_TYPE</code>, of the result set
        should be of type <code class="literal">BOOLEAN</code>. Connector/J
        however returns <code class="literal">CHAR</code>.
       (Bug #44869)</p></li><li><p>
        The result set returned by <code class="literal">getTypeInfo()</code> did
        not have the format defined in the JDBC API specifications. The
        second column, <code class="literal">DATA_TYPE</code>, of the result set
        should be of type <code class="literal">INTEGER</code>. Connector/J
        however returns <code class="literal">SMALLINT</code>.
       (Bug #44868)</p></li><li><p>
        The <code class="literal">DEFERRABILITY</code> column in database metadata
        result sets was expected to be of type <code class="literal">SHORT</code>.
        However, Connector/J returned it as <code class="literal">INTEGER</code>.
      </p><p>
        This affected the following methods:
        <code class="literal">getImportedKeys()</code>,
        <code class="literal">getExportedKeys()</code>,
        <code class="literal">getCrossReference()</code>.
       (Bug #44867)</p></li><li><p>
        The result set returned by <code class="literal">getColumns()</code> did
        not have the format defined in the JDBC API specifications. The
        fifth column, <code class="literal">DATA_TYPE</code>, of the result set
        should be of type <code class="literal">INTEGER</code>. Connector/J
        however returns <code class="literal">SMALLINT</code>.
       (Bug #44865)</p></li><li><p>
        The result set returned by
        <code class="literal">getVersionColumns()</code> did not have the format
        defined in the JDBC API specifications. The third column,
        <code class="literal">DATA_TYPE</code>, of the result set should be of
        type <code class="literal">INTEGER</code>. Connector/J however returns
        <code class="literal">SMALLINT</code>.
       (Bug #44863)</p></li><li><p>
        The result set returned by
        <code class="literal">getBestRowIdentifier()</code> did not have the
        format defined in the JDBC API specifications. The third column,
        <code class="literal">DATA_TYPE</code>, of the result set should be of
        type <code class="literal">INTEGER</code>. Connector/J however returns
        <code class="literal">SMALLINT</code>.
       (Bug #44862)</p></li><li><p>
        Connector/J contains logic to generate a message text
        specifically for streaming result sets when there are
        <code class="literal">CommunicationsException</code> exceptions generated.
        However, this code was never reached.
      </p><p>
        In the <code class="literal">CommunicationsException</code> code:
      </p><pre class="programlisting">private boolean streamingResultSetInPlay = false;

public CommunicationsException(ConnectionImpl conn, long lastPacketSentTimeMs,
long lastPacketReceivedTimeMs, Exception underlyingException) {

this.exceptionMessage = SQLError.createLinkFailureMessageBasedOnHeuristics(conn,
      lastPacketSentTimeMs, lastPacketReceivedTimeMs, underlyingException,
      this.streamingResultSetInPlay);</pre><p>
        <code class="literal">streamingResultSetInPlay</code> was always false,
        which in the following code in
        <code class="literal">SQLError.createLinkFailureMessageBasedOnHeuristics()</code>
        never being executed:
      </p><pre class="programlisting">if (streamingResultSetInPlay) {
    exceptionMessageBuf.append(
    Messages.getString("CommunicationsException.ClientWasStreaming")); //$NON-NLS-1$
} else {
...</pre><p>(Bug #44588)</p></li><li><p>
        The
        <code class="literal">SQLError.createLinkFailureMessageBasedOnHeuristics()</code>
        method created a message text for communication link failures.
        When certain conditions were met, this message included both
        “<span class="quote">last packet sent</span>” and “<span class="quote">last packet
        received</span>” information, but when those conditions were not
        met, only “<span class="quote">last packet sent</span>” information was
        provided.
      </p><p>
        Information about when the last packet was successfully received
        should be provided in all cases.
       (Bug #44587)</p></li><li><p>
        <code class="literal">Statement.getGeneratedKeys()</code> retained result
        set instances until the statement was closed. This caused memory
        leaks for long-lived statements, or statements used in tight
        loops.
       (Bug #44056)</p></li><li><p>
        Using <code class="literal">useInformationSchema</code> with
        <code class="literal">DatabaseMetaData.getExportedKeys()</code> generated
        the following exception:
      </p><pre class="programlisting">com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException: Column
'REFERENCED_TABLE_NAME' in where clause is ambiguous
...
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1772)
at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1923)
at
com.mysql.jdbc.DatabaseMetaDataUsingInfoSchema.executeMetadataQuery(
DatabaseMetaDataUsingInfoSchema.java:50)
at
com.mysql.jdbc.DatabaseMetaDataUsingInfoSchema.getExportedKeys(
DatabaseMetaDataUsingInfoSchema.java:603)</pre><p>(Bug #43714)</p></li><li><p>
        <code class="literal">LoadBalancingConnectionProxy.doPing()</code> did not
        have blacklist awareness.
      </p><p>
        <code class="literal">LoadBalancingConnectionProxy</code> implemented
        <code class="literal">doPing()</code> to ping all underlying connections,
        but it threw any exceptions it encountered during this process.
      </p><p>
        With the global blacklist enabled, it catches these exceptions,
        adds the host to the global blacklist, and only throws an
        exception if all hosts are down.
       (Bug #43421)</p></li><li><p>
        The method <code class="literal">Statement.getGeneratedKeys()</code> did
        not return values for <code class="literal">UNSIGNED BIGINTS</code> with
        values greater than <code class="literal">Long.MAX_VALUE</code>.
      </p><p>
        Unfortunately, because the server does not tell clients what
        TYPE the auto increment value is, the driver cannot consistently
        return BigIntegers for the result set returned from
        <code class="literal">getGeneratedKeys()</code>, it will only return them
        if the value is greater than <code class="literal">Long.MAX_VALUE</code>.
        If your application needs this consistency, it will need to
        check the class of the return value from
        <code class="literal">.getObject()</code> on the ResultSet returned by
        <code class="literal">Statement.getGeneratedKeys()</code> and if it is not
        a BigInteger, create one based on the
        <code class="literal">java.lang.Long</code> that is returned.
       (Bug #43196)</p></li><li><p>
        When the MySQL Server was upgraded from 4.0 to 5.0, the
        Connector/J application then failed to connect to the server.
        This was because authentication failed when the application ran
        from EBCDIC platforms such as z/OS.
       (Bug #43071)</p></li><li><p>
        When connecting with <code class="literal">traceProtocol=true</code>, no
        trace data was generated for the server greeting or login
        request.
       (Bug #43070)</p></li><li><p>
        Connector/J generated an unhandled
        <code class="literal">StringIndexOutOfBoundsException</code>:
      </p><pre class="programlisting">java.lang.StringIndexOutOfBoundsException: String index out of range: -1
at java.lang.String.substring(String.java:1938)
at com.mysql.jdbc.EscapeProcessor.processTimeToken(EscapeProcessor.java:353)
at com.mysql.jdbc.EscapeProcessor.escapeSQL(EscapeProcessor.java:257)
at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1546)
at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1524)</pre><p>(Bug #42253)</p></li><li><p>
        A <code class="literal">ConcurrentModificationException</code> was
        generated in <code class="literal">LoadBalancingConnectionProxy</code>:
      </p><pre class="programlisting">java.util.ConcurrentModificationException
 at java.util.HashMap$HashIterator.nextEntry(Unknown Source)
 at java.util.HashMap$KeyIterator.next(Unknown Source)
 at
com.mysql.jdbc.LoadBalancingConnectionProxy.getGlobalBlacklist(LoadBalancingConnectionProxy.java:520)
 at com.mysql.jdbc.RandomBalanceStrategy.pickConnection(RandomBalanceStrategy.java:55)
 at
com.mysql.jdbc.LoadBalancingConnectionProxy.pickNewConnection(LoadBalancingConnectionProxy.java:414)
 at
com.mysql.jdbc.LoadBalancingConnectionProxy.invoke(LoadBalancingConnectionProxy.java:390)</pre><p>(Bug #42055)</p></li><li><p>
        SQL injection was possible when using a string containing U+00A5
        in a client-side prepared statement, and the character set being
        used was SJIS/Windows-31J.
       (Bug #41730)</p></li><li><p>
        If there was an apostrophe in a comment in a statement that was
        being sent through Connector/J, the apostrophe was still
        recognized as a quote and put the state machine in
        <code class="literal">EscapeTokenizer</code> into the
        <code class="literal">inQuotes</code> state. This led to further parse
        errors.
      </p><p>
        For example, consider the following statement:
      </p><pre class="programlisting">String sql = "-- Customer's zip code will be fixed\n" +
  "update address set zip_code = 99999\n" +
  "where not regexp '^[0-9]{5}([[.-.]])?([0-9]{4})?$'";</pre><p>
        When passed through Connector/J, the
        <code class="literal">EscapeTokenizer</code> did not recognize that the
        first apostrophe was in a comment and thus set
        <code class="literal">inQuotes</code> to true. When that happened, the
        quote count was incorrect and thus the regular expression did
        not appear to be in quotation marks. With the parser not
        detecting that the regular expression was in quotation marks,
        the curly braces were recognized as escape sequences and were
        removed from the regular expression, breaking it. The server
        thus received SQL such as:
      </p><pre class="programlisting">-- Customer's zip code will be fixed
update address set zip_code = '99999'
where not regexp '^[0-9]([[.-.]])?([0-9])?$'</pre><p>(Bug #41566)</p></li><li><p>
        MySQL Connector/J 5.1.7 was slower than previous versions when
        the <code class="literal">rewriteBatchedStatements</code> option was set
        to <code class="literal">true</code>.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          The performance regression in
          <code class="literal">indexOfIgnoreCaseRespectMarker()</code>has been
          fixed. It has also been made possible for the driver to
          rewrite <code class="literal">INSERT</code> statements with <code class="literal">ON
          DUPLICATE KEY UPDATE</code> clauses in them, as long as the
          <code class="literal">UPDATE</code> clause contains no reference to
          <code class="literal">LAST_INSERT_ID()</code>, as that would cause the
          driver to return bogus values for
          <code class="literal">getGeneratedKeys()</code> invocations. This has
          resulted in improved performance over version 5.1.7.
        </p></div><p>(Bug #41532)</p></li><li><p>
        When accessing a result set column by name using
        <code class="literal">ResultSetImpl.findColumn()</code> an exception was
        generated:
      </p><pre class="programlisting">java.lang.NullPointerException
at com.mysql.jdbc.ResultSetImpl.findColumn(ResultSetImpl.java:1103)
at com.mysql.jdbc.ResultSetImpl.getShort(ResultSetImpl.java:5415)
at org.apache.commons.dbcp.DelegatingResultSet.getShort(DelegatingResultSet.java:219)
at com.zimbra.cs.db.DbVolume.constructVolume(DbVolume.java:297)
at com.zimbra.cs.db.DbVolume.get(DbVolume.java:197)
at com.zimbra.cs.db.DbVolume.create(DbVolume.java:95)
at com.zimbra.cs.store.Volume.create(Volume.java:227)
at com.zimbra.cs.store.Volume.create(Volume.java:189)
at com.zimbra.cs.service.admin.CreateVolume.handle(CreateVolume.java:48)
at com.zimbra.soap.SoapEngine.dispatchRequest(SoapEngine.java:428)
at com.zimbra.soap.SoapEngine.dispatch(SoapEngine.java:285)</pre><p>(Bug #41484)</p></li><li><p>
        The <code class="literal">RETURN_GENERATED_KEYS</code> flag was being
        ignored. For example, in the following code the
        <code class="literal">RETURN_GENERATED_KEYS</code> flag was ignored:
      </p><pre class="programlisting">PreparedStatement ps = connection.prepareStatement("INSERT INTO table
  values(?,?)",PreparedStatement.RETURN_GENERATED_KEYS);</pre><p>(Bug #41448)</p></li><li><p>
        When using Connector/J 5.1.7 to connect to MySQL Server 4.1.18
        the following error message was generated:
      </p><pre class="programlisting">Thu Dec 11 17:38:21 PST 2008 WARN: Invalid value {1} for server variable named {0},
falling back to sane default of {2}</pre><p>
        This occurred with MySQL Server version that did not support
        <code class="literal">auto_increment_increment</code>. The error message
        should not have been generated.
       (Bug #41416)</p></li><li><p>
        When <code class="literal">DatabaseMetaData.getProcedureColumns()</code>
        was called, the value for <code class="literal">LENGTH</code> was always
        returned as 65535, regardless of the column type (fixed or
        variable) or the actual length of the column.
      </p><p>
        However, if you obtained the <code class="literal">PRECISION</code> value,
        this was correct for both fixed and variable length columns.
       (Bug #41269)</p></li><li><p>
        <code class="literal">PreparedStatement.addBatch()</code> did not check
        for all parameters being set, which led to inconsistent behavior
        in <code class="literal">executeBatch()</code>, especially when rewriting
        batched statements into multi-value <code class="literal">INSERT</code>s.
       (Bug #41161)</p></li><li><p>
        Error message strings contained variable values that were not
        expanded. For example:
      </p><pre class="programlisting">Mon Nov 17 11:43:18 JST 2008 WARN: Invalid value {1} for server variable named {0},
falling back to sane default of {2}</pre><p>(Bug #40772)</p></li><li><p>
        When using <code class="literal">rewriteBatchedStatements=true</code>
        with:
      </p><pre class="programlisting">INSERT INTO table_name_values (...) VALUES (...)</pre><p>
        Query rewriting failed because “<span class="quote">values</span>” at the end
        of the table name was mistaken for the reserved keyword. The
        error generated was as follows:
      </p><pre class="programlisting">testBug40439(testsuite.simple.TestBug40439)java.sql.BatchUpdateException: You have an
error in your SQL syntax; check the manual that corresponds to your MySQL server version
for the right syntax to use near 'values (2,'toto',2),(id,data, ordr) values
(3,'toto',3),(id,data, ordr) values (' at line 1
at com.mysql.jdbc.PreparedStatement.executeBatchedInserts(PreparedStatement.java:1495)
at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1097)
at testsuite.simple.TestBug40439.testBug40439(TestBug40439.java:42)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at testsuite.simple.TestBug40439.main(TestBug40439.java:57)</pre><p>(Bug #40439)</p></li><li><p>
        A statement interceptor received the incorrect parameters when
        used with a batched statement.
       (Bug #39426)</p></li><li><p>
        Using Connector/J 5.1.6 the method
        <code class="literal">ResultSet.getObject</code> returned a
        <code class="literal">BYTE[]</code> for following:
      </p><pre class="programlisting">SELECT TRIM(rowid) FROM tbl</pre><p>
        Where <code class="literal">rowid</code> had a type of <code class="literal">INT(11)
        PRIMARY KEY AUTO_INCREMENT</code>.
      </p><p>
        The expected return type was one of <code class="literal">CHAR</code>,
        <code class="literal">VARCHAR</code>, <code class="literal">CLOB</code>, however, a
        <code class="literal">BYTE[]</code> was returned.
      </p><p>
        Further, adding
        <code class="literal">functionsNeverReturnBlobs=true</code> to the
        connection string did not have any effect on the return type.
       (Bug #38387)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-7"></a>A.1.9. Changes in MySQL Connector/J 5.1.7 (21 October 2008)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        When statements include <code class="literal">ON DUPLICATE UPDATE</code>,
        and <code class="literal">rewriteBatchedStatements</code> is set to true,
        batched statements are not rewritten into the form
        <code class="literal">INSERT INTO table VALUES (), (), ()</code>, instead
        the statements are executed sequentially.
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">Statement.getGeneratedKeys()</code> returned two
        keys when using <code class="literal">ON DUPLICATE KEY UPDATE</code> and
        the row was updated, not inserted.
       (Bug #42309)</p></li><li><p>
        When using the replication driver with
        <code class="literal">autoReconnect=true</code>, Connector/J checks in
        <code class="literal">PreparedStatement.execute</code> (also called by
        <code class="literal">CallableStatement.execute</code>) to determine if
        the first character of the statement is an “<span class="quote">S</span>”, in
        an attempt to block all statements that are not read-only-safe,
        for example non-<a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a>
        statements. However, this also blocked
        <a href="http://dev.mysql.com/doc/refman/5.5/en/call.html" target="_top"><code class="literal">CALL</code></a>s to stored procedures, even
        if the stored procedures were defined as <code class="literal">SQL READ
        DATA</code> or <code class="literal">NO SQL</code>.
       (Bug #40031)</p></li><li><p>
        With large result sets <code class="literal">ResultSet.findColumn</code>
        became a performance bottleneck.
       (Bug #39962)</p></li><li><p>
        Connector/J ignored the value of the MySQL Server variable
        <a href="http://dev.mysql.com/doc/refman/5.5/en/replication-options-master.html#sysvar_auto_increment_increment" target="_top"><code class="literal">auto_increment_increment</code></a>.
       (Bug #39956)</p></li><li><p>
        Connector/J failed to parse
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a> strings for nanos
        correctly.
       (Bug #39911)</p></li><li><p>
        When the <code class="literal">LoadBalancingConnectionProxy</code> handles
        a <code class="literal">SQLException</code> with SQL state starting with
        “<span class="quote">08</span>”, it calls
        <code class="literal">invalidateCurrentConnection</code>, which in turn
        removes that <code class="literal">Connection</code> from
        <code class="literal">liveConnections</code> and the
        <code class="literal">connectionsToHostsMap</code>, but it did not add the
        host to the new global blacklist, if the global blacklist was
        enabled.
      </p><p>
        There was also the possibility of a
        <code class="literal">NullPointerException</code> when trying to update
        stats, where
        <code class="literal">connectionsToHostsMap.get(this.currentConn)</code>
        was called:
      </p><pre class="programlisting">int hostIndex = ((Integer) this.hostsToListIndexMap.get(this.connectionsToHostsMap.get(this.currentConn))).intValue();
</pre><p>
        This could happen if a client tried to issue a rollback after
        catching a <code class="literal">SQLException</code> caused by a
        connection failure.
       (Bug #39784)</p></li><li><p>
        When configuring the Java Replication Driver the last slave
        specified was never used.
       (Bug #39611)</p></li><li><p>
        When an <code class="literal">INSERT ON DUPLICATE KEY UPDATE</code> was
        performed, and the key already existed, the
        <code class="literal">affected-rows</code> value was returned as 1 instead
        of 0.
       (Bug #39352)</p></li><li><p>
        When using the random load balancing strategy and starting with
        two servers that were both unavailable, an
        <code class="literal">IndexOutOfBoundsException</code> was generated when
        removing a server from the <code class="literal">whiteList</code>.
       (Bug #38782)</p></li><li><p>
        Connector/J threw the following exception when using a read-only
        connection:
      </p><pre class="programlisting">java.sql.SQLException: Connection is read-only. Queries leading to data
modification are not allowed.
</pre><p>(Bug #38747)</p></li><li><p>
        Connector/J was unable to connect when using a
        non-<code class="literal">latin1</code> password.
       (Bug #37570)</p></li><li><p>
        The <code class="literal">useOldAliasMetadataBehavior</code> connection
        property was ignored.
       (Bug #35753)</p></li><li><p>
        Incorrect result is returned from
        <code class="literal">isAfterLast()</code> in streaming
        <code class="literal">ResultSet</code> when using
        <code class="literal">setFetchSize(Integer.MIN_VALUE)</code>.
       (Bug #35170)</p></li><li><p>
        When <code class="literal">getGeneratedKeys()</code> was called on a
        statement that had not been created with
        <code class="literal">RETURN_GENERATED_KEYS</code>, no exception was
        thrown, and batched executions then returned erroneous values.
       (Bug #34185)</p></li><li><p>
        The <code class="literal">loadBalance</code>
        <code class="literal">bestResponseTime</code> blacklists did not have a
        global state.
       (Bug #33861)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-6"></a>A.1.10. Changes in MySQL Connector/J 5.1.6 (07 March 2008)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Multiple result sets were not supported when using streaming
        mode to return data. Both normal statements and the resul sets
        from stored procedures now return multiple results sets, with
        the exception of result sets using registered
        <code class="literal">OUTPUT</code> parameters.
       (Bug #33678)</p></li><li><p>
        XAConnections and datasources have been updated to the JDBC-4.0
        standard.
      </p></li><li><p>
        The profiler event handling has been made extensible using the
        <code class="option">profilerEventHandler</code> connection property.
      </p></li><li><p>
        Add the <code class="literal">verifyServerCertificate</code> property. If
        set to "false" the driver will not verify the server's
        certificate when <code class="literal">useSSL</code> is set to "true"
      </p><p>
        When using this feature, the keystore parameters should be
        specified by the <code class="literal">clientCertificateKeyStore*</code>
        properties, rather than system properties, as the JSSE doesn't
        it straightforward to have a nonverifying trust store and the
        "default" key store.
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="methodname">DatabaseMetaData.getColumns()</code> returns
        incorrect <code class="literal">COLUMN_SIZE</code> value for
        <code class="literal">SET</code> column.
       (Bug #36830)</p></li><li><p>
        When trying to read <code class="classname">Time</code> values like
        “<span class="quote">00:00:00</span>” with
        <code class="methodname">ResultSet.getTime(int)</code> an exception is
        thrown.
       (Bug #36051)</p></li><li><p>
        JDBC connection URL parameters is ignored when using
        <code class="literal">MysqlConnectionPoolDataSource</code>.
       (Bug #35810)</p></li><li><p>
        When <code class="literal">useServerPrepStmts=true</code> and slow query
        logging is enabled, the connector throws a
        <code class="classname">NullPointerException</code> when it encounters a
        slow query.
       (Bug #35666)</p></li><li><p>
        When using the keyword “<span class="quote">loadbalance</span>” in the
        connection string and trying to perform load balancing between
        two databases, the driver appears to hang.
       (Bug #35660)</p></li><li><p>
        JDBC data type getter method was changed to accept only column
        name, whereas previously it accepted column label.
       (Bug #35610)</p></li><li><p>
        Prepared statements from pooled connections caused a
        <code class="classname">NullPointerException</code> when
        <code class="methodname">closed()</code> under JDBC-4.0.
       (Bug #35489)</p></li><li><p>
        In calling a stored function returning a
        <code class="literal">bigint</code>, an exception is encountered
        beginning:
</p><pre class="programlisting">java.sql.SQLException: java.lang.NumberFormatException: For input string:</pre><p>
        followed by the text of the stored function starting after the
        argument list.
       (Bug #35199)</p></li><li><p>
        The JDBC driver uses a different method for evaluating column
        names in
        <code class="methodname">resultsetmetadata.getColumnName()</code> and
        when looking for a column in
        <code class="methodname">resultset.getObject(columnName)</code>. This
        causes Hibernate to fail in queries where the two methods yield
        different results, for example in queries that use alias names:
      </p><pre class="programlisting">SELECT column AS aliasName from table</pre><p>(Bug #35150)</p></li><li><p>
        <code class="literal">MysqlConnectionPoolDataSource</code> does not
        support <code class="literal">ReplicationConnection</code>. Notice that we
        implemented <code class="literal">com.mysql.jdbc.Connection</code> for
        <code class="literal">ReplicationConnection</code>, however, only
        accessors from ConnectionProperties are implemented (not the
        mutators), and they return values from the currently active
        connection. All other methods from
        <code class="literal">com.mysql.jdbc.Connection</code> are implemented,
        and operate on the currently active connection, with the
        exception of <code class="literal">resetServerState()</code> and
        <code class="literal">changeUser()</code>.
       (Bug #34937)</p></li><li><p>
        <code class="literal">ResultSet.getTimestamp()</code> returns incorrect
        values for month/day of
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a>s when using server-side
        prepared statements (not enabled by default).
       (Bug #34913)</p></li><li><p>
        <code class="classname">RowDataStatic</code> does't always set the
        metadata in <code class="classname">ResultSetRow</code>, which can lead
        to failures when unpacking <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATE</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/time.html" target="_top"><code class="literal">TIME</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATETIME</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a> types when using
        absolute, relative, and previous result set navigation methods.
       (Bug #34762)</p></li><li><p>
        When calling <code class="literal">isValid()</code> on an active
        connection, if the timeout is nonzero then the
        <code class="literal">Connection</code> is invalidated even if the
        <code class="literal">Connection</code> is valid.
       (Bug #34703)</p></li><li><p>
        It was not possible to truncate a
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> using
        <code class="literal">Blog.truncate()</code> when using 0 as an argument.
       (Bug #34677)</p></li><li><p>
        When using a cursor fetch for a statement, the internal prepared
        statement could cause a memory leak until the connection was
        closed. The internal prepared statement is now deleted when the
        corresponding result set is closed.
       (Bug #34518)</p></li><li><p>
        When retrieving the column type name of a geometry field, the
        driver would return <code class="literal">UNKNOWN</code> instead of
        <code class="literal">GEOMETRY</code>.
       (Bug #34194)</p></li><li><p>
        Statements with batched values do not return correct values for
        <code class="literal">getGeneratedKeys()</code> when
        <code class="option">rewriteBatchedStatements</code> is set to
        <code class="literal">true</code>, and the statement has an <code class="literal">ON
        DUPLICATE KEY UPDATE</code> clause.
       (Bug #34093)</p></li><li><p>
        The internal class
        <code class="classname">ResultSetInternalMethods</code> referenced the
        nonpublic class
        <code class="classname">com.mysql.jdbc.CachedResultSetMetaData</code>.
       (Bug #33823)</p></li><li><p>
        A <code class="literal">NullPointerException</code> could be raised when
        using client-side prepared statements and enabled the prepared
        statement cache using the <code class="option">cachePrepStmts</code>.
       (Bug #33734)</p></li><li><p>
        Using server side cursors and cursor fetch, the table metadata
        information would return the data type name instead of the
        column name.
       (Bug #33594)</p></li><li><p>
        <code class="methodname">ResultSet.getTimestamp()</code> would throw a
        <code class="literal">NullPointerException</code> instead of a
        <code class="literal">SQLException</code> when called on an empty
        <code class="literal">ResultSet</code>.
       (Bug #33162)</p></li><li><p>
        Load balancing connection using best response time would
        incorrectly "stick" to hosts that were down when the connection
        was first created.
      </p><p>
        We solve this problem with a black list that is used during the
        picking of new hosts. If the black list ends up including all
        configured hosts, the driver will retry for a configurable
        number of times (the <code class="option">retriesAllDown</code>
        configuration property, with a default of 120 times), sleeping
        250ms between attempts to pick a new connection.
      </p><p>
        We've also went ahead and made the balancing strategy
        extensible. To create a new strategy, implement the interface
        <code class="classname">com.mysql.jdbc.BalanceStrategy</code> (which
        also includes our standard "extension" interface), and tell the
        driver to use it by passing in the class name using the
        <code class="option">loadBalanceStrategy</code> configuration property.
       (Bug #32877)</p></li><li><p>
        During a Daylight Savings Time (DST) switchover, there was no
        way to store two timestamp/datetime values , as the hours end up
        being the same when sent as the literal that MySQL requires.
      </p><p>
        Note that to get this scenario to work with MySQL (since it
        doesn't support per-value timezones), you need to configure your
        server (or session) to be in UTC, and tell the driver not to use
        the legacy date/time code by setting
        <code class="literal">useLegacyDatetimeCode</code> to "false". This will
        cause the driver to always convert to/from the server and client
        timezone consistently.
      </p><p>
        This bug fix also fixes BUG#15604, by adding entirely new
        date/time handling code that can be switched on by
        <code class="option">useLegacyDatetimeCode</code> being set to "false" as a
        JDBC configuration property. For Connector/J 5.1.x, the default
        is "true", in trunk and beyond it will be "false" (that is, the
        old date/time handling code will be deprecated)
       (Bug #32577, Bug #15604)</p></li><li><p>
        When unpacking rows directly, we don't hand off error message
        packets to the internal method which decodes them correctly, so
        no exception is raised, and the driver than hangs trying to read
        rows that aren't there. This tends to happen when calling stored
        procedures, as normal SELECTs won't have an error in this spot
        in the protocol unless an I/O error occurs.
       (Bug #32246)</p></li><li><p>
        When using a connection from
        <code class="classname">ConnectionPoolDataSource</code>, some
        <code class="function">Connection.prepareStatement()</code> methods would
        return null instead of the prepared statement.
       (Bug #32101)</p></li><li><p>
        Using <code class="function">CallableStatement.setNull()</code> on a
        stored function would throw an
        <code class="literal">ArrayIndexOutOfBounds</code> exception when setting
        the last parameter to null.
       (Bug #31823)</p></li><li><p>
        <code class="classname">MysqlValidConnectionChecker</code> doesn't
        properly handle connections created using
        <code class="classname">ReplicationConnection</code>.
       (Bug #31790)</p></li><li><p>
        Retrieving the server version information for an active
        connection could return invalid information if the default
        character encoding on the host was not ASCII compatible.
       (Bug #31192)</p></li><li><p>
        Further fixes have been made to this bug in the event that a
        node is nonresponsive. Connector/J will now try a different
        random node instead of waiting for the node to recover before
        continuing.
       (Bug #31053)</p></li><li><p>
        <code class="literal">ResultSet</code> returned by
        <code class="literal">Statement.getGeneratedKeys()</code> is not closed
        automatically when statement that created it is closed.
       (Bug #30508)</p></li><li><p>
        <code class="function">DatabaseMetadata.getColumns()</code> doesn't
        return the correct column names if the connection character
        isn't UTF-8. A bug in MySQL server compounded the issue, but was
        fixed within the MySQL 5.0 release cycle. The fix includes
        changes to all the sections of the code that access the server
        metadata.
       (Bug #20491)</p></li><li><p>
        Fixed <code class="methodname">ResultSetMetadata.getColumnName()</code>
        for result sets returned from
        <code class="methodname">Statement.getGeneratedKeys()</code> - it was
        returning null instead of "GENERATED_KEY" as in 5.0.x.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-5"></a>A.1.11. Changes in MySQL Connector/J 5.1.5 (09 October 2007)</h3></div></div></div><p><span class="bold"><strong>The following     features are new, compared to the 5.0 series of Connector/J</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Support for JDBC-4.0 <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NCHAR</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NVARCHAR</code></a> and
        <code class="literal">NCLOB</code> types.
      </p></li><li><p>
        JDBC-4.0 support for setting per-connection client information
        (which can be viewed in the comments section of a query using
        <a href="http://dev.mysql.com/doc/refman/5.5/en/show-processlist.html" target="_top"><code class="literal">SHOW PROCESSLIST</code></a> on a MySQL
        server, or can be extended to support custom persistence of the
        information using a public interface).
      </p></li><li><p>
        Support for JDBC-4.0 XML processing using JAXP interfaces to
        DOM, SAX and StAX.
      </p></li><li><p>
        JDBC-4.0 standardized unwrapping to interfaces that include
        vendor extensions.
      </p></li></ul></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Added <code class="literal">autoSlowLog</code> configuration property,
        overrides <code class="literal">slowQueryThreshold*</code> properties,
        driver determines slow queries by those that are slower than 5 *
        stddev of the mean query time (outside the 96% percentile).
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        When a connection is in read-only mode, queries that are wrapped
        in parentheses were incorrectly identified DML statements.
       (Bug #28256)</p></li><li><p>
        When calling <code class="literal">setTimestamp</code> on a prepared
        statement, the timezone information stored in the calendar
        object was ignored. This resulted in the incorrect
        <code class="literal">DATETIME</code> information being stored. The
        following example illustrates this:
      </p><pre class="programlisting">Timestamp t = new Timestamp( cal.getTimeInMillis() );
ps.setTimestamp( N, t, cal );</pre><p>(Bug #15604)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-4"></a>A.1.12. Changes in MySQL Connector/J 5.1.4 (Not Released)</h3></div></div></div><p>
        Only released internally.
      </p><p>This section has no changelog entries.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-3"></a>A.1.13. Changes in MySQL Connector/J 5.1.3 (10 September 2007)</h3></div></div></div><p><span class="bold"><strong>The following     features are new, compared to the 5.0 series of Connector/J</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Support for JDBC-4.0 <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NCHAR</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NVARCHAR</code></a> and
        <code class="literal">NCLOB</code> types.
      </p></li><li><p>
        JDBC-4.0 support for setting per-connection client information
        (which can be viewed in the comments section of a query using
        <a href="http://dev.mysql.com/doc/refman/5.5/en/show-processlist.html" target="_top"><code class="literal">SHOW PROCESSLIST</code></a> on a MySQL
        server, or can be extended to support custom persistence of the
        information using a public interface).
      </p></li><li><p>
        Support for JDBC-4.0 XML processing using JAXP interfaces to
        DOM, SAX and StAX.
      </p></li><li><p>
        JDBC-4.0 standardized unwrapping to interfaces that include
        vendor extensions.
      </p></li></ul></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connector/J now connects using an initial character set of
        <code class="literal">utf-8</code> solely for the purpose of
        authentication to permit user names or database names in any
        character set to be used in the JDBC connection URL.
       (Bug #29853)</p></li><li><p>
        Added two configuration parameters:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">blobsAreStrings</code>: Should the driver always
            treat BLOBs as Strings. Added specifically to work around
            dubious metadata returned by the server for <code class="literal">GROUP
            BY</code> clauses. Defaults to false.
          </p></li><li><p>
            <code class="literal">functionsNeverReturnBlobs</code>: Should the
            driver always treat data from functions returning
            <code class="literal">BLOBs</code> as Strings. Added specifically to
            work around dubious metadata returned by the server for
            <code class="literal">GROUP BY</code> clauses. Defaults to false.
          </p></li></ul></div></li><li><p>
        Setting <code class="option">rewriteBatchedStatements</code> to
        <code class="literal">true</code> now causes CallableStatements with
        batched arguments to be re-written in the form "CALL (...); CALL
        (...); ..." to send the batch in as few client/server round
        trips as possible.
      </p></li><li><p>
        The driver now picks appropriate internal row representation
        (whole row in one buffer, or individual byte[]s for each column
        value) depending on heuristics, including whether or not the row
        has <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> or
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> types and the overall
        row-size. The threshold for row size that will cause the driver
        to use a buffer rather than individual byte[]s is configured by
        the configuration property
        <code class="option">largeRowSizeThreshold</code>, which has a default
        value of 2KB.
      </p></li><li><p>
        The data (and how it is stored) for <code class="literal">ResultSet</code>
        rows are now behind an interface which enables us (in some
        cases) to allocate less memory per row, in that for "streaming"
        result sets, we re-use the packet used to read rows, since only
        one row at a time is ever active.
      </p></li><li><p>
        Added experimental support for statement "interceptors" through
        the <code class="literal">com.mysql.jdbc.StatementInterceptor</code>
        interface, examples are in
        <code class="filename">com/mysql/jdbc/interceptors</code>. Implement this
        interface to be placed "in between" query execution, so that it
        can be influenced (currently experimental).
      </p></li><li><p>
        The driver will automatically adjust the server session variable
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_net_write_timeout" target="_top"><code class="literal">net_write_timeout</code></a> when it
        determines its been asked for a "streaming" result, and resets
        it to the previous value when the result set has been consumed.
        (The configuration property is named
        <code class="option">netTimeoutForStreamingResults</code>, with a unit of
        seconds, the value '0' means the driver will not try and adjust
        this value).
      </p></li><li><p>
        JDBC-4.0 ease-of-development features including
        auto-registration with the <code class="literal">DriverManager</code>
        through the service provider mechanism, standardized Connection
        validity checks and categorized <code class="literal">SQLExceptions</code>
        based on recoverability/retry-ability and class of the
        underlying error.
      </p></li><li><p>
        <code class="literal">Statement.setQueryTimeout()</code>s now affect the
        entire batch for batched statements, rather than the individual
        statements that make up the batch.
      </p></li><li><p>
        Errors encountered during
        <code class="literal">Statement</code>/<code class="literal">PreparedStatement</code>/<code class="literal">CallableStatement.executeBatch()</code>
        when <code class="literal">rewriteBatchStatements</code> has been set to
        <code class="literal">true</code> now return
        <code class="literal">BatchUpdateExceptions</code> according to the
        setting of <code class="literal">continueBatchOnError</code>.
      </p><p>
        If <code class="literal">continueBatchOnError</code> is set to
        <code class="literal">true</code>, the update counts for the "chunk" that
        were sent as one unit will all be set to
        <code class="literal">EXECUTE_FAILED</code>, but the driver will attempt
        to process the remainder of the batch. You can determine which
        "chunk" failed by looking at the update counts returned in the
        <code class="literal">BatchUpdateException</code>.
      </p><p>
        If <code class="literal">continueBatchOnError</code> is set to "false",
        the update counts returned will contain all updates up-to and
        including the failed "chunk", with all counts for the failed
        "chunk" set to <code class="literal">EXECUTE_FAILED</code>.
      </p><p>
        Since MySQL doesn't return multiple error codes for
        multiple-statements, or for multi-value
        <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/replace.html" target="_top"><code class="literal">REPLACE</code></a>,
        it is the application's responsibility to handle determining
        which item(s) in the "chunk" actually failed.
      </p></li><li><p>
        New methods on com.mysql.jdbc.Statement:
        <code class="literal">setLocalInfileInputStream()</code> and
        <code class="literal">getLocalInfileInputStream()</code>:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">setLocalInfileInputStream()</code> sets an
            <code class="literal">InputStream</code> instance that will be used to
            send data to the MySQL server for a
            <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
            INFILE</code></a> statement rather than a
            <code class="literal">FileInputStream</code> or
            <code class="literal">URLInputStream</code> that represents the path
            given as an argument to the statement.
          </p><p>
            This stream will be read to completion upon execution of a
            <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
            INFILE</code></a> statement, and will automatically be closed
            by the driver, so it needs to be reset before each call to
            <code class="literal">execute*()</code> that would cause the MySQL
            server to request data to fulfill the request for
            <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
            INFILE</code></a>.
          </p><p>
            If this value is set to <code class="literal">NULL</code>, the driver
            will revert to using a <code class="literal">FileInputStream</code> or
            <code class="literal">URLInputStream</code> as required.
          </p></li><li><p>
            <code class="literal">getLocalInfileInputStream()</code> returns the
            <code class="literal">InputStream</code> instance that will be used to
            send data in response to a
            <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
            INFILE</code></a> statement.
          </p><p>
            This method returns <code class="literal">NULL</code> if no such
            stream has been set using
            <code class="literal">setLocalInfileInputStream()</code>.
          </p></li></ul></div></li><li><p>
        Setting <code class="option">useBlobToStoreUTF8OutsideBMP</code> to
        <code class="literal">true</code> tells the driver to treat
        <code class="literal">[MEDIUM/LONG]BLOB</code> columns as
        <code class="literal">[LONG]VARCHAR</code> columns holding text encoded in
        UTF-8 that has characters outside the BMP (4-byte encodings),
        which MySQL server can't handle natively.
      </p><p>
        Set <code class="option">utf8OutsideBmpExcludedColumnNamePattern</code> to
        a regex so that column names matching the given regex will still
        be treated as <code class="literal">BLOBs</code> The regex must follow the
        patterns used for the <code class="literal">java.util.regex</code>package.
        The default is to exclude no columns, and include all columns.
      </p><p>
        Set <code class="option">utf8OutsideBmpIncludedColumnNamePattern</code> to
        specify exclusion rules to
        utf8OutsideBmpExcludedColumnNamePattern". The regex must follow
        the patterns used for the <code class="literal">java.util.regex</code>
        package.
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">setObject(int, Object, int, int)</code> delegate in
        PreparedStatementWrapper delegates to wrong method.
       (Bug #30892)</p></li><li><p>
        NPE with null column values when
        <code class="option">padCharsWithSpace</code> is set to true.
       (Bug #30851)</p></li><li><p>
        Collation on <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> column
        types would be misidentified. A fix has been added, but this fix
        only works for MySQL server versions 5.0.25 and newer, since
        earlier versions didn't consistently return correct metadata for
        functions, and thus results from subqueries and functions were
        indistinguishable from each other, leading to type-related bugs.
       (Bug #30664)</p></li><li><p>
        An <code class="literal">ArithmeticException</code> or
        <code class="literal">NullPointerException</code> would be raised when the
        batch had zero members and
        <code class="literal">rewriteBatchedStatements=true</code> when
        <code class="literal">addBatch()</code> was never called, or
        <code class="literal">executeBatch()</code> was called immediately after
        <code class="literal">clearBatch()</code>.
       (Bug #30550)</p></li><li><p>
        Closing a load-balanced connection would cause a
        <code class="literal">ClassCastException</code>.
       (Bug #29852)</p></li><li><p>
        Connection checker for JBoss didn't use same method parameters
        using reflection, causing connections to always seem "bad".
       (Bug #29106)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getTypeInfo()</code> for the types
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">NUMERIC</code></a> will return a precision
        of 254 for server versions older than 5.0.3, 64 for versions
        5.0.3 to 5.0.5 and 65 for versions newer than 5.0.5.
       (Bug #28972)</p></li><li><p>
        <code class="literal">CallableStatement.executeBatch()</code> doesn't work
        when connection property
        <code class="option">noAccessToProcedureBodies</code> has been set to
        <code class="literal">true</code>.
      </p><p>
        The fix involves changing the behavior of
        <code class="option">noAccessToProcedureBodies</code>,in that the driver
        will now report all paramters as <code class="literal">IN</code> paramters
        but permit callers to call registerOutParameter() on them
        without throwing an exception.
       (Bug #28689)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> doesn't contain
        <code class="literal">SCOPE_*</code> or
        <code class="literal">IS_AUTOINCREMENT</code> columns.
       (Bug #27915)</p></li><li><p>
        Schema objects with identifiers other than the connection
        character aren't retrieved correctly in
        <code class="literal">ResultSetMetadata</code>.
       (Bug #27867)</p></li><li><p>
        <code class="literal">Connection.getServerCharacterEncoding()</code>
        doesn't work for servers with version &gt;= 4.1.
       (Bug #27182)</p></li><li><p>
        The automated SVN revisions in
        <code class="literal">DBMD.getDriverVersion()</code>. The SVN revision of
        the directory is now inserted into the version information
        during the build.
       (Bug #21116)</p></li><li><p>
        Specifying a "validation query" in your connection pool that
        starts with "/* ping */" _exactly_ will cause the driver to
        instead send a ping to the server and return a fake result set
        (much lighter weight), and when using a ReplicationConnection or
        a LoadBalancedConnection, will send the ping across all active
        connections.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-2"></a>A.1.14. Changes in MySQL Connector/J 5.1.2 (29 June 2007)</h3></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs.
      </p><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Setting the configuration property
        <code class="literal">rewriteBatchedStatements</code> to
        <code class="literal">true</code> will now cause the driver to rewrite
        batched prepared statements with more than 3 parameter sets in a
        batch into multi-statements (separated by ";") if they are not
        plain (that is, without <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> or
        <code class="literal">ON DUPLICATE KEY UPDATE</code> clauses)
        <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a> or
        <a href="http://dev.mysql.com/doc/refman/5.5/en/replace.html" target="_top"><code class="literal">REPLACE</code></a> statements.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-1"></a>A.1.15. Changes in MySQL Connector/J 5.1.1 (22 June 2007)</h3></div></div></div><p class="release-level">
        This is a new Alpha development release, adding new features and
        fixing recently discovered bugs.
      </p><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Incompatible Change</strong></span>: 
        Pulled vendor-extension methods of <code class="literal">Connection</code>
        implementation out into an interface to support
        <code class="literal">java.sql.Wrapper</code> functionality from
        <code class="literal">ConnectionPoolDataSource</code>. The vendor
        extensions are javadoc'd in the
        <code class="literal">com.mysql.jdbc.Connection</code> interface.
      </p><p>
        For those looking further into the driver implementation, it is
        not an API that is used for plugability of implementations
        inside our driver (which is why there are still references to
        <code class="literal">ConnectionImpl</code> throughout the code).
      </p><p>
        We've also added server and client
        <code class="literal">prepareStatement()</code> methods that cover all of
        the variants in the JDBC API.
      </p><p>
        <code class="literal">Connection.serverPrepare(String)</code> has been
        re-named to
        <code class="literal">Connection.serverPrepareStatement()</code> for
        consistency with
        <code class="literal">Connection.clientPrepareStatement()</code>.
      </p></li><li><p>
        Row navigation now causes any streams/readers open on the result
        set to be closed, as in some cases we're reading directly from a
        shared network packet and it will be overwritten by the "next"
        row.
      </p></li><li><p>
        Made it possible to retrieve prepared statement parameter
        bindings (to be used in
        <code class="literal">StatementInterceptors</code>, primarily).
      </p></li><li><p>
        Externalized the descriptions of connection properties.
      </p></li><li><p>
        The data (and how it is stored) for <code class="literal">ResultSet</code>
        rows are now behind an interface which enables us (in some
        cases) to allocate less memory per row, in that for "streaming"
        result sets, we re-use the packet used to read rows, since only
        one row at a time is ever active.
      </p></li><li><p>
        Similar to <code class="literal">Connection</code>, we pulled out vendor
        extensions to <code class="literal">Statement</code> into an interface
        named <code class="literal">com.mysql.Statement</code>, and moved the
        <code class="literal">Statement</code> class into
        <code class="literal">com.mysql.StatementImpl</code>. The two methods
        (javadoc'd in <code class="literal">com.mysql.Statement</code> are
        <code class="literal">enableStreamingResults()</code>, which already
        existed, and <code class="literal">disableStreamingResults()</code> which
        sets the statement instance back to the fetch size and result
        set type it had before
        <code class="literal">enableStreamingResults()</code> was called.
      </p></li><li><p>
        Driver now picks appropriate internal row representation (whole
        row in one buffer, or individual byte[]s for each column value)
        depending on heuristics, including whether or not the row has
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> or
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> types and the overall
        row-size. The threshold for row size that will cause the driver
        to use a buffer rather than individual byte[]s is configured by
        the configuration property
        <code class="literal">largeRowSizeThreshold</code>, which has a default
        value of 2KB.
      </p></li><li><p>
        Added experimental support for statement "interceptors" through
        the <code class="literal">com.mysql.jdbc.StatementInterceptor</code>
        interface, examples are in
        <code class="filename">com/mysql/jdbc/interceptors</code>.
      </p><p>
        Implement this interface to be placed "in between" query
        execution, so that you can influence it. (currently
        experimental).
      </p><p>
        <code class="literal">StatementInterceptors</code> are "chainable" when
        configured by the user, the results returned by the "current"
        interceptor will be passed on to the next on in the chain, from
        left-to-right order, as specified by the user in the JDBC
        configuration property <code class="literal">statementInterceptors</code>.
      </p></li><li><p>
        See the sources (fully javadoc'd) for
        <code class="literal">com.mysql.jdbc.StatementInterceptor</code> for more
        details until we iron out the API and get it documented in the
        manual.
      </p></li><li><p>
        Setting <code class="literal">rewriteBatchedStatements</code> to
        <code class="literal">true</code> now causes
        <code class="literal">CallableStatements</code> with batched arguments to
        be re-written in the form <code class="literal">CALL (...); CALL (...);
        ...</code> to send the batch in as few client/server round
        trips as possible.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-1-0"></a>A.1.16. Changes in MySQL Connector/J 5.1.0 (11 April 2007)</h3></div></div></div><p>
        This is the first public alpha release of the current
        Connector/J 5.1 development branch, providing an insight to
        upcoming features. Although some of these are still under
        development, this release includes the following new features
        and changes (in comparison to the current Connector/J 5.0
        production release):
      </p><p>
        <span class="bold"><strong>Important change:</strong></span> Due to a
        number of issues with the use of server-side prepared
        statements, Connector/J 5.0.5 has disabled their use by default.
        The disabling of server-side prepared statements does not affect
        the operation of the connector in any way.
      </p><p>
        To enable server-side prepared statements you must add the
        following configuration property to your connector string:
      </p><pre class="programlisting">useServerPrepStmts=true</pre><p>
        The default value of this property is <code class="literal">false</code>
        (that is, Connector/J does not use server-side prepared
        statements).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          The disabling of server-side prepared statements does not
          affect the operation of the connector. However, if you use the
          <code class="literal">useTimezone=true</code> connection option and use
          client-side prepared statements (instead of server-side
          prepared statements) you should also set
          <code class="literal">useSSPSCompatibleTimezoneShift=true</code>.
        </p></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Refactored <code class="literal">CommunicationsException</code> into a
        JDBC-3.0 version, and a JDBC-4.0 version (which extends
        <code class="literal">SQLRecoverableException</code>, now that it exists).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          This change means that if you were catching
          <code class="literal">com.mysql.jdbc.CommunicationsException</code> in
          your applications instead of looking at the SQLState class of
          <code class="literal">08</code>, and are moving to Java 6 (or newer),
          you need to change your imports to that exception to be
          <code class="literal">com.mysql.jdbc.exceptions.jdbc4.CommunicationsException</code>,
          as the old class will not be instantiated for communications
          link-related errors under Java 6.
        </p></div></li><li><p>
        Added support for JDBC-4.0 categorized
        <code class="literal">SQLExceptions</code>.
      </p></li><li><p>
        Added support for JDBC-4.0's <code class="literal">NCLOB</code>, and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NCHAR</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">NVARCHAR</code></a>
        types.
      </p></li><li><p>
        <code class="literal">com.mysql.jdbc.java6.javac</code>: Full path to your
        Java-6 <span><strong class="command">javac</strong></span> executable
      </p></li><li><p>
        Added support for JDBC-4.0's SQLXML interfaces.
      </p></li><li><p>
        Re-worked Ant buildfile to build JDBC-4.0 classes separately, as
        well as support building under Eclipse (since Eclipse can't
        mix/match JDKs).
      </p><p>
        To build, you must set <code class="literal">JAVA_HOME</code> to
        J2SDK-1.4.2 or Java-5, and set the following properties on your
        Ant command line:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">com.mysql.jdbc.java6.javac</code>: Full path to
            your Java-6 <span><strong class="command">javac</strong></span> executable
          </p></li><li><p>
            <code class="literal">com.mysql.jdbc.java6.rtjar</code>: Full path to
            your Java-6 <code class="filename">rt.jar</code> file
          </p></li></ul></div></li><li><p>
        New feature—driver will automatically adjust session
        variable <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_net_write_timeout" target="_top"><code class="literal">net_write_timeout</code></a> when
        it determines it has been asked for a "streaming" result, and
        resets it to the previous value when the result set has been
        consumed. (configuration property is named
        <code class="literal">netTimeoutForStreamingResults</code> value and has a
        unit of seconds, the value <code class="literal">0</code> means the driver
        will not try and adjust this value).
      </p></li><li><p>
        Added support for JDBC-4.0's client information. The backend
        storage of information provided using
        <code class="literal">Connection.setClientInfo()</code> and retrieved by
        <code class="literal">Connection.getClientInfo()</code> is pluggable by
        any class that implements the
        <code class="literal">com.mysql.jdbc.JDBC4ClientInfoProvider</code>
        interface and has a no-args constructor.
      </p><p>
        The implementation used by the driver is configured using the
        <code class="literal">clientInfoProvider</code> configuration property
        (with a default of value of
        <code class="literal">com.mysql.jdbc.JDBC4CommentClientInfoProvider</code>,
        an implementation which lists the client information as a
        comment prepended to every query sent to the server).
      </p><p>
        This functionality is only available when using Java-6 or newer.
      </p></li><li><p>
        <code class="literal">com.mysql.jdbc.java6.rtjar</code>: Full path to your
        Java-6 <code class="filename">rt.jar</code> file
      </p></li><li><p>
        Added support for JDBC-4.0's <code class="literal">Wrapper</code>
        interface.
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cj-news-5-0"></a>A.2. Changes in MySQL Connector/J 5.0.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-5-0-8">A.2.1. Changes in MySQL Connector/J 5.0.8 (09 October 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-7">A.2.2. Changes in MySQL Connector/J 5.0.7 (20 July 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-6">A.2.3. Changes in MySQL Connector/J 5.0.6 (15 May 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-5">A.2.4. Changes in MySQL Connector/J 5.0.5 (02 March 2007)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-4">A.2.5. Changes in MySQL Connector/J 5.0.4 (20 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-3">A.2.6. Changes in MySQL Connector/J 5.0.3 (26 July 2006 beta)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-2">A.2.7. Changes in MySQL Connector/J 5.0.2 (11 July 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-1">A.2.8. Changes in MySQL Connector/J 5.0.1 (Not Released)</a></span></dt><dt><span class="section"><a href="#cj-news-5-0-0">A.2.9. Changes in MySQL Connector/J 5.0.0 (22 December 2005)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-8"></a>A.2.1. Changes in MySQL Connector/J 5.0.8 (09 October 2007)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">blobsAreStrings</code>: Should the driver always
        treat BLOBs as Strings. Added specifically to work around
        dubious metadata returned by the server for <code class="literal">GROUP
        BY</code> clauses. Defaults to false.
      </p></li><li><p>
        Added two configuration parameters:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">blobsAreStrings</code>: Should the driver always
            treat BLOBs as Strings. Added specifically to work around
            dubious metadata returned by the server for <code class="literal">GROUP
            BY</code> clauses. Defaults to false.
          </p></li><li><p>
            <code class="literal">functionsNeverReturnBlobs</code>: Should the
            driver always treat data from functions returning
            <code class="literal">BLOBs</code> as Strings. Added specifically to
            work around dubious metadata returned by the server for
            <code class="literal">GROUP BY</code> clauses. Defaults to false.
          </p></li></ul></div></li><li><p>
        <code class="literal">functionsNeverReturnBlobs</code>: Should the driver
        always treat data from functions returning
        <code class="literal">BLOBs</code> as Strings. Added specifically to work
        around dubious metadata returned by the server for
        <code class="literal">GROUP BY</code> clauses. Defaults to false.
      </p></li><li><p>
        XAConnections now start in auto-commit mode (as per JDBC-4.0
        specification clarification).
      </p></li><li><p>
        Driver will now fall back to sane defaults for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_net_buffer_length" target="_top"><code class="literal">net_buffer_length</code></a> if the server
        reports them incorrectly (and will log this situation at
        <code class="literal">WARN</code> level, since it is actually an error
        condition).
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connections established using URLs of the form
        <code class="literal">jdbc:mysql:loadbalance://</code> weren't doing
        failover if they tried to connect to a MySQL server that was
        down. The driver now attempts connections to the next "best"
        (depending on the load balance strategy in use) server, and
        continues to attempt connecting to the next "best" server every
        250 milliseconds until one is found that is up and running or 5
        minutes has passed.
      </p><p>
        If the driver gives up, it will throw the last-received
        <code class="literal">SQLException</code>.
       (Bug #31053)</p></li><li><p>
        <code class="literal">setObject(int, Object, int, int)</code> delegate in
        PreparedStatementWrapper delegates to wrong method.
       (Bug #30892)</p></li><li><p>
        NPE with null column values when
        <code class="option">padCharsWithSpace</code> is set to true.
       (Bug #30851)</p></li><li><p>
        Collation on <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> column
        types would be misidentified. A fix has been added, but this fix
        only works for MySQL server versions 5.0.25 and newer, since
        earlier versions didn't consistently return correct metadata for
        functions, and thus results from subqueries and functions were
        indistinguishable from each other, leading to type-related bugs.
       (Bug #30664)</p></li><li><p>
        An <code class="literal">ArithmeticException</code> or
        <code class="literal">NullPointerException</code> would be raised when the
        batch had zero members and
        <code class="literal">rewriteBatchedStatements=true</code> when
        <code class="literal">addBatch()</code> was never called, or
        <code class="literal">executeBatch()</code> was called immediately after
        <code class="literal">clearBatch()</code>.
       (Bug #30550)</p></li><li><p>
        Closing a load-balanced connection would cause a
        <code class="literal">ClassCastException</code>.
       (Bug #29852)</p></li><li><p>
        Connection checker for JBoss didn't use same method parameters
        using reflection, causing connections to always seem "bad".
       (Bug #29106)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getTypeInfo()</code> for the types
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">NUMERIC</code></a> will return a precision
        of 254 for server versions older than 5.0.3, 64 for versions
        5.0.3 to 5.0.5 and 65 for versions newer than 5.0.5.
       (Bug #28972)</p></li><li><p>
        <code class="literal">CallableStatement.executeBatch()</code> doesn't work
        when connection property
        <code class="option">noAccessToProcedureBodies</code> has been set to
        <code class="literal">true</code>.
      </p><p>
        The fix involves changing the behavior of
        <code class="option">noAccessToProcedureBodies</code>,in that the driver
        will now report all paramters as <code class="literal">IN</code> paramters
        but permit callers to call registerOutParameter() on them
        without throwing an exception.
       (Bug #28689)</p></li><li><p>
        When a connection is in read-only mode, queries that are wrapped
        in parentheses were incorrectly identified DML statements.
       (Bug #28256)</p></li><li><p>
        <code class="literal">UNSIGNED</code> types not reported using
        <code class="literal">DBMD.getTypeInfo()</code>, and capitalization of
        type names is not consistent between
        <code class="literal">DBMD.getColumns()</code>,
        <code class="literal">RSMD.getColumnTypeName()</code> and
        <code class="literal">DBMD.getTypeInfo()</code>.
      </p><p>
        This fix also ensures that the precision of <code class="literal">UNSIGNED
        MEDIUMINT</code> and <code class="literal">UNSIGNED BIGINT</code> is
        reported correctly using <code class="literal">DBMD.getColumns()</code>.
       (Bug #27916)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> doesn't contain
        <code class="literal">SCOPE_*</code> or
        <code class="literal">IS_AUTOINCREMENT</code> columns.
       (Bug #27915)</p></li><li><p>
        Schema objects with identifiers other than the connection
        character aren't retrieved correctly in
        <code class="literal">ResultSetMetadata</code>.
       (Bug #27867)</p></li><li><p>
        Cached metadata with
        <code class="literal">PreparedStatement.execute()</code> throws
        <code class="literal">NullPointerException</code>.
       (Bug #27412)</p></li><li><p>
        <code class="literal">Connection.getServerCharacterEncoding()</code>
        doesn't work for servers with version &gt;= 4.1.
       (Bug #27182)</p></li><li><p>
        The automated SVN revisions in
        <code class="literal">DBMD.getDriverVersion()</code>. The SVN revision of
        the directory is now inserted into the version information
        during the build.
       (Bug #21116)</p></li><li><p>
        Specifying a "validation query" in your connection pool that
        starts with "/* ping */" _exactly_ will cause the driver to
        instead send a ping to the server and return a fake result set
        (much lighter weight), and when using a ReplicationConnection or
        a LoadBalancedConnection, will send the ping across all active
        connections.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-7"></a>A.2.2. Changes in MySQL Connector/J 5.0.7 (20 July 2007)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The driver will now automatically set
        <code class="literal">useServerPrepStmts</code> to <code class="literal">true</code>
        when <code class="literal">useCursorFetch</code> has been set to
        <code class="literal">true</code>, since the feature requires server-side
        prepared statements to function.
      </p></li><li><p>
        <code class="literal">tcpKeepAlive</code> - Should the driver set
        SO_KEEPALIVE (default <code class="literal">true</code>)?
      </p></li><li><p>
        Give more information in EOFExceptions thrown out of MysqlIO
        (how many bytes the driver expected to read, how many it
        actually read, say that communications with the server were
        unexpectedly lost).
      </p></li><li><p>
        Driver detects when it is running in a ColdFusion MX server
        (tested with version 7), and uses the configuration bundle
        <code class="literal">coldFusion</code>, which sets
        <code class="literal">useDynamicCharsetInfo</code> to
        <code class="literal">false</code> (see previous entry), and sets
        <code class="literal">useLocalSessionState</code> and autoReconnect to
        <code class="literal">true</code>.
      </p></li><li><p>
        <code class="literal">tcpNoDelay</code> - Should the driver set
        SO_TCP_NODELAY (disabling the Nagle Algorithm, default
        <code class="literal">true</code>)?
      </p></li><li><p>
        Added configuration property
        <code class="literal">slowQueryThresholdNanos</code> - if
        <code class="literal">useNanosForElapsedTime</code> is set to
        <code class="literal">true</code>, and this property is set to a nonzero
        value the driver will use this threshold (in nanosecond units)
        to determine if a query was slow, instead of using millisecond
        units.
      </p></li><li><p>
        <code class="literal">tcpRcvBuf</code> - Should the driver set SO_RCV_BUF
        to the given value? The default value of '0', means use the
        platform default value for this property.
      </p></li><li><p>
        Setting <code class="literal">useDynamicCharsetInfo</code> to
        <code class="literal">false</code> now causes driver to use static lookups
        for collations as well (makes
        ResultSetMetadata.isCaseSensitive() much more efficient, which
        leads to performance increase for ColdFusion, which calls this
        method for every column on every table it sees, it appears).
      </p></li><li><p>
        Added configuration properties to enable tuning of TCP/IP socket
        parameters:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">tcpNoDelay</code> - Should the driver set
            SO_TCP_NODELAY (disabling the Nagle Algorithm, default
            <code class="literal">true</code>)?
          </p></li><li><p>
            <code class="literal">tcpKeepAlive</code> - Should the driver set
            SO_KEEPALIVE (default <code class="literal">true</code>)?
          </p></li><li><p>
            <code class="literal">tcpRcvBuf</code> - Should the driver set
            SO_RCV_BUF to the given value? The default value of '0',
            means use the platform default value for this property.
          </p></li><li><p>
            <code class="literal">tcpSndBuf</code> - Should the driver set
            SO_SND_BUF to the given value? The default value of '0',
            means use the platform default value for this property.
          </p></li><li><p>
            <code class="literal">tcpTrafficClass</code> - Should the driver set
            traffic class or type-of-service fields? See the
            documentation for java.net.Socket.setTrafficClass() for more
            information.
          </p></li></ul></div></li><li><p>
        Setting the configuration parameter
        <code class="literal">useCursorFetch</code> to <code class="literal">true</code> for
        MySQL-5.0+ enables the use of cursors that enable Connector/J to
        save memory by fetching result set rows in chunks (where the
        chunk size is set by calling setFetchSize() on a Statement or
        ResultSet) by using fully-materialized cursors on the server.
      </p></li><li><p>
        <code class="literal">tcpSndBuf</code> - Should the driver set SO_SND_BUF
        to the given value? The default value of '0', means use the
        platform default value for this property.
      </p></li><li><p>
        <code class="literal">tcpTrafficClass</code> - Should the driver set
        traffic class or type-of-service fields? See the documentation
        for java.net.Socket.setTrafficClass() for more information.
      </p></li><li><p>
        Added new debugging functionality - Setting configuration
        property
        <code class="literal">includeInnodbStatusInDeadlockExceptions</code> to
        <code class="literal">true</code> will cause the driver to append the
        output of <a href="http://dev.mysql.com/doc/refman/5.5/en/show-engine.html" target="_top"><code class="literal">SHOW
        ENGINE INNODB STATUS</code></a> to deadlock-related exceptions,
        which will enumerate the current locks held inside InnoDB.
      </p></li><li><p>
        Added configuration property
        <code class="literal">useNanosForElapsedTime</code> - for
        profiling/debugging functionality that measures elapsed time,
        should the driver try to use nanoseconds resolution if available
        (requires JDK &gt;= 1.5)?
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          If <code class="literal">useNanosForElapsedTime</code> is set to
          <code class="literal">true</code>, and this property is set to "0" (or
          left default), then elapsed times will still be measured in
          nanoseconds (if possible), but the slow query threshold will
          be converted from milliseconds to nanoseconds, and thus have
          an upper bound of approximately 2000 milliseconds (as that
          threshold is represented as an integer, not a long).
        </p></div></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Don't send any file data in response to LOAD DATA LOCAL INFILE
        if the feature is disabled at the client side. This is to
        prevent a malicious server or man-in-the-middle from asking the
        client for data that the client is not expecting. Thanks to Jan
        Kneschke for discovering the exploit and Andrey "Poohie"
        Hristov, Konstantin Osipov and Sergei Golubchik for discussions
        about implications and possible fixes.
       (Bug #29605)</p></li><li><p>
        Parser in client-side prepared statements runs to end of
        statement, rather than end-of-line for '#' comments. Also added
        support for '--' single-line comments.
       (Bug #28956)</p></li><li><p>
        Parser in client-side prepared statements eats character
        following '/' if it is not a multi-line comment.
       (Bug #28851)</p></li><li><p>
        PreparedStatement.getMetaData() for statements containing
        leading one-line comments is not returned correctly.
      </p><p>
        As part of this fix, we also overhauled detection of DML for
        <code class="literal">executeQuery()</code> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a>s for
        <code class="literal">executeUpdate()</code> in plain and prepared
        statements to be aware of the same types of comments.
       (Bug #28469)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-6"></a>A.2.3. Changes in MySQL Connector/J 5.0.6 (15 May 2007)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Added an experimental load-balanced connection designed for use
        with SQL nodes in a MySQL Cluster/NDB environment (This is not
        for master-slave replication. For that, we suggest you look at
        <code class="literal">ReplicationConnection</code> or
        <code class="literal">lbpool</code>).
      </p><p>
        If the JDBC URL starts with
        <code class="literal">jdbc:mysql:loadbalance://host-1,host-2,...host-n</code>,
        the driver will create an implementation of
        <code class="literal">java.sql.Connection</code> that load balances
        requests across a series of MySQL JDBC connections to the given
        hosts, where the balancing takes place after transaction commit.
      </p><p>
        Therefore, for this to work (at all), you must use transactions,
        even if only reading data.
      </p><p>
        Physical connections to the given hosts will not be created
        until needed.
      </p><p>
        The driver will invalidate connections that it detects have had
        communication errors when processing a request. A new connection
        to the problematic host will be attempted the next time it is
        selected by the load balancing algorithm.
      </p><p>
        There are two choices for load balancing algorithms, which may
        be specified by the <code class="literal">loadBalanceStrategy</code> JDBC
        URL configuration property:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">random</code>: The driver will pick a random
            host for each request. This tends to work better than
            round-robin, as the randomness will somewhat account for
            spreading loads where requests vary in response time, while
            round-robin can sometimes lead to overloaded nodes if there
            are variations in response times across the workload.
          </p></li><li><p>
            <code class="literal">bestResponseTime</code>: The driver will route
            the request to the host that had the best response time for
            the previous transaction.
          </p></li></ul></div></li><li><p>
        <code class="literal">bestResponseTime</code>: The driver will route the
        request to the host that had the best response time for the
        previous transaction.
      </p></li><li><p>
        Added configuration property
        <code class="literal">padCharsWithSpace</code> (defaults to
        <code class="literal">false</code>). If set to <code class="literal">true</code>,
        and a result set column has the
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">CHAR</code></a> type and the value does not
        fill the amount of characters specified in the DDL for the
        column, the driver will pad the remaining characters with space
        (for ANSI compliance).
      </p></li><li><p>
        When <code class="literal">useLocalSessionState</code> is set to
        <code class="literal">true</code> and connected to a MySQL-5.0 or later
        server, the JDBC driver will now determine whether an actual
        <code class="literal">commit</code> or <code class="literal">rollback</code>
        statement needs to be sent to the database when
        <code class="literal">Connection.commit()</code> or
        <code class="literal">Connection.rollback()</code> is called.
      </p><p>
        This is especially helpful for high-load situations with
        connection pools that always call
        <code class="literal">Connection.rollback()</code> on connection
        check-in/check-out because it avoids a round-trip to the server.
      </p></li><li><p>
        Added configuration property
        <code class="literal">useDynamicCharsetInfo</code>. If set to
        <code class="literal">false</code> (the default), the driver will use a
        per-connection cache of character set information queried from
        the server when necessary, or when set to
        <code class="literal">true</code>, use a built-in static mapping that is
        more efficient, but isn't aware of custom character sets or
        character sets implemented after the release of the JDBC driver.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          This only affects the <code class="literal">padCharsWithSpace</code>
          configuration property and the
          <code class="literal">ResultSetMetaData.getColumnDisplayWidth()</code>
          method.
        </p></div></li><li><p>
        New configuration property,
        <code class="literal">enableQueryTimeouts</code> (default
        <code class="literal">true</code>).
      </p><p>
        When enabled, query timeouts set with
        <code class="literal">Statement.setQueryTimeout()</code> use a shared
        <code class="literal">java.util.Timer</code> instance for scheduling. Even
        if the timeout doesn't expire before the query is processed,
        there will be memory used by the <code class="literal">TimerTask</code>
        for the given timeout which won't be reclaimed until the time
        the timeout would have expired if it hadn't been cancelled by
        the driver. High-load environments might want to consider
        disabling this functionality. (this configuration property is
        part of the <code class="literal">maxPerformance</code> configuration
        bundle).
      </p></li><li><p>
        Give better error message when "streaming" result sets, and the
        connection gets clobbered because of exceeding
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_net_write_timeout" target="_top"><code class="literal">net_write_timeout</code></a> on the
        server.
      </p></li><li><p>
        <code class="literal">random</code>: The driver will pick a random host
        for each request. This tends to work better than round-robin, as
        the randomness will somewhat account for spreading loads where
        requests vary in response time, while round-robin can sometimes
        lead to overloaded nodes if there are variations in response
        times across the workload.
      </p></li><li><p>
        <code class="literal">com.mysql.jdbc.[NonRegistering]Driver</code> now
        understands URLs of the format
        <code class="literal">jdbc:mysql:replication://</code> and
        <code class="literal">jdbc:mysql:loadbalance://</code> which will create a
        ReplicationConnection (exactly like when using
        <code class="literal">[NonRegistering]ReplicationDriver</code>) and an
        experimental load-balanced connection designed for use with SQL
        nodes in a MySQL Cluster/NDB environment, respectively.
      </p><p>
        In an effort to simplify things, we're working on deprecating
        multiple drivers, and instead specifying different core behavior
        based upon JDBC URL prefixes, so watch for
        <code class="literal">[NonRegistering]ReplicationDriver</code> to
        eventually disappear, to be replaced with
        <code class="literal">com.mysql.jdbc[NonRegistering]Driver</code> with the
        new URL prefix.
      </p></li><li><p>
        Fixed issue where a failed-over connection would let an
        application call <code class="literal">setReadOnly(false)</code>, when
        that call should be ignored until the connection is reconnected
        to a writable master unless <code class="literal">failoverReadOnly</code>
        had been set to <code class="literal">false</code>.
      </p></li><li><p>
        Driver will now use <code class="literal">INSERT INTO ... VALUES
        (DEFAULT)</code>form of statement for updatable result sets
        for <code class="literal">ResultSet.insertRow()</code>, rather than
        pre-populating the insert row with values from
        <code class="literal">DatabaseMetaData.getColumns()</code>(which results
        in a <a href="http://dev.mysql.com/doc/refman/5.5/en/show-columns.html" target="_top"><code class="literal">SHOW FULL
        COLUMNS</code></a> on the server for every result set). If an
        application requires access to the default values before
        <code class="literal">insertRow()</code> has been called, the JDBC URL
        should be configured with
        <code class="literal">populateInsertRowWithDefaultValues</code> set to
        <code class="literal">true</code>.
      </p><p>
        This fix specifically targets performance issues with ColdFusion
        and the fact that it seems to ask for updatable result sets no
        matter what the application does with them.
      </p></li><li><p>
        More intelligent initial packet sizes for the "shared" packets
        are used (512 bytes, rather than 16K), and initial packets used
        during handshake are now sized appropriately as to not require
        reallocation.
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        More useful error messages are generated when the driver thinks
        a result set is not updatable. (Thanks to Ashley Martens for the
        patch).
       (Bug #28085)</p></li><li><p>
        <code class="literal">Connection.getTransactionIsolation()</code> uses
        "<code class="literal">SHOW VARIABLES LIKE</code>" which is very
        inefficient on MySQL-5.0+ servers.
       (Bug #27655)</p></li><li><p>
        Fixed issue where calling <code class="literal">getGeneratedKeys()</code>
        on a prepared statement after calling
        <code class="literal">execute()</code> didn't always return the generated
        keys (<code class="literal">executeUpdate()</code> worked fine however).
       (Bug #27655)</p></li><li><p>
        <code class="literal">CALL /* ... */
        <em class="replaceable"><code>some_proc</code></em>()</code> doesn't work.
        As a side effect of this fix, you can now use <code class="literal">/*
        */</code> and <code class="literal">#</code> comments when preparing
        statements using client-side prepared statement emulation.
      </p><p>
        If the comments happen to contain parameter markers
        (<code class="literal">?</code>), they will be treated as belonging to the
        comment (that is, not recognized) rather than being a parameter
        of the statement.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Note</div><p>
          The statement when sent to the server will contain the
          comments as-is, they're not stripped during the process of
          preparing the <code class="literal">PreparedStatement</code> or
          <code class="literal">CallableStatement</code>.
        </p></div><p>(Bug #27400)</p></li><li><p>
        <code class="literal">ResultSet.get*()</code> with a column index &lt; 1
        returns misleading error message.
       (Bug #27317)</p></li><li><p>
        Using <code class="literal">ResultSet.get*()</code> with a column index
        less than 1 returns a misleading error message.
       (Bug #27317)</p></li><li><p>
        Comments in DDL of stored procedures/functions confuse procedure
        parser, and thus metadata about them can not be created, leading
        to inability to retrieve said metadata, or execute procedures
        that have certain comments in them.
       (Bug #26959)</p></li><li><p>
        Fast date/time parsing doesn't take into account
        <code class="literal">00:00:00</code> as a legal value.
       (Bug #26789)</p></li><li><p>
        <code class="literal">PreparedStatement</code> is not closed in
        <code class="literal">BlobFromLocator.getBytes()</code>.
       (Bug #26592)</p></li><li><p>
        When the configuration property
        <code class="literal">useCursorFetch</code> was set to
        <code class="literal">true</code>, sometimes server would return new, more
        exact metadata during the execution of the server-side prepared
        statement that enables this functionality, which the driver
        ignored (using the original metadata returned during
        <code class="literal">prepare()</code>), causing corrupt reading of data
        due to type mismatch when the actual rows were returned.
       (Bug #26173)</p></li><li><p>
        <code class="literal">CallableStatements</code> with
        <code class="literal">OUT/INOUT</code> parameters that are "binary"
        (<a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a>,
        <code class="literal">(VAR)BINARY</code>, <code class="literal">JAVA_OBJECT</code>)
        have extra 7 bytes.
       (Bug #25715)</p></li><li><p>
        Whitespace surrounding storage/size specifiers in stored
        procedure parameters declaration causes
        <code class="literal">NumberFormatException</code> to be thrown when
        calling stored procedure on JDK-1.5 or newer, as the Number
        classes in JDK-1.5+ are whitespace intolerant.
       (Bug #25624)</p></li><li><p>
        Client options not sent correctly when using SSL, leading to
        stored procedures not being able to return results. Thanks to
        Don Cohen for the bug report, testcase and patch.
       (Bug #25545)</p></li><li><p>
        <code class="literal">Statement.setMaxRows()</code> is not effective on
        result sets materialized from cursors.
       (Bug #25517)</p></li><li><p>
        <code class="literal">BIT(&gt; 1)</code> is returned as
        <code class="literal">java.lang.String</code> from
        <code class="literal">ResultSet.getObject()</code> rather than
        <code class="literal">byte[]</code>.
       (Bug #25328)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-5"></a>A.2.4. Changes in MySQL Connector/J 5.0.5 (02 March 2007)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Usage Advisor will now issue warnings for result sets with large
        numbers of rows. You can configure the trigger value by using
        the <code class="literal">resultSetSizeThreshold</code> parameter, which
        has a default value of 100.
      </p></li><li><p>
        The <code class="literal">rewriteBatchedStatements</code> feature can now
        be used with server-side prepared statements.
      </p></li><li><p>
        <span class="bold"><strong>Important change:</strong></span> Due to a
        number of issues with the use of server-side prepared
        statements, Connector/J 5.0.5 has disabled their use by default.
        The disabling of server-side prepared statements does not affect
        the operation of the connector in any way.
      </p><p>
        To enable server-side prepared statements you must add the
        following configuration property to your connector string:
      </p><pre class="programlisting">useServerPrepStmts=true</pre><p>
        The default value of this property is <code class="literal">false</code>
        (that is, Connector/J does not use server-side prepared
        statements).
      </p></li><li><p>
        Improved speed of <code class="literal">datetime</code> parsing for
        ResultSets that come from plain or nonserver-side prepared
        statements. You can enable old implementation with
        <code class="literal">useFastDateParsing=false</code> as a configuration
        parameter.
      </p></li><li><p>
        Usage Advisor now detects empty results sets and does not report
        on columns not referenced in those empty sets.
      </p></li><li><p>
        Fixed logging of XA commands sent to server, it is now
        configurable using <code class="literal">logXaCommands</code> property
        (defaults to <code class="literal">false</code>).
      </p></li><li><p>
        Added configuration property
        <code class="literal">localSocketAddress</code>, which is the host name or
        IP address given to explicitly configure the interface that the
        driver will bind the client side of the TCP/IP connection to
        when connecting.
      </p></li><li><p>
        We've added a new configuration option
        <code class="literal">treatUtilDateAsTimestamp</code>, which is
        <code class="literal">false</code> by default, as (1) We already had
        specific behavior to treat java.util.Date as a
        java.sql.Timestamp because it is useful to many folks, and (2)
        that behavior will very likely be required for drivers
        JDBC-post-4.0.
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Connection property <code class="literal">socketFactory</code> wasn't
        exposed using correctly named mutator/accessor, causing data
        source implementations that use JavaBean naming conventions to
        set properties to fail to set the property (and in the case of
        SJAS, fail silently when trying to set this parameter).
       (Bug #26326)</p></li><li><p>
        A query execution which timed out did not always throw a
        <code class="literal">MySQLTimeoutException</code>.
       (Bug #25836)</p></li><li><p>
        Storing a <code class="literal">java.util.Date</code> object in a
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> column would not be
        serialized correctly during <code class="literal">setObject</code>.
       (Bug #25787)</p></li><li><p>
        Timer instance used for
        <code class="literal">Statement.setQueryTimeout()</code> created
        per-connection, rather than per-VM, causing memory leak.
       (Bug #25514)</p></li><li><p>
        <code class="literal">EscapeProcessor</code> gets confused by multiple
        backslashes. We now push the responsibility of syntax errors
        back on to the server for most escape sequences.
       (Bug #25399)</p></li><li><p>
        <code class="literal">INOUT</code> parameters in
        <code class="literal">CallableStatements</code> get doubly-escaped.
       (Bug #25379)</p></li><li><p>
        When using the <code class="literal">rewriteBatchedStatements</code>
        connection option with
        <code class="literal">PreparedState.executeBatch()</code> an internal
        memory leak would occur.
       (Bug #25073)</p></li><li><p>
        Fixed issue where field-level for metadata from
        <code class="literal">DatabaseMetaData</code> when using
        <code class="literal">INFORMATION_SCHEMA</code> didn't have references to
        current connections, sometimes leading to Null Pointer
        Exceptions (NPEs) when introspecting them using
        <code class="literal">ResultSetMetaData</code>.
       (Bug #25073)</p></li><li><p>
        <code class="literal">StringUtils.indexOfIgnoreCaseRespectQuotes()</code>
        isn't case-insensitive on the first character of the target.
        This bug also affected
        <code class="literal">rewriteBatchedStatements</code> functionality when
        prepared statements did not use uppercase for the
        <code class="literal">VALUES</code> clause.
       (Bug #25047)</p></li><li><p>
        Client-side prepared statement parser gets confused by in-line
        comments <code class="literal">/*...*/</code> and therefore cannot rewrite
        batch statements or reliably detect the type of statements when
        they are used.
       (Bug #25025)</p></li><li><p>
        Results sets from <a href="http://dev.mysql.com/doc/refman/5.5/en/update.html" target="_top"><code class="literal">UPDATE</code></a>
        statements that are part of multi-statement queries would cause
        an <code class="literal">SQLException</code> error, "Result is from
        UPDATE".
       (Bug #25009)</p></li><li><p>
        Specifying <code class="literal">US-ASCII</code> as the character set in a
        connection to a MySQL 4.1 or newer server does not map
        correctly.
       (Bug #24840)</p></li><li><p>
        Using <code class="literal">DatabaseMetaData.getSQLKeywords()</code> does
        not return a all of the of the reserved keywords for the current
        MySQL version. Current implementation returns the list of
        reserved words for MySQL 5.1, and does not distinguish between
        versions.
       (Bug #24794)</p></li><li><p>
        Calling <code class="literal">Statement.cancel()</code> could result in a
        Null Pointer Exception (NPE).
       (Bug #24721)</p></li><li><p>
        Using <code class="literal">setFetchSize()</code> breaks prepared
        <a href="http://dev.mysql.com/doc/refman/5.5/en/show.html" target="_top"><code class="literal">SHOW</code></a> and other commands.
       (Bug #24360)</p></li><li><p>
        Calendars and timezones are now lazily instantiated when
        required.
       (Bug #24351)</p></li><li><p>
        Using <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATETIME</code></a> columns would
        result in time shifts when <code class="literal">useServerPrepStmts</code>
        was true. This occurred due to different behavior when using
        client-side compared to server-side prepared statements and the
        <code class="literal">useJDBCCompliantTimezoneShift</code> option. This is
        now fixed if moving from server-side prepared statements to
        client-side prepared statements by setting
        <code class="literal">useSSPSCompatibleTimezoneShift</code> to
        <code class="literal">true</code>, as the driver can't tell if this is a
        new deployment that never used server-side prepared statements,
        or if it is an existing deployment that is switching to
        client-side prepared statements from server-side prepared
        statements.
       (Bug #24344)</p></li><li><p>
        Connector/J now returns a better error message when server
        doesn't return enough information to determine stored
        procedure/function parameter types.
       (Bug #24065)</p></li><li><p>
        A connection error would occur when connecting to a MySQL server
        with certain character sets. Some collations/character sets
        reported as "unknown" (specifically <code class="literal">cias</code>
        variants of existing character sets), and inability to override
        the detected server character set.
       (Bug #23645)</p></li><li><p>
        Inconsistency between <code class="literal">getSchemas</code> and
        <code class="literal">INFORMATION_SCHEMA</code>.
       (Bug #23304)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getSchemas()</code> doesn't return
        a <code class="literal">TABLE_CATALOG</code> column.
       (Bug #23303)</p></li><li><p>
        When using a JDBC connection URL that is malformed, the
        <code class="literal">NonRegisteringDriver.getPropertyInfo</code> method
        will throw a Null Pointer Exception (NPE).
       (Bug #22628)</p></li><li><p>
        Some exceptions thrown out of
        <code class="literal">StandardSocketFactory</code> were needlessly
        wrapped, obscuring their true cause, especially when using
        socket timeouts.
       (Bug #21480)</p></li><li><p>
        When using a server-side prepared statement the driver would
        send timestamps to the server using nanoseconds instead of
        milliseconds.
       (Bug #21438)</p></li><li><p>
        When using server-side prepared statements and timestamp
        columns, value would be incorrectly populated (with nanoseconds,
        not microseconds).
       (Bug #21438)</p></li><li><p>
        <code class="literal">ParameterMetaData</code> throws
        <code class="literal">NullPointerException</code> when prepared SQL has a
        syntax error. Added
        <code class="literal">generateSimpleParameterMetadata</code> configuration
        property, which when set to <code class="literal">true</code> will
        generate metadata reflecting
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">VARCHAR</code></a> for every parameter (the
        default is <code class="literal">false</code>, which will cause an
        exception to be thrown if no parameter metadata for the
        statement is actually available).
       (Bug #21267)</p></li><li><p>
        Fixed an issue where <code class="literal">XADataSources</code> couldn't
        be bound into JNDI, as the <code class="literal">DataSourceFactory</code>
        didn't know how to create instances of them.
      </p></li></ul></div><p><span class="bold"><strong>Other changes:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Avoid static synchronized code in JVM class libraries for
        dealing with default timezones.
      </p></li><li><p>
        Performance enhancement of initial character set configuration,
        driver will only send commands required to configure connection
        character set session variables if the current values on the
        server do not match what is required.
      </p></li><li><p>
        Re-worked stored procedure parameter parser to be more robust.
        Driver no longer requires <code class="literal">BEGIN</code> in stored
        procedure definition, but does have requirement that if a stored
        function begins with a label directly after the "returns"
        clause, that the label is not a quoted identifier.
      </p></li><li><p>
        Throw exceptions encountered during timeout to thread calling
        <code class="literal">Statement.execute*()</code>, rather than
        <code class="literal">RuntimeException</code>.
      </p></li><li><p>
        Changed cached result set metadata (when using
        <code class="literal">cacheResultSetMetadata=true</code>) to be cached
        per-connection rather than per-statement as previously
        implemented.
      </p></li><li><p>
        Reverted back to internal character conversion routines for
        single-byte character sets, as the ones internal to the JVM are
        using much more CPU time than our internal implementation.
      </p></li><li><p>
        When extracting foreign key information from
        <a href="http://dev.mysql.com/doc/refman/5.5/en/show-create-table.html" target="_top"><code class="literal">SHOW CREATE TABLE</code></a> in
        <code class="literal">DatabaseMetaData</code>, ignore exceptions relating
        to tables being missing (which could happen for cross-reference
        or imported-key requests, as the list of tables is generated
        first, then iterated).
      </p></li><li><p>
        Fixed some Null Pointer Exceptions (NPEs) when cached metadata
        was used with <code class="literal">UpdatableResultSets</code>.
      </p></li><li><p>
        Take <code class="literal">localSocketAddress</code> property into account
        when creating instances of
        <code class="literal">CommunicationsException</code> when the underlying
        exception is a <code class="literal">java.net.BindException</code>, so
        that a friendlier error message is given with a little internal
        diagnostics.
      </p></li><li><p>
        Fixed cases where <code class="literal">ServerPreparedStatements</code>
        weren't using cached metadata when
        <code class="literal">cacheResultSetMetadata=true</code> was used.
      </p></li><li><p>
        Use a <code class="literal">java.util.TreeMap</code> to map column names
        to ordinal indexes for <code class="literal">ResultSet.findColumn()</code>
        instead of a HashMap. This enables us to have case-insensitive
        lookups (required by the JDBC specification) without resorting
        to the many transient object instances needed to support this
        requirement with a normal <code class="literal">HashMap</code> with either
        case-adjusted keys, or case-insensitive keys. (In the worst case
        scenario for lookups of a 1000 column result set, TreeMaps are
        about half as fast wall-clock time as a HashMap, however in
        normal applications their use gives many orders of magnitude
        reduction in transient object instance creation which pays off
        later for CPU usage in garbage collection).
      </p></li><li><p>
        When using cached metadata, skip field-level metadata packets
        coming from the server, rather than reading them and discarding
        them without creating <code class="literal">com.mysql.jdbc.Field</code>
        instances.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-4"></a>A.2.5. Changes in MySQL Connector/J 5.0.4 (20 October 2006)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        DBMD.getColumns() does not return expected COLUMN_SIZE for the
        SET type, now returns length of largest possible set
        disregarding whitespace or the "," delimitters to be consistent
        with the ODBC driver.
       (Bug #22613)</p></li><li><p>
        Added new _ci collations to CharsetMapping - utf8_unicode_ci not
        working.
       (Bug #22456)</p></li><li><p>
        Driver was using milliseconds for Statement.setQueryTimeout()
        when specification says argument is to be in seconds.
       (Bug #22359)</p></li><li><p>
        Workaround for server crash when calling stored procedures using
        a server-side prepared statement (driver now detects
        prepare(stored procedure) and substitutes client-side prepared
        statement).
       (Bug #22297)</p></li><li><p>
        Driver issues truncation on write exception when it shouldn't
        (due to sending big decimal incorrectly to server with
        server-side prepared statement).
       (Bug #22290)</p></li><li><p>
        Newlines causing whitespace to span confuse procedure parser
        when getting parameter metadata for stored procedures.
       (Bug #22024)</p></li><li><p>
        When using information_schema for metadata, COLUMN_SIZE for
        getColumns() is not clamped to range of java.lang.Integer as is
        the case when not using information_schema, thus leading to a
        truncation exception that isn't present when not using
        information_schema.
       (Bug #21544)</p></li><li><p>
        Column names don't match metadata in cases where server doesn't
        return original column names (column functions) thus breaking
        compatibility with applications that expect 1-to-1 mappings
        between <code class="literal">findColumn()</code> and
        <code class="literal">rsmd.getColumnName()</code>, usually manifests
        itself as "Can't find column ('')" exceptions.
       (Bug #21379)</p></li><li><p>
        Driver now sends numeric 1 or 0 for client-prepared statement
        <code class="literal">setBoolean()</code> calls instead of '1' or '0'.
      </p></li><li><p>
        Fixed configuration property
        <code class="literal">jdbcCompliantTruncation</code> was not being used
        for reads of result set values.
      </p></li><li><p>
        DatabaseMetaData correctly reports <code class="literal">true</code> for
        <code class="literal">supportsCatalog*()</code> methods.
      </p></li><li><p>
        Driver now supports <code class="literal">{call sp}</code> (without "()"
        if procedure has no arguments).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-3"></a>A.2.6. Changes in MySQL Connector/J 5.0.3 (26 July 2006 beta)</h3></div></div></div><p><span class="bold"><strong>Functionality added or changed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Added configuration option
        <code class="literal">noAccessToProcedureBodies</code> which will cause
        the driver to create basic parameter metadata for
        <code class="literal">CallableStatements</code> when the user does not
        have access to procedure bodies using <a href="http://dev.mysql.com/doc/refman/5.5/en/show-create-procedure.html" target="_top"><code class="literal">SHOW
        CREATE PROCEDURE</code></a> or selecting from
        <code class="literal">mysql.proc</code> instead of throwing an exception.
        The default value for this option is <code class="literal">false</code>
      </p></li></ul></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed <code class="literal">Statement.cancel()</code> causes
        <code class="literal">NullPointerException</code> if underlying connection
        has been closed due to server failure.
       (Bug #20650)</p></li><li><p>
        If the connection to the server has been closed due to a server
        failure, then the cleanup process will call <code class="literal">
        Statement.cancel()</code>, triggering a
        <code class="literal">NullPointerException</code>, even though there is no
        active connection.
       (Bug #20650)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-2"></a>A.2.7. Changes in MySQL Connector/J 5.0.2 (11 July 2006)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">MysqlXaConnection.recover(int flags)</code> now
        permits combinations of
        <code class="literal">XAResource.TMSTARTRSCAN</code> and
        <code class="literal">TMENDRSCAN</code>. To simulate the
        “<span class="quote">scanning</span>” nature of the interface, we return all
        prepared XIDs for <code class="literal">TMSTARTRSCAN</code>, and no new
        XIDs for calls with <code class="literal">TMNOFLAGS</code>, or
        <code class="literal">TMENDRSCAN</code> when not in combination with
        <code class="literal">TMSTARTRSCAN</code>. This change was made for API
        compliance, as well as integration with IBM WebSphere's
        transaction manager.
       (Bug #20242)</p></li><li><p>
        Fixed <code class="literal">MysqlValidConnectionChecker</code> for JBoss
        doesn't work with <code class="literal">MySQLXADataSources</code>.
       (Bug #20242)</p></li><li><p>
        Added connection/datasource property
        <code class="literal">pinGlobalTxToPhysicalConnection</code> (defaults to
        <code class="literal">false</code>). When set to <code class="literal">true</code>,
        when using <code class="literal">XAConnections</code>, the driver ensures
        that operations on a given XID are always routed to the same
        physical connection. This enables the
        <code class="literal">XAConnection</code> to support <code class="literal">XA START ...
        JOIN</code> after
        <a href="http://dev.mysql.com/doc/refman/5.5/en/xa-statements.html" target="_top"><code class="literal">XA END</code></a>
        has been called, and is also a workaround for transaction
        managers that don't maintain thread affinity for a global
        transaction (most either always maintain thread affinity, or
        have it as a configuration option).
       (Bug #20242)</p></li><li><p>
        Better caching of character set converters (per-connection) to
        remove a bottleneck for multibyte character sets.
       (Bug #20242)</p></li><li><p>
        Fixed <code class="literal">ConnectionProperties</code> (and thus some
        subclasses) are not serializable, even though some J2EE
        containers expect them to be.
       (Bug #19169)</p></li><li><p>
        Fixed driver fails on non-ASCII platforms. The driver was
        assuming that the platform character set would be a superset of
        MySQL's <code class="literal">latin1</code> when doing the handshake for
        authentication, and when reading error messages. We now use
        Cp1252 for all strings sent to the server during the handshake
        phase, and a hard-coded mapping of the
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_language" target="_top"><code class="literal">language</code></a> system variable to the
        character set that is used for error messages.
       (Bug #18086)</p></li><li><p>
        Fixed can't use <code class="literal">XAConnection</code> for local
        transactions when no global transaction is in progress.
       (Bug #17401)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-1"></a>A.2.8. Changes in MySQL Connector/J 5.0.1 (Not Released)</h3></div></div></div><p>
        Not released due to a packaging error
      </p><p>This section has no changelog entries.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-5-0-0"></a>A.2.9. Changes in MySQL Connector/J 5.0.0 (22 December 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Added support for Connector/MXJ integration using url
        subprotocol <code class="literal">jdbc:mysql:mxj://...</code>.
       (Bug #14729)</p></li><li><p>
        Idle timeouts cause <code class="literal">XAConnections</code> to whine
        about rolling themselves back.
       (Bug #14729)</p></li><li><p>
        When fix for Bug#14562 was merged from 3.1.12, added
        functionality for <code class="literal">CallableStatement</code>'s
        parameter metadata to return correct information for
        <code class="literal">.getParameterClassName()</code>.
       (Bug #14729)</p></li><li><p>
        Added service-provider entry to
        <code class="filename">META-INF/services/java.sql.Driver</code> for
        JDBC-4.0 support.
       (Bug #14729)</p></li><li><p>
        Fuller synchronization of <code class="literal">Connection</code> to avoid
        deadlocks when using multithreaded frameworks that multithread a
        single connection (usually not recommended, but the JDBC spec
        permits it anyways), part of fix to Bug#14972).
       (Bug #14729)</p></li><li><p>
        Moved all <code class="literal">SQLException</code> constructor usage to a
        factory in <code class="literal">SQLError</code> (ground-work for JDBC-4.0
        <code class="literal">SQLState</code>-based exception classes).
       (Bug #14729)</p></li><li><p>
        Removed Java5-specific calls to <code class="literal">BigDecimal</code>
        constructor (when result set value is <code class="literal">''</code>,
        <code class="literal">(int)0</code> was being used as an argument
        indirectly using method return value. This signature doesn't
        exist prior to Java5.)
       (Bug #14729)</p></li><li><p>
        Implementation of <code class="literal">Statement.cancel()</code> and
        <code class="literal">Statement.setQueryTimeout()</code>. Both require
        MySQL-5.0.0 or newer server, require a separate connection to
        issue the <a href="http://dev.mysql.com/doc/refman/5.5/en/kill.html" target="_top"><code class="literal">KILL
        QUERY</code></a> statement, and in the case of
        <code class="literal">setQueryTimeout()</code> creates an additional
        thread to handle the timeout functionality.
      </p><p>
        Note: Failures to cancel the statement for
        <code class="literal">setQueryTimeout()</code> may manifest themselves as
        <code class="literal">RuntimeExceptions</code> rather than failing
        silently, as there is currently no way to unblock the thread
        that is executing the query being cancelled due to timeout
        expiration and have it throw the exception instead.
       (Bug #14729)</p></li><li><p>
        Return "[VAR]BINARY" for
        <code class="literal">RSMD.getColumnTypeName()</code> when that is
        actually the type, and it can be distinguished (MySQL-4.1 and
        newer).
       (Bug #14729)</p></li><li><p>
        Attempt detection of the MySQL type
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">BINARY</code></a> (it is an alias, so this
        isn't always reliable), and use the
        <code class="literal">java.sql.Types.BINARY</code> type mapping for it.
      </p></li><li><p>
        Added unit tests for <code class="literal">XADatasource</code>, as well as
        friendlier exceptions for XA failures compared to the "stock"
        <code class="literal">XAException</code> (which has no messages).
      </p></li><li><p>
        If the connection <code class="literal">useTimezone</code> is set to
        <code class="literal">true</code>, then also respect time zone conversions
        in escape-processed string literals (for example, <code class="literal">"{ts
        ...}"</code> and <code class="literal">"{t ...}"</code>).
      </p></li><li><p>
        Do not permit <code class="literal">.setAutoCommit(true)</code>, or
        <code class="literal">.commit()</code> or <code class="literal">.rollback()</code>
        on an XA-managed connection as per the JDBC specification.
      </p></li><li><p>
        <code class="literal">XADataSource</code> implemented (ported from 3.2
        branch which won't be released as a product). Use
        <code class="literal">com.mysql.jdbc.jdbc2.optional.MysqlXADataSource</code>
        as your datasource class name in your application server to
        utilize XA transactions in MySQL-5.0.10 and newer.
      </p></li><li><p>
        Moved <code class="filename">-bin-g.jar</code> file into separate
        <code class="filename">debug</code> subdirectory to avoid confusion.
      </p></li><li><p>
        Return original column name for
        <code class="literal">RSMD.getColumnName()</code> if the column was
        aliased, alias name for <code class="literal">.getColumnLabel()</code> (if
        aliased), and original table name for
        <code class="literal">.getTableName()</code>. Note this only works for
        MySQL-4.1 and newer, as older servers don't make this
        information available to clients.
      </p></li><li><p>
        Setting <code class="literal">useJDBCCompliantTimezoneShift=true</code>
        (it is not the default) causes the driver to use GMT for
        <span class="emphasis"><em>all</em></span>
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATETIME</code></a>
        time zones, and the current VM time zone for any other type that
        refers to time zones. This feature can not be used when
        <code class="literal">useTimezone=true</code> to convert between server
        and client time zones.
      </p></li><li><p>
        <code class="literal">PreparedStatement.setString()</code> didn't work
        correctly when <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_sql_mode" target="_top"><code class="literal">sql_mode</code></a> on
        server contained
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-sql-mode.html#sqlmode_no_backslash_escapes" target="_top"><code class="literal">NO_BACKSLASH_ESCAPES</code></a> and no
        characters that needed escaping were present in the string.
      </p></li><li><p>
        Add one level of indirection of internal representation of
        <code class="literal">CallableStatement</code> parameter metadata to avoid
        class not found issues on JDK-1.3 for
        <code class="literal">ParameterMetadata</code> interface (which doesn't
        exist prior to JDBC-3.0).
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cg-news-3-1"></a>A.3. Changes in MySQL Connector/J 3.1.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-3-1-15">A.3.1. Changes in MySQL Connector/J 3.1.15 (Not yet released)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-14">A.3.2. Changes in MySQL Connector/J 3.1.14 (19 October 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-13">A.3.3. Changes in MySQL Connector/J 3.1.13 (26 May 2006)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-12">A.3.4. Changes in MySQL Connector/J 3.1.12 (30 November 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-11">A.3.5. Changes in MySQL Connector/J 3.1.11 (07 October 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-10">A.3.6. Changes in MySQL Connector/J 3.1.10 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-9">A.3.7. Changes in MySQL Connector/J 3.1.9 (22 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-8">A.3.8. Changes in MySQL Connector/J 3.1.8 (14 April 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-7">A.3.9. Changes in MySQL Connector/J 3.1.7 (18 February 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-6">A.3.10. Changes in MySQL Connector/J 3.1.6 (23 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-5">A.3.11. Changes in MySQL Connector/J 3.1.5 (02 December 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-4">A.3.12. Changes in MySQL Connector/J 3.1.4 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-3">A.3.13. Changes in MySQL Connector/J 3.1.3 (07 July 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-2">A.3.14. Changes in MySQL Connector/J 3.1.2 (09 June 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-1">A.3.15. Changes in MySQL Connector/J 3.1.1 (14 February 2004 alpha)</a></span></dt><dt><span class="section"><a href="#cj-news-3-1-0">A.3.16. Changes in MySQL Connector/J 3.1.0 (18 February 2003 alpha)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-15"></a>A.3.1. Changes in MySQL Connector/J 3.1.15 (Not yet released)</h3></div></div></div><p>
        <span class="bold"><strong>Important change:</strong></span> Due to a
        number of issues with the use of server-side prepared
        statements, Connector/J 5.0.5 has disabled their use by default.
        The disabling of server-side prepared statements does not affect
        the operation of the connector in any way.
      </p><p>
        To enable server-side prepared statements you must add the
        following configuration property to your connector string:
      </p><pre class="programlisting">useServerPrepStmts=true</pre><p>
        The default value of this property is <code class="literal">false</code>
        (that is, Connector/J does not use server-side prepared
        statements).
      </p><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Specifying <code class="literal">US-ASCII</code> as the character set in a
        connection to a MySQL 4.1 or newer server does not map
        correctly.
       (Bug #24840)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-14"></a>A.3.2. Changes in MySQL Connector/J 3.1.14 (19 October 2006)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Check and store value for continueBatchOnError property in
        constructor of Statements, rather than when executing batches,
        so that Connections closed out from underneath statements don't
        cause NullPointerExceptions when it is required to check this
        property.
       (Bug #22290)</p></li><li><p>
        Fixed BUG#18258 - DatabaseMetaData.getTables(), columns() with
        bad catalog parameter threw exception rather than return empty
        result set (as required by spec).
       (Bug #22290)</p></li><li><p>
        Driver now sends numeric 1 or 0 for client-prepared statement
        setBoolean() calls instead of '1' or '0'.
       (Bug #22290)</p></li><li><p>
        Fixed bug where driver would not advance to next host if
        roundRobinLoadBalance=true and the last host in the list is
        down.
       (Bug #22290)</p></li><li><p>
        Driver issues truncation on write exception when it shouldn't
        (due to sending big decimal incorrectly to server with
        server-side prepared statement).
       (Bug #22290)</p></li><li><p>
        Fixed bug when calling stored functions, where parameters
        weren't numbered correctly (first parameter is now the return
        value, subsequent parameters if specified start at index "2").
       (Bug #22290)</p></li><li><p>
        Removed logger autodetection altogether, must now specify logger
        explicitly if you want to use a logger other than one that logs
        to STDERR.
       (Bug #21207)</p></li><li><p>
        DDriver throws NPE when tracing prepared statements that have
        been closed (in asSQL()).
       (Bug #21207)</p></li><li><p>
        ResultSet.getSomeInteger() doesn't work for BIT(&gt;1).
       (Bug #21062)</p></li><li><p>
        Escape of quotation marks in client-side prepared statements
        parsing not respected. Patch covers more than bug report,
        including NO_BACKSLASH_ESCAPES being set, and stacked quote
        characters forms of escaping (that is, '' or "").
       (Bug #20888)</p></li><li><p>
        Fixed can't pool server-side prepared statements, exception
        raised when re-using them.
       (Bug #20687)</p></li><li><p>
        Fixed Updatable result set that contains a BIT column fails when
        server-side prepared statements are used.
       (Bug #20485)</p></li><li><p>
        Fixed updatable result set throws ClassCastException when there
        is row data and moveToInsertRow() is called.
       (Bug #20479)</p></li><li><p>
        Fixed ResultSet.getShort() for UNSIGNED TINYINT returns
        incorrect values when using server-side prepared statements.
       (Bug #20306)</p></li><li><p>
        ReplicationDriver does not always round-robin load balance
        depending on URL used for slaves list.
       (Bug #19993)</p></li><li><p>
        Fixed calling toString() on ResultSetMetaData for
        driver-generated (that is, from DatabaseMetaData method calls,
        or from getGeneratedKeys()) result sets would raise a
        NullPointerException.
       (Bug #19993)</p></li><li><p>
        Connection fails to localhost when using timeout and IPv6 is
        configured.
       (Bug #19726)</p></li><li><p>
        ResultSet.getFloatFromString() can't retrieve values near
        Float.MIN/MAX_VALUE.
       (Bug #18880)</p></li><li><p>
        Fixed memory leak with profileSQL=true.
       (Bug #16987)</p></li><li><p>
        Fixed NullPointerException in MysqlDataSourceFactory due to
        Reference containing RefAddrs with null content.
       (Bug #16791)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-13"></a>A.3.3. Changes in MySQL Connector/J 3.1.13 (26 May 2006)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">Fixed PreparedStatement.setObject(int, Object,
        int)</code> doesn't respect scale of BigDecimals.
       (Bug #19615)</p></li><li><p>
        Fixed <code class="literal">ResultSet.wasNull()</code> returns incorrect
        value when extracting native string from server-side prepared
        statement generated result set.
       (Bug #19282)</p></li><li><p>
        Fixed invalid classname returned for
        <code class="literal">ResultSetMetaData.getColumnClassName()</code> for
        <code class="literal">BIGINT type</code>.
       (Bug #19282)</p></li><li><p>
        Fixed case where driver wasn't reading server status correctly
        when fetching server-side prepared statement rows, which in some
        cases could cause warning counts to be off, or multiple result
        sets to not be read off the wire.
       (Bug #19282)</p></li><li><p>
        Fixed data truncation and <code class="literal">getWarnings()</code> only
        returns last warning in set.
       (Bug #18740)</p></li><li><p>
        Fixed aliased column names where length of name &gt; 251 are
        corrupted.
       (Bug #18554)</p></li><li><p>
        Improved performance of retrieving
        <code class="literal">BigDecimal</code>, <code class="literal">Time</code>,
        <code class="literal">Timestamp</code> and <code class="literal">Date</code> values
        from server-side prepared statements by creating fewer
        short-lived instances of <code class="literal">Strings</code> when the
        native type is not an exact match for the requested type.
       (Bug #18496)</p></li><li><p>
        Added performance feature, re-writing of batched executes for
        <code class="literal">Statement.executeBatch()</code> (for all DML
        statements) and
        <code class="literal">PreparedStatement.executeBatch()</code> (for INSERTs
        with VALUE clauses only). Enable by using
        "rewriteBatchedStatements=true" in your JDBC URL.
       (Bug #18041)</p></li><li><p>
        Fixed issue where server-side prepared statements don't cause
        truncation exceptions to be thrown when truncation happens.
       (Bug #18041)</p></li><li><p>
        Fixed
        <code class="literal">CallableStatement.registerOutParameter()</code> not
        working when some parameters pre-populated. Still waiting for
        feedback from JDBC experts group to determine what correct
        parameter count from <code class="literal">getMetaData()</code> should be,
        however.
       (Bug #17898)</p></li><li><p>
        Fixed calling <code class="literal">clearParameters()</code> on a closed
        prepared statement causes NPE.
       (Bug #17587)</p></li><li><p>
        Map "latin1" on MySQL server to CP1252 for MySQL &gt; 4.1.0.
       (Bug #17587)</p></li><li><p>
        Added additional accessor and mutator methods on
        ConnectionProperties so that DataSource users can use same
        naming as regular URL properties.
       (Bug #17587)</p></li><li><p>
        Fixed <code class="literal">ResultSet.wasNull()</code> not always reset
        correctly for booleans when done using conversion for
        server-side prepared statements.
       (Bug #17450)</p></li><li><p>
        Fixed <code class="literal">Statement.getGeneratedKeys()</code> throws
        <code class="literal">NullPointerException</code> when no query has been
        processed.
       (Bug #17099)</p></li><li><p>
        Fixed updatable result set doesn't return
        <code class="literal">AUTO_INCREMENT</code> values for
        <code class="literal">insertRow()</code> when multiple column primary keys
        are used. (the driver was checking for the existence of
        single-column primary keys and an autoincrement value &gt; 0
        instead of a straightforward
        <code class="literal">isAutoIncrement()</code> check).
       (Bug #16841)</p></li><li><p>
        <code class="literal">DBMD.getColumns()</code> returns wrong type for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a>.
       (Bug #15854)</p></li><li><p>
        <code class="filename">lib-nodist</code> directory missing from package
        breaks out-of-box build.
       (Bug #15676)</p></li><li><p>
        Fixed issue with <code class="literal">ReplicationConnection</code>
        incorrectly copying state, doesn't transfer connection context
        correctly when transitioning between the same read-only states.
       (Bug #15570)</p></li><li><p>
        No "dos" character set in MySQL &gt; 4.1.0.
       (Bug #15544)</p></li><li><p>
        <code class="literal">INOUT</code> parameter does not store
        <code class="literal">IN</code> value.
       (Bug #15464)</p></li><li><p>
        <code class="literal">PreparedStatement.setObject()</code> serializes
        <code class="literal">BigInteger</code> as object, rather than sending as
        numeric value (and is thus not complementary to
        <code class="literal">.getObject()</code> on an <code class="literal">UNSIGNED
        LONG</code> type).
       (Bug #15383)</p></li><li><p>
        Fixed issue where driver was unable to initialize character set
        mapping tables. Removed reliance on
        <code class="literal">.properties</code> files to hold this information,
        as it turns out to be too problematic to code around class
        loader hierarchies that change depending on how an application
        is deployed. Moved information back into the
        <code class="literal">CharsetMapping</code> class.
       (Bug #14938)</p></li><li><p>
        Exception thrown for new decimal type when using updatable
        result sets.
       (Bug #14609)</p></li><li><p>
        Driver now aware of fix for <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a>
        type metadata that went into MySQL-5.0.21 for server not
        reporting length consistently .
       (Bug #13601)</p></li><li><p>
        Added support for Apache Commons logging, use
        "com.mysql.jdbc.log.CommonsLogger" as the value for the "logger"
        configuration property.
       (Bug #13469)</p></li><li><p>
        Fixed driver trying to call methods that don't exist on older
        and newer versions of Log4j. The fix is not trying to
        auto-detect presence of log4j, too many different incompatible
        versions out there in the wild to do this reliably.
      </p><p>
        If you relied on autodetection before, you will need to add
        "logger=com.mysql.jdbc.log.Log4JLogger" to your JDBC URL to
        enable Log4J usage, or alternatively use the new "CommonsLogger"
        class to take care of this.
       (Bug #13469)</p></li><li><p>
        LogFactory now prepends <code class="literal">com.mysql.jdbc.log</code> to
        the log class name if it cannot be found as specified. This
        enables you to use “<span class="quote">short names</span>” for the built-in
        log factories, for example,
        <code class="literal">logger=CommonsLogger</code> instead of
        <code class="literal">logger=com.mysql.jdbc.log.CommonsLogger</code>.
       (Bug #13469)</p></li><li><p>
        <code class="literal">ResultSet.getShort()</code> for <code class="literal">UNSIGNED
        TINYINT</code> returned wrong values.
       (Bug #11874)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-12"></a>A.3.4. Changes in MySQL Connector/J 3.1.12 (30 November 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Process escape tokens in
        <code class="literal">Connection.prepareStatement(...)</code>. You can
        disable this behavior by setting the JDBC URL configuration
        property <code class="literal">processEscapeCodesForPrepStmts</code> to
        <code class="literal">false</code>.
       (Bug #15141)</p></li><li><p>
        Usage advisor complains about unreferenced columns, even though
        they've been referenced.
       (Bug #15065)</p></li><li><p>
        Driver incorrectly closes streams passed as arguments to
        <code class="literal">PreparedStatements</code>. Reverts to legacy
        behavior by setting the JDBC configuration property
        <code class="literal">autoClosePStmtStreams</code> to
        <code class="literal">true</code> (also included in the 3-0-Compat
        configuration “<span class="quote">bundle</span>”).
       (Bug #15024)</p></li><li><p>
        Deadlock while closing server-side prepared statements from
        multiple threads sharing one connection.
       (Bug #14972)</p></li><li><p>
        Unable to initialize character set mapping tables (due to J2EE
        classloader differences).
       (Bug #14938)</p></li><li><p>
        Escape processor replaces quote character in quoted string with
        string delimiter.
       (Bug #14909)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> doesn't return
        <code class="literal">TABLE_NAME</code> correctly.
       (Bug #14815)</p></li><li><p>
        <code class="literal">storesMixedCaseIdentifiers()</code> returns
        <code class="literal">false</code>
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesLowerCaseIdentifiers()</code> returns
        <code class="literal">true</code>
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesMixedCaseQuotedIdentifiers()</code> returns
        <code class="literal">false</code>
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesMixedCaseQuotedIdentifiers()</code> returns
        <code class="literal">true</code>
       (Bug #14562)</p></li><li><p>
        If <code class="literal">lower_case_table_names=0</code> (on server):
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">storesLowerCaseIdentifiers()</code> returns
            <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesLowerCaseQuotedIdentifiers()</code>
            returns <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesMixedCaseIdentifiers()</code> returns
            <code class="literal">true</code>
          </p></li><li><p>
            <code class="literal">storesMixedCaseQuotedIdentifiers()</code>
            returns <code class="literal">true</code>
          </p></li><li><p>
            <code class="literal">storesUpperCaseIdentifiers()</code> returns
            <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesUpperCaseQuotedIdentifiers()</code>
            returns <code class="literal">true</code>
          </p></li></ul></div><p>(Bug #14562)</p></li><li><p>
        <code class="literal">storesUpperCaseIdentifiers()</code> returns
        <code class="literal">false</code>
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesUpperCaseQuotedIdentifiers()</code> returns
        <code class="literal">true</code>
       (Bug #14562)</p></li><li><p>
        If <code class="literal">lower_case_table_names=1</code> (on server):
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">storesLowerCaseIdentifiers()</code> returns
            <code class="literal">true</code>
          </p></li><li><p>
            <code class="literal">storesLowerCaseQuotedIdentifiers()</code>
            returns <code class="literal">true</code>
          </p></li><li><p>
            <code class="literal">storesMixedCaseIdentifiers()</code> returns
            <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesMixedCaseQuotedIdentifiers()</code>
            returns <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesUpperCaseIdentifiers()</code> returns
            <code class="literal">false</code>
          </p></li><li><p>
            <code class="literal">storesUpperCaseQuotedIdentifiers()</code>
            returns <code class="literal">true</code>
          </p></li></ul></div><p>(Bug #14562)</p></li><li><p>
        <code class="literal">storesLowerCaseQuotedIdentifiers()</code> returns
        <code class="literal">true</code>
       (Bug #14562)</p></li><li><p>
        Fixed <code class="literal">DatabaseMetaData.stores*Identifiers()</code>:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            If <code class="literal">lower_case_table_names=0</code> (on server):
          </p><div class="itemizedlist"><ul type="square"><li><p>
                <code class="literal">storesLowerCaseIdentifiers()</code> returns
                <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesLowerCaseQuotedIdentifiers()</code>
                returns <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesMixedCaseIdentifiers()</code> returns
                <code class="literal">true</code>
              </p></li><li><p>
                <code class="literal">storesMixedCaseQuotedIdentifiers()</code>
                returns <code class="literal">true</code>
              </p></li><li><p>
                <code class="literal">storesUpperCaseIdentifiers()</code> returns
                <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesUpperCaseQuotedIdentifiers()</code>
                returns <code class="literal">true</code>
              </p></li></ul></div></li><li><p>
            If <code class="literal">lower_case_table_names=1</code> (on server):
          </p><div class="itemizedlist"><ul type="square"><li><p>
                <code class="literal">storesLowerCaseIdentifiers()</code> returns
                <code class="literal">true</code>
              </p></li><li><p>
                <code class="literal">storesLowerCaseQuotedIdentifiers()</code>
                returns <code class="literal">true</code>
              </p></li><li><p>
                <code class="literal">storesMixedCaseIdentifiers()</code> returns
                <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesMixedCaseQuotedIdentifiers()</code>
                returns <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesUpperCaseIdentifiers()</code> returns
                <code class="literal">false</code>
              </p></li><li><p>
                <code class="literal">storesUpperCaseQuotedIdentifiers()</code>
                returns <code class="literal">true</code>
              </p></li></ul></div></li></ul></div><p>(Bug #14562)</p></li><li><p>
        <code class="literal">storesMixedCaseIdentifiers()</code> returns
        <code class="literal">true</code>
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesLowerCaseQuotedIdentifiers()</code> returns
        <code class="literal">false</code>
       (Bug #14562)</p></li><li><p>
        Java type conversion may be incorrect for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">MEDIUMINT</code></a>.
       (Bug #14562)</p></li><li><p>
        <code class="literal">storesLowerCaseIdentifiers()</code> returns
        <code class="literal">false</code>
       (Bug #14562)</p></li><li><p>
        Added configuration property
        <code class="literal">useGmtMillisForDatetimes</code> which when set to
        <code class="literal">true</code> causes
        <code class="literal">ResultSet.getDate()</code>,
        <code class="literal">.getTimestamp()</code> to return correct
        millis-since GMT when <code class="literal">.getTime()</code> is called on
        the return value (currently default is <code class="literal">false</code>
        for legacy behavior).
       (Bug #14562)</p></li><li><p>
        Extraneous sleep on <code class="literal">autoReconnect</code>.
       (Bug #13775)</p></li><li><p>
        Reconnect during middle of <code class="literal">executeBatch()</code>
        should not occur if <code class="literal">autoReconnect</code> is enabled.
       (Bug #13255)</p></li><li><p>
        <code class="literal">maxQuerySizeToLog</code> is not respected. Added
        logging of bound values for <code class="literal">execute()</code> phase
        of server-side prepared statements when
        <code class="literal">profileSQL=true</code> as well.
       (Bug #13048)</p></li><li><p>
        OpenOffice expects
        <code class="literal">DBMD.supportsIntegrityEnhancementFacility()</code>
        to return <code class="literal">true</code> if foreign keys are supported
        by the datasource, even though this method also covers support
        for check constraints, which MySQL <span class="emphasis"><em>doesn't</em></span>
        have. Setting the configuration property
        <code class="literal">overrideSupportsIntegrityEnhancementFacility</code>
        to <code class="literal">true</code> causes the driver to return
        <code class="literal">true</code> for this method.
       (Bug #12975)</p></li><li><p>
        Added <code class="literal">com.mysql.jdbc.testsuite.url.default</code>
        system property to set default JDBC url for testsuite (to speed
        up bug resolution when I'm working in Eclipse).
       (Bug #12975)</p></li><li><p>
        <code class="literal">logSlowQueries</code> should give better info.
       (Bug #12230)</p></li><li><p>
        Don't increase timeout for failover/reconnect.
       (Bug #6577)</p></li><li><p>
        Fixed client-side prepared statement bug with embedded
        <code class="literal">?</code> characters inside quoted identifiers (it
        was recognized as a placeholder, when it was not).
      </p></li><li><p>
        Do not permit <code class="literal">executeBatch()</code> for
        <code class="literal">CallableStatements</code> with registered
        <code class="literal">OUT</code>/<code class="literal">INOUT</code> parameters (JDBC
        compliance).
      </p></li><li><p>
        Fall back to platform-encoding for
        <code class="literal">URLDecoder.decode()</code> when parsing driver URL
        properties if the platform doesn't have a two-argument version
        of this method.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-11"></a>A.3.5. Changes in MySQL Connector/J 3.1.11 (07 October 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        The configuration property <code class="literal">sessionVariables</code>
        now permits you to specify variables that start with the
        “<span class="quote"><code class="literal">@</code></span>” sign.
       (Bug #13453)</p></li><li><p>
        URL configuration parameters do not permit
        “<span class="quote"><code class="literal">&amp;</code></span>” or
        “<span class="quote"><code class="literal">=</code></span>” in their values. The JDBC
        driver now parses configuration parameters as if they are
        encoded using the application/x-www-form-urlencoded format as
        specified by <code class="literal">java.net.URLDecoder</code>
        (<a href="http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLDecoder.html" target="_top">http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLDecoder.html</a>).
      </p><p>
        If the “<span class="quote"><code class="literal">%</code></span>” character is present
        in a configuration property, it must now be represented as
        <code class="literal">%25</code>, which is the encoded form of
        “<span class="quote"><code class="literal">%</code></span>” when using
        application/x-www-form-urlencoded encoding.
       (Bug #13453)</p></li><li><p>
        Workaround for Bug#13374:
        <code class="literal">ResultSet.getStatement()</code> on closed result set
        returns <code class="literal">NULL</code> (as per JDBC 4.0 spec, but not
        backward-compatible). Set the connection property
        <code class="literal">retainStatementAfterResultSetClose</code> to
        <code class="literal">true</code> to be able to retrieve a
        <code class="literal">ResultSet</code>'s statement after the
        <code class="literal">ResultSet</code> has been closed using
        <code class="literal">.getStatement()</code> (the default is
        <code class="literal">false</code>, to be JDBC-compliant and to reduce the
        chance that code using JDBC leaks <code class="literal">Statement</code>
        instances).
       (Bug #13277)</p></li><li><p>
        <code class="literal">ResultSetMetaData</code> from
        <code class="literal">Statement.getGeneratedKeys()</code> caused a
        <code class="literal">NullPointerException</code> to be thrown whenever a
        method that required a connection reference was called.
       (Bug #13277)</p></li><li><p>
        Backport of <code class="literal">VAR[BINARY|CHAR] [BINARY]</code> types
        detection from 5.0 branch.
       (Bug #13277)</p></li><li><p>
        Fixed <code class="literal">NullPointerException</code> when converting
        <code class="literal">catalog</code> parameter in many
        <code class="literal">DatabaseMetaDataMethods</code> to
        <code class="literal">byte[]</code>s (for the result set) when the
        parameter is <code class="literal">null</code>. (<code class="literal">null</code>
        is not technically permitted by the JDBC specification, but we
        have historically permitted it).
       (Bug #13277)</p></li><li><p>
        Backport of <code class="literal">Field</code> class,
        <code class="literal">ResultSetMetaData.getColumnClassName()</code>, and
        <code class="literal">ResultSet.getObject(int)</code> changes from 5.0
        branch to fix behavior surrounding <code class="literal">VARCHAR
        BINARY</code>/<a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> and
        related types.
       (Bug #13277)</p></li><li><p>
        Read response in <code class="literal">MysqlIO.sendFileToServer()</code>,
        even if the local file can't be opened, otherwise next query
        issued will fail, because it is reading the response to the
        empty <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA
        INFILE</code></a> packet sent to the server.
       (Bug #13277)</p></li><li><p>
        When <code class="literal">gatherPerfMetrics</code> is enabled for servers
        older than 4.1.0, a <code class="literal">NullPointerException</code> is
        thrown from the constructor of <code class="literal">ResultSet</code> if
        the query doesn't use any tables.
       (Bug #13043)</p></li><li><p>
        <code class="literal">java.sql.Types.OTHER</code> returned for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">BINARY</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> columns when using
        <code class="literal">DatabaseMetaData.getColumns()</code>.
       (Bug #12970)</p></li><li><p>
        <code class="literal">ServerPreparedStatement.getBinding()</code> now
        checks if the statement is closed before attempting to reference
        the list of parameter bindings, to avoid throwing a
        <code class="literal">NullPointerException</code>.
       (Bug #12970)</p></li><li><p>
        Tokenizer for <code class="literal">=</code> in URL properties was causing
        <code class="literal">sessionVariables=....</code> to be parameterized
        incorrectly.
       (Bug #12753)</p></li><li><p>
        <code class="literal">cp1251</code> incorrectly mapped to
        <code class="literal">win1251</code> for servers newer than 4.0.x.
       (Bug #12752)</p></li><li><p>
        <code class="literal">getExportedKeys()</code>
       (Bug #12541)</p></li><li><p>
        Specifying a catalog works as stated in the API docs.
       (Bug #12541)</p></li><li><p>
        Specifying <code class="literal">NULL</code> means that catalog will not
        be used to filter the results (thus all databases will be
        searched), unless you've set
        <code class="literal">nullCatalogMeansCurrent=true</code> in your JDBC URL
        properties.
       (Bug #12541)</p></li><li><p>
        <code class="literal">getIndexInfo()</code>
       (Bug #12541)</p></li><li><p>
        <code class="literal">getProcedures()</code> (and thus indirectly
        <code class="literal">getProcedureColumns()</code>)
       (Bug #12541)</p></li><li><p>
        <code class="literal">getImportedKeys()</code>
       (Bug #12541)</p></li><li><p>
        Specifying <code class="literal">""</code> means “<span class="quote">current</span>”
        catalog, even though this isn't quite JDBC spec compliant, it is
        there for legacy users.
       (Bug #12541)</p></li><li><p>
        <code class="literal">getCrossReference()</code>
       (Bug #12541)</p></li><li><p>
        Added <code class="literal">Connection.isMasterConnection()</code> for
        clients to be able to determine if a multi-host master/slave
        connection is connected to the first host in the list.
       (Bug #12541)</p></li><li><p>
        <code class="literal">getColumns()</code>
       (Bug #12541)</p></li><li><p>
        Handling of catalog argument in
        <code class="literal">DatabaseMetaData.getIndexInfo()</code>, which also
        means changes to the following methods in
        <code class="literal">DatabaseMetaData</code>:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">getBestRowIdentifier()</code>
          </p></li><li><p>
            <code class="literal">getColumns()</code>
          </p></li><li><p>
            <code class="literal">getCrossReference()</code>
          </p></li><li><p>
            <code class="literal">getExportedKeys()</code>
          </p></li><li><p>
            <code class="literal">getImportedKeys()</code>
          </p></li><li><p>
            <code class="literal">getIndexInfo()</code>
          </p></li><li><p>
            <code class="literal">getPrimaryKeys()</code>
          </p></li><li><p>
            <code class="literal">getProcedures()</code> (and thus indirectly
            <code class="literal">getProcedureColumns()</code>)
          </p></li><li><p>
            <code class="literal">getTables()</code>
          </p></li></ul></div><p>
        The <code class="literal">catalog</code> argument in all of these methods
        now behaves in the following way:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            Specifying <code class="literal">NULL</code> means that catalog will
            not be used to filter the results (thus all databases will
            be searched), unless you've set
            <code class="literal">nullCatalogMeansCurrent=true</code> in your JDBC
            URL properties.
          </p></li><li><p>
            Specifying <code class="literal">""</code> means
            “<span class="quote">current</span>” catalog, even though this isn't quite
            JDBC spec compliant, it is there for legacy users.
          </p></li><li><p>
            Specifying a catalog works as stated in the API docs.
          </p></li><li><p>
            Made <code class="literal">Connection.clientPrepare()</code> available
            from “<span class="quote">wrapped</span>” connections in the
            <code class="literal">jdbc2.optional</code> package (connections built
            by <code class="literal">ConnectionPoolDataSource</code> instances).
          </p></li></ul></div><p>(Bug #12541)</p></li><li><p>
        <code class="literal">getBestRowIdentifier()</code>
       (Bug #12541)</p></li><li><p>
        Made <code class="literal">Connection.clientPrepare()</code> available
        from “<span class="quote">wrapped</span>” connections in the
        <code class="literal">jdbc2.optional</code> package (connections built by
        <code class="literal">ConnectionPoolDataSource</code> instances).
       (Bug #12541)</p></li><li><p>
        <code class="literal">getTables()</code>
       (Bug #12541)</p></li><li><p>
        <code class="literal">getPrimaryKeys()</code>
       (Bug #12541)</p></li><li><p>
        <code class="literal">Connection.prepareCall()</code> is database name
        case-sensitive (on Windows systems).
       (Bug #12417)</p></li><li><p>
        <code class="literal">explainSlowQueries</code> hangs with server-side
        prepared statements.
       (Bug #12229)</p></li><li><p>
        Properties shared between master and slave with replication
        connection.
       (Bug #12218)</p></li><li><p>
        Geometry types not handled with server-side prepared statements.
       (Bug #12104)</p></li><li><p>
        <code class="literal">maxPerformance.properties</code> mis-spells
        “<span class="quote">elideSetAutoCommits</span>”.
       (Bug #11976)</p></li><li><p>
        <code class="literal">ReplicationConnection</code> won't switch to slave,
        throws “<span class="quote">Catalog can't be null</span>” exception.
       (Bug #11879)</p></li><li><p>
        <code class="literal">Pstmt.setObject(...., Types.BOOLEAN)</code> throws
        exception.
       (Bug #11798)</p></li><li><p>
        Escape tokenizer doesn't respect stacked single quotation marks
        for escapes.
       (Bug #11797)</p></li><li><p>
        <code class="literal">GEOMETRY</code> type not recognized when using
        server-side prepared statements.
       (Bug #11797)</p></li><li><p>
        Foreign key information that is quoted is parsed incorrectly
        when <code class="literal">DatabaseMetaData</code> methods use that
        information.
       (Bug #11781)</p></li><li><p>
        The <code class="literal">sendBlobChunkSize</code> property is now clamped
        to <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> with
        consideration of stream buffer size and packet headers to avoid
        <code class="literal">PacketTooBigExceptions</code> when
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> is similar
        in size to the default <code class="literal">sendBlobChunkSize</code>
        which is 1M.
       (Bug #11781)</p></li><li><p>
        <code class="literal">CallableStatement.clearParameters()</code> now
        clears resources associated with
        <code class="literal">INOUT</code>/<code class="literal">OUTPUT</code> parameters as
        well as <code class="literal">INPUT</code> parameters.
       (Bug #11781)</p></li><li><p>
        Fixed regression caused by fix for Bug#11552 that caused driver
        to return incorrect values for unsigned integers when those
        integers where within the range of the positive signed type.
       (Bug #11663)</p></li><li><p>
        Moved source code to Subversion repository.
       (Bug #11663)</p></li><li><p>
        Incorrect generation of testcase scripts for server-side
        prepared statements.
       (Bug #11663)</p></li><li><p>
        Fixed statements generated for testcases missing
        <code class="literal">;</code> for “<span class="quote">plain</span>” statements.
       (Bug #11629)</p></li><li><p>
        Spurious <code class="literal">!</code> on console when character encoding
        is <code class="literal">utf8</code>.
       (Bug #11629)</p></li><li><p>
        <code class="literal">StringUtils.getBytes()</code> doesn't work when
        using multi-byte character encodings and a length in
        <span class="emphasis"><em>characters</em></span> is specified.
       (Bug #11614)</p></li><li><p>
        <code class="literal">DBMD.storesLower/Mixed/UpperIdentifiers()</code>
        reports incorrect values for servers deployed on Windows.
       (Bug #11575)</p></li><li><p>
        Reworked <code class="literal">Field</code> class,
        <code class="literal">*Buffer</code>, and <code class="literal">MysqlIO</code> to be
        aware of field lengths &gt;
        <code class="literal">Integer.MAX_VALUE</code>.
       (Bug #11498)</p></li><li><p>
        Escape processor didn't honor strings demarcated with double
        quotation marks.
       (Bug #11498)</p></li><li><p>
        Updated <code class="literal">DBMD.supportsCorrelatedQueries()</code> to
        return <code class="literal">true</code> for versions &gt; 4.1,
        <code class="literal">supportsGroupByUnrelated()</code> to return
        <code class="literal">true</code> and
        <code class="literal">getResultSetHoldability()</code> to return
        <code class="literal">HOLD_CURSORS_OVER_COMMIT</code>.
       (Bug #11498)</p></li><li><p>
        Lifted restriction of changing streaming parameters with
        server-side prepared statements. As long as
        <code class="literal">all</code> streaming parameters were set before
        execution, <code class="literal">.clearParameters()</code> does not have
        to be called. (due to limitation of client/server protocol,
        prepared statements can not reset
        <span class="emphasis"><em>individual</em></span> stream data on the server side).
       (Bug #11498)</p></li><li><p>
        <code class="literal">ResultSet.moveToCurrentRow()</code> fails to work
        when preceded by a call to
        <code class="literal">ResultSet.moveToInsertRow()</code>.
       (Bug #11190)</p></li><li><p>
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> data corrupted when
        using server-side prepared statements and
        <code class="literal">.setBytes()</code>.
       (Bug #11115)</p></li><li><p>
        <code class="literal">Statement.getWarnings()</code> fails with NPE if
        statement has been closed.
       (Bug #10630)</p></li><li><p>
        Only get <code class="literal">char[]</code> from SQL in
        <code class="literal">PreparedStatement.ParseInfo()</code> when needed.
       (Bug #10630)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-10"></a>A.3.6. Changes in MySQL Connector/J 3.1.10 (23 June 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Initial implemention of <code class="literal">ParameterMetadata</code> for
        <code class="literal">PreparedStatement.getParameterMetadata()</code>.
        Only works fully for <code class="literal">CallableStatements</code>, as
        current server-side prepared statements return every parameter
        as a <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">VARCHAR</code></a> type.
      </p></li><li><p>
        Fixed connecting without a database specified raised an
        exception in <code class="literal">MysqlIO.changeDatabaseTo()</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-9"></a>A.3.7. Changes in MySQL Connector/J 3.1.9 (22 June 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Production package doesn't include JBoss integration classes.
       (Bug #11411)</p></li><li><p>
        Removed nonsensical “<span class="quote">costly type conversion</span>”
        warnings when using usage advisor.
       (Bug #11411)</p></li><li><p>
        Fixed <code class="literal">PreparedStatement.setClob()</code> not
        accepting <code class="literal">null</code> as a parameter.
       (Bug #11360)</p></li><li><p>
        Connector/J dumping query into <code class="literal">SQLException</code>
        twice.
       (Bug #11360)</p></li><li><p>
        <code class="literal">autoReconnect</code> ping causes exception on
        connection startup.
       (Bug #11259)</p></li><li><p>
        <code class="literal">Connection.setCatalog()</code> is now aware of the
        <code class="literal">useLocalSessionState</code> configuration property,
        which when set to <code class="literal">true</code> will prevent the
        driver from sending <code class="literal">USE ...</code> to the server if
        the requested catalog is the same as the current catalog.
       (Bug #11115)</p></li><li><p>
        <code class="literal">3-0-Compat</code>: Compatibility with Connector/J
        3.0.x functionality
       (Bug #11115)</p></li><li><p>
        <code class="literal">maxPerformance</code>: Maximum performance without
        being reckless
       (Bug #11115)</p></li><li><p>
        <code class="literal">solarisMaxPerformance</code>: Maximum performance
        for Solaris, avoids syscalls where it can
       (Bug #11115)</p></li><li><p>
        Added <code class="literal">maintainTimeStats</code> configuration
        property (defaults to <code class="literal">true</code>), which tells the
        driver whether or not to keep track of the last query time and
        the last successful packet sent to the server's time. If set to
        <code class="literal">false</code>, removes two syscalls per query.
       (Bug #11115)</p></li><li><p>
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> data corrupted when
        using server-side prepared statements and
        <code class="literal">ResultSet.getBytes()</code>.
       (Bug #11115)</p></li><li><p>
        Added the following configuration bundles, use one or many using
        the <code class="literal">useConfigs</code> configuration property:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <code class="literal">maxPerformance</code>: Maximum performance
            without being reckless
          </p></li><li><p>
            <code class="literal">solarisMaxPerformance</code>: Maximum
            performance for Solaris, avoids syscalls where it can
          </p></li><li><p>
            <code class="literal">3-0-Compat</code>: Compatibility with
            Connector/J 3.0.x functionality
          </p></li></ul></div><p>(Bug #11115)</p></li><li><p>
        Try to handle <code class="literal">OutOfMemoryErrors</code> more
        gracefully. Although not much can be done, they will in most
        cases close the connection they happened on so that further
        operations don't run into a connection in some unknown state.
        When an OOM has happened, any further operations on the
        connection will fail with a “<span class="quote">Connection closed</span>”
        exception that will also list the OOM exception as the reason
        for the implicit connection close event.
       (Bug #10850)</p></li><li><p>
        Setting <code class="literal">cachePrepStmts=true</code> now causes the
        <code class="literal">Connection</code> to also cache the check the driver
        performs to determine if a prepared statement can be server-side
        or not, as well as caches server-side prepared statements for
        the lifetime of a connection. As before, the
        <code class="literal">prepStmtCacheSize</code> parameter controls the size
        of these caches.
       (Bug #10850)</p></li><li><p>
        Don't send <code class="literal">COM_RESET_STMT</code> for each execution
        of a server-side prepared statement if it isn't required.
       (Bug #10850)</p></li><li><p>
        0-length streams not sent to server when using server-side
        prepared statements.
       (Bug #10850)</p></li><li><p>
        Driver detects if you're running MySQL-5.0.7 or later, and does
        not scan for <code class="literal">LIMIT ?[,?]</code> in statements being
        prepared, as the server supports those types of queries now.
       (Bug #10850)</p></li><li><p>
        Reorganized directory layout. Sources now are in
        <code class="filename">src</code> folder. Don't pollute parent directory
        when building, now output goes to <code class="filename">./build</code>,
        distribution goes to <code class="filename">./dist</code>.
       (Bug #10496)</p></li><li><p>
        Added support/bug hunting feature that generates
        <code class="filename">.sql</code> test scripts to
        <code class="literal">STDERR</code> when
        <code class="literal">autoGenerateTestcaseScript</code> is set to
        <code class="literal">true</code>.
       (Bug #10496)</p></li><li><p>
        <code class="literal">SQLException</code> is thrown when using property
        <code class="literal">characterSetResults</code> with
        <code class="literal">cp932</code> or <code class="literal">eucjpms</code>.
       (Bug #10496)</p></li><li><p>
        The data type returned for <code class="literal">TINYINT(1)</code> columns
        when <code class="literal">tinyInt1isBit=true</code> (the default) can be
        switched between <code class="literal">Types.BOOLEAN</code> and
        <code class="literal">Types.BIT</code> using the new configuration
        property <code class="literal">transformedBitIsBoolean</code>, which
        defaults to <code class="literal">false</code>. If set to
        <code class="literal">false</code> (the default),
        <code class="literal">DatabaseMetaData.getColumns()</code> and
        <code class="literal">ResultSetMetaData.getColumnType()</code> will return
        <code class="literal">Types.BOOLEAN</code> for
        <code class="literal">TINYINT(1)</code> columns. If
        <code class="literal">true</code>, <code class="literal">Types.BOOLEAN</code> will
        be returned instead. Regardless of this configuration property,
        if <code class="literal">tinyInt1isBit</code> is enabled, columns with the
        type <code class="literal">TINYINT(1)</code> will be returned as
        <code class="literal">java.lang.Boolean</code> instances from
        <code class="literal">ResultSet.getObject(...)</code>, and
        <code class="literal">ResultSetMetaData.getColumnClassName()</code> will
        return <code class="literal">java.lang.Boolean</code>.
       (Bug #10485)</p></li><li><p>
        <code class="literal">SQLException</code> thrown when retrieving
        <code class="literal">YEAR(2)</code> with
        <code class="literal">ResultSet.getString()</code>. The driver will now
        always treat <a href="http://dev.mysql.com/doc/refman/5.5/en/year.html" target="_top"><code class="literal">YEAR</code></a> types as
        <code class="literal">java.sql.Dates</code> and return the correct values
        for <code class="literal">getString()</code>. Alternatively, the
        <code class="literal">yearIsDateType</code> connection property can be set
        to <code class="literal">false</code> and the values will be treated as
        <code class="literal">SHORT</code>s.
       (Bug #10485)</p></li><li><p>
        Driver doesn't support <code class="literal">{?=CALL(...)}</code> for
        calling stored functions. This involved adding support for
        function retrieval to
        <code class="literal">DatabaseMetaData.getProcedures()</code> and
        <code class="literal">getProcedureColumns()</code> as well.
       (Bug #10310)</p></li><li><p>
        Unsigned <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">SMALLINT</code></a> treated as
        signed for <code class="literal">ResultSet.getInt()</code>, fixed all
        cases for <code class="literal">UNSIGNED</code> integer values and
        server-side prepared statements, as well as
        <code class="literal">ResultSet.getObject()</code> for <code class="literal">UNSIGNED
        TINYINT</code>.
       (Bug #10156)</p></li><li><p>
        Made <code class="literal">ServerPreparedStatement.asSql()</code> work
        correctly so auto-explain functionality would work with
        server-side prepared statements.
       (Bug #10155)</p></li><li><p>
        Double quotation marks not recognized when parsing client-side
        prepared statements.
       (Bug #10155)</p></li><li><p>
        Made JDBC2-compliant wrappers public to enable access to vendor
        extensions.
       (Bug #10155)</p></li><li><p>
        <code class="literal">DatabaseMetaData.supportsMultipleOpenResults()</code>
        now returns <code class="literal">true</code>. The driver has supported
        this for some time, DBMD just missed that fact.
       (Bug #10155)</p></li><li><p>
        Cleaned up logging of profiler events, moved code to dump a
        profiler event as a string to
        <code class="literal">com.mysql.jdbc.log.LogUtils</code> so that third
        parties can use it.
       (Bug #10155)</p></li><li><p>
        Made <code class="literal">enableStreamingResults()</code> visible on
        <code class="literal">com.mysql.jdbc.jdbc2.optional.StatementWrapper</code>.
       (Bug #10155)</p></li><li><p>
        Actually write manifest file to correct place so it ends up in
        the binary jar file.
       (Bug #10144)</p></li><li><p>
        Added <code class="literal">createDatabaseIfNotExist</code> property
        (default is <code class="literal">false</code>), which will cause the
        driver to ask the server to create the database specified in the
        URL if it doesn't exist. You must have the appropriate
        privileges for database creation for this to work.
       (Bug #10144)</p></li><li><p>
        Memory leak in <code class="literal">ServerPreparedStatement</code> if
        <code class="literal">serverPrepare()</code> fails.
       (Bug #10144)</p></li><li><p>
        <code class="literal">com.mysql.jdbc.PreparedStatement.ParseInfo</code>
        does unnecessary call to <code class="literal">toCharArray()</code>.
       (Bug #9064)</p></li><li><p>
        Driver now correctly uses CP932 if available on the server for
        Windows-31J, CP932 and MS932 java encoding names, otherwise it
        resorts to SJIS, which is only a close approximation. Currently
        only MySQL-5.0.3 and newer (and MySQL-4.1.12 or .13, depending
        on when the character set gets backported) can reliably support
        any variant of CP932.
      </p></li><li><p>
        Overhaul of character set configuration, everything now lives in
        a properties file.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-8"></a>A.3.8. Changes in MySQL Connector/J 3.1.8 (14 April 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Should accept <code class="literal">null</code> for catalog (meaning use
        current) in DBMD methods, even though it is not JDBC-compliant
        for legacy's sake. Disable by setting connection property
        <code class="literal">nullCatalogMeansCurrent</code> to
        <code class="literal">false</code> (which will be the default value in C/J
        3.2.x).
       (Bug #9917)</p></li><li><p>
        Fixed driver not returning <code class="literal">true</code> for
        <code class="literal">-1</code> when
        <code class="literal">ResultSet.getBoolean()</code> was called on result
        sets returned from server-side prepared statements.
       (Bug #9778)</p></li><li><p>
        Added a <code class="filename">Manifest.MF</code> file with
        implementation information to the <code class="filename">.jar</code>
        file.
       (Bug #9778)</p></li><li><p>
        More tests in <code class="literal">Field.isOpaqueBinary()</code> to
        distinguish opaque binary (that is, fields with type
        <code class="literal">CHAR(n)</code> and <code class="literal">CHARACTER SET
        BINARY</code>) from output of various scalar and aggregate
        functions that return strings.
       (Bug #9778)</p></li><li><p>
        <code class="literal">DBMD.getTables()</code> shouldn't return tables if
        views are asked for, even if the database version doesn't
        support views.
       (Bug #9778)</p></li><li><p>
        Should accept <code class="literal">null</code> for name patterns in DBMD
        (meaning “<span class="quote"><code class="literal">%</code></span>”), even though it
        isn't JDBC compliant, for legacy's sake. Disable by setting
        connection property <code class="literal">nullNamePatternMatchesAll</code>
        to <code class="literal">false</code> (which will be the default value in
        C/J 3.2.x).
       (Bug #9769)</p></li><li><p>
        The performance metrics feature now gathers information about
        number of tables referenced in a SELECT.
       (Bug #9704)</p></li><li><p>
        The logging system is now automatically configured. If the value
        has been set by the user, using the URL property
        <code class="literal">logger</code> or the system property
        <code class="literal">com.mysql.jdbc.logger</code>, then use that,
        otherwise, autodetect it using the following steps:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Log4j, if it is available,
          </p></li><li><p>
            Then JDK1.4 logging,
          </p></li><li><p>
            Then fallback to our <code class="literal">STDERR</code> logging.
          </p></li></ol></div><p>(Bug #9704)</p></li><li><p>
        <code class="literal">Statement.getMoreResults()</code> could throw NPE
        when existing result set was <code class="literal">.close()</code>d.
       (Bug #9704)</p></li><li><p>
        Stored procedures with <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a>
        parameters with storage specifications that contained
        “<span class="quote"><code class="literal">,</code></span>” in them would fail.
       (Bug #9682)</p></li><li><p>
        <code class="literal">PreparedStatement.setObject(int, Object, int type, int
        scale)</code> now uses scale value for
        <code class="literal">BigDecimal</code> instances.
       (Bug #9682)</p></li><li><p>
        Added support for the c3p0 connection pool's
        (<a href="http://c3p0.sf.net/" target="_top">http://c3p0.sf.net/</a>) validation/connection
        checker interface which uses the lightweight
        <code class="literal">COM_PING</code> call to the server if available. To
        use it, configure your c3p0 connection pool's
        <code class="literal">connectionTesterClassName</code> property to use
        <code class="literal">com.mysql.jdbc.integration.c3p0.MysqlConnectionTester</code>.
       (Bug #9320)</p></li><li><p>
        <code class="literal">PreparedStatement.getMetaData()</code> inserts blank
        row in database under certain conditions when not using
        server-side prepared statements.
       (Bug #9320)</p></li><li><p>
        Better detection of <code class="literal">LIMIT</code> inside/outside of
        quoted strings so that the driver can more correctly determine
        whether a prepared statement can be prepared on the server or
        not.
       (Bug #9320)</p></li><li><p>
        <code class="literal">Connection.canHandleAsPreparedStatement()</code> now
        makes “<span class="quote">best effort</span>” to distinguish
        <code class="literal">LIMIT</code> clauses with placeholders in them from
        ones without to have fewer false positives when generating
        work-arounds for statements the server cannot currently handle
        as server-side prepared statements.
       (Bug #9320)</p></li><li><p>
        Fixed <code class="filename">build.xml</code> to not compile
        <code class="literal">log4j</code> logging if <code class="literal">log4j</code> not
        available.
       (Bug #9320)</p></li><li><p>
        Added finalizers to <code class="literal">ResultSet</code> and
        <code class="literal">Statement</code> implementations to be JDBC
        spec-compliant, which requires that if not explicitly closed,
        these resources should be closed upon garbage collection.
       (Bug #9319)</p></li><li><p>
        Stored procedures with same name in different databases confuse
        the driver when it tries to determine parameter counts/types.
       (Bug #9319)</p></li><li><p>
        A continuation of Bug#8868, where functions used in queries that
        should return nonstring types when resolved by temporary tables
        suddenly become opaque binary strings (work-around for server
        limitation). Also fixed fields with type of <code class="literal">CHAR(n)
        CHARACTER SET BINARY</code> to return correct/matching
        classes for <code class="literal">RSMD.getColumnClassName()</code> and
        <code class="literal">ResultSet.getObject()</code>.
       (Bug #9236)</p></li><li><p>
        Cannot use <code class="literal">UTF-8</code> for characterSetResults
        configuration property.
       (Bug #9206)</p></li><li><p>
        <code class="literal">PreparedStatement.addBatch()</code> doesn't work
        with server-side prepared statements and streaming
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">BINARY</code></a> data.
       (Bug #9040)</p></li><li><p>
        <code class="literal">ServerPreparedStatements</code> now correctly
        “<span class="quote">stream</span>”
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>/<code class="literal">CLOB</code> data
        to the server. You can configure the threshold chunk size using
        the JDBC URL property <code class="literal">blobSendChunkSize</code> (the
        default is 1MB).
       (Bug #8868)</p></li><li><p>
        <a href="http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format" target="_top"><code class="literal">DATE_FORMAT()</code></a> queries returned as
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>s from
        <code class="literal">getObject()</code>.
       (Bug #8868)</p></li><li><p>
        Server-side session variables can be preset at connection time
        by passing them as a comma-delimited list for the connection
        property <code class="literal">sessionVariables</code>.
       (Bug #8868)</p></li><li><p>
        <code class="literal">BlobFromLocator</code> now uses correct identifier
        quoting when generating prepared statements.
       (Bug #8868)</p></li><li><p>
        Fixed regression in <code class="literal">ping()</code> for users using
        <code class="literal">autoReconnect=true</code>.
       (Bug #8868)</p></li><li><p>
        Check for empty strings (<code class="literal">''</code>) when converting
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">CHAR</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">VARCHAR</code></a>
        column data to numbers, throw exception if
        <code class="literal">emptyStringsConvertToZero</code> configuration
        property is set to <code class="literal">false</code> (for
        backward-compatibility with 3.0, it is now set to
        <code class="literal">true</code> by default, but will most likely default
        to <code class="literal">false</code> in 3.2).
       (Bug #8803)</p></li><li><p>
        <code class="literal">DATA_TYPE</code> column from
        <code class="literal">DBMD.getBestRowIdentifier()</code> causes
        <code class="literal">ArrayIndexOutOfBoundsException</code> when accessed
        (and in fact, didn't return any value).
       (Bug #8803)</p></li><li><p>
        <code class="literal">DBMD.supportsMixedCase*Identifiers()</code> returns
        wrong value on servers running on case-sensitive file systems.
       (Bug #8800)</p></li><li><p>
        <code class="literal">DBMD.supportsResultSetConcurrency()</code> not
        returning <code class="literal">true</code> for forward-only/read-only
        result sets (we obviously support this).
       (Bug #8792)</p></li><li><p>
        Fixed <code class="literal">ResultSet.getTime()</code> on a
        <code class="literal">NULL</code> value for server-side prepared
        statements throws NPE.
      </p></li><li><p>
        Made <code class="literal">Connection.ping()</code> a public method.
      </p></li><li><p>
        Added support for new precision-math
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> type in MySQL 5.0.3 and
        up.
      </p></li><li><p>
        Fixed <code class="literal">DatabaseMetaData.getTables()</code> returning
        views when they were not asked for as one of the requested table
        types.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-7"></a>A.3.9. Changes in MySQL Connector/J 3.1.7 (18 February 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">PreparedStatements</code> not creating streaming
        result sets.
       (Bug #8487)</p></li><li><p>
        Don't pass <code class="literal">NULL</code> to
        <code class="literal">String.valueOf()</code> in
        <code class="literal">ResultSet.getNativeConvertToString()</code>, as it
        stringifies it (that is, returns <code class="literal">null</code>), which
        is not correct for the method in question.
       (Bug #8487)</p></li><li><p>
        Fixed NPE in <code class="literal">ResultSet.realClose()</code> when using
        usage advisor and result set was already closed.
       (Bug #8428)</p></li><li><p>
        <code class="literal">ResultSet.getString()</code> doesn't maintain format
        stored on server, bug fix only enabled when
        <code class="literal">noDatetimeStringSync</code> property is set to
        <code class="literal">true</code> (the default is
        <code class="literal">false</code>).
       (Bug #8428)</p></li><li><p>
        Added support for <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a> type in
        MySQL-5.0.3. The driver will treat <code class="literal">BIT(1-8)</code>
        as the JDBC standard <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a> type
        (which maps to <code class="literal">java.lang.Boolean</code>), as the
        server does not currently send enough information to determine
        the size of a bitfield when &lt; 9 bits are declared.
        <code class="literal">BIT(&gt;9)</code> will be treated as
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a>, and will return
        <code class="literal">byte[]</code> when <code class="literal">getObject()</code> is
        called.
       (Bug #8424)</p></li><li><p>
        Added <code class="literal">useLocalSessionState</code> configuration
        property, when set to <code class="literal">true</code> the JDBC driver
        trusts that the application is well-behaved and only sets
        autocommit and transaction isolation levels using the methods
        provided on <code class="literal">java.sql.Connection</code>, and
        therefore can manipulate these values in many cases without
        incurring round-trips to the database server.
       (Bug #8424)</p></li><li><p>
        Added <code class="literal">enableStreamingResults()</code> to
        <code class="literal">Statement</code> for connection pool implementations
        that check <code class="literal">Statement.setFetchSize()</code> for
        specification-compliant values. Call
        <code class="literal">Statement.setFetchSize(&gt;=0)</code> to disable the
        streaming results for that statement.
       (Bug #8424)</p></li><li><p>
        <code class="literal">ResultSet.getBigDecimal()</code> throws exception
        when rounding would need to occur to set scale. The driver now
        chooses a rounding mode of “<span class="quote">half up</span>” if nonrounding
        <code class="literal">BigDecimal.setScale()</code> fails.
       (Bug #8424)</p></li><li><p>
        Fixed synchronization issue with
        <code class="literal">ServerPreparedStatement.serverPrepare()</code> that
        could cause deadlocks/crashes if connection was shared between
        threads.
       (Bug #8096)</p></li><li><p>
        Emulated locators corrupt binary data when using server-side
        prepared statements.
       (Bug #8096)</p></li><li><p>
        Infinite recursion when “<span class="quote">falling back</span>” to master in
        failover configuration.
       (Bug #7952)</p></li><li><p>
        Disable multi-statements (if enabled) for MySQL-4.1 versions
        prior to version 4.1.10 if the query cache is enabled, as the
        server returns wrong results in this configuration.
       (Bug #7952)</p></li><li><p>
        Removed <code class="literal">dontUnpackBinaryResults</code>
        functionality, the driver now always stores results from
        server-side prepared statements as is from the server and
        unpacks them on demand.
       (Bug #7952)</p></li><li><p>
        Fixed duplicated code in
        <code class="literal">configureClientCharset()</code> that prevented
        <code class="literal">useOldUTF8Behavior=true</code> from working
        properly.
       (Bug #7952)</p></li><li><p>
        Added <code class="literal">holdResultsOpenOverStatementClose</code>
        property (default is <code class="literal">false</code>), that keeps
        result sets open over statement.close() or new execution on same
        statement (suggested by Kevin Burton).
       (Bug #7715)</p></li><li><p>
        Detect new <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_sql_mode" target="_top"><code class="literal">sql_mode</code></a> variable in
        string form (it used to be integer) and adjust quoting method
        for strings appropriately.
       (Bug #7715)</p></li><li><p>
        Timestamps converted incorrectly to strings with server-side
        prepared statements and updatable result sets.
       (Bug #7715)</p></li><li><p>
        Timestamp key column data needed <code class="literal">_binary</code>
        stripped for <code class="literal">UpdatableResultSet.refreshRow()</code>.
       (Bug #7686)</p></li><li><p>
        Choose correct “<span class="quote">direction</span>” to apply time
        adjustments when both client and server are in GMT time zone
        when using <code class="literal">ResultSet.get(..., cal)</code> and
        <code class="literal">PreparedStatement.set(...., cal)</code>.
       (Bug #4718)</p></li><li><p>
        Remove <code class="literal">_binary</code> introducer from parameters
        used as in/out parameters in
        <code class="literal">CallableStatement</code>.
       (Bug #4718)</p></li><li><p>
        Always return <code class="literal">byte[]</code>s for output parameters
        registered as <code class="literal">*BINARY</code>.
       (Bug #4718)</p></li><li><p>
        By default, the driver now scans SQL you are preparing using all
        variants of <code class="literal">Connection.prepareStatement()</code> to
        determine if it is a supported type of statement to prepare on
        the server side, and if it is not supported by the server, it
        instead prepares it as a client-side emulated prepared
        statement. You can disable this by passing
        <code class="literal">emulateUnsupportedPstmts=false</code> in your JDBC
        URL.
       (Bug #4718)</p></li><li><p>
        Added <code class="literal">dontTrackOpenResources</code> option (default
        is <code class="literal">false</code>, to be JDBC compliant), which helps
        with memory use for nonwell-behaved apps (that is, applications
        that don't close <code class="literal">Statement</code> objects when they
        should).
       (Bug #4718)</p></li><li><p>
        Send correct value for “<span class="quote">boolean</span>”
        <code class="literal">true</code> to server for
        <code class="literal">PreparedStatement.setObject(n, "true",
        Types.BIT)</code>.
       (Bug #4718)</p></li><li><p>
        Fixed bug with Connection not caching statements from
        <code class="literal">prepareStatement()</code> when the statement wasn't
        a server-side prepared statement.
       (Bug #4718)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-6"></a>A.3.10. Changes in MySQL Connector/J 3.1.6 (23 December 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">DBMD.getProcedures()</code> doesn't respect catalog
        parameter.
       (Bug #7026)</p></li><li><p>
        Fixed hang on <code class="literal">SocketInputStream.read()</code> with
        <code class="literal">Statement.setMaxRows()</code> and multiple result
        sets when driver has to truncate result set directly, rather
        than tacking a <code class="literal">LIMIT
        <em class="replaceable"><code>n</code></em></code> on the end of it.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-5"></a>A.3.11. Changes in MySQL Connector/J 3.1.5 (02 December 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Use 1MB packet for sending file for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
        INFILE</code></a> if that is &lt;
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> on server.
       (Bug #6537)</p></li><li><p>
        <code class="literal">SUM()</code> on
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> with server-side prepared
        statement ignores scale if zero-padding is needed (this ends up
        being due to conversion to <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DOUBLE</code></a>
        by server, which when converted to a string to parse into
        <code class="literal">BigDecimal</code>, loses all “<span class="quote">padding</span>”
        zeros).
       (Bug #6537)</p></li><li><p>
        Use
        <code class="literal">DatabaseMetaData.getIdentifierQuoteString()</code>
        when building DBMD queries.
       (Bug #6537)</p></li><li><p>
        Use our own implementation of buffered input streams to get
        around blocking behavior of
        <code class="literal">java.io.BufferedInputStream</code>. Disable this
        with <code class="literal">useReadAheadInput=false</code>.
       (Bug #6399)</p></li><li><p>
        Make auto-deserialization of
        <code class="literal">java.lang.Objects</code> stored in
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> columns configurable using
        <code class="literal">autoDeserialize</code> property (defaults to
        <code class="literal">false</code>).
       (Bug #6399)</p></li><li><p>
        <code class="literal">ResultSetMetaData.getColumnDisplaySize()</code>
        returns incorrect values for multi-byte charsets.
       (Bug #6399)</p></li><li><p>
        Re-work <code class="literal">Field.isOpaqueBinary()</code> to detect
        <code class="literal">CHAR(<em class="replaceable"><code>n</code></em>) CHARACTER SET
        BINARY</code> to support fixed-length binary fields for
        <code class="literal">ResultSet.getObject()</code>.
       (Bug #6399)</p></li><li><p>
        Failing to connect to the server when one of the addresses for
        the given host name is IPV6 (which the server does not yet bind
        on). The driver now loops through <span class="emphasis"><em>all</em></span> IP
        addresses for a given host, and stops on the first one that
        <code class="literal">accepts()</code> a
        <code class="literal">socket.connect()</code>.
       (Bug #6348)</p></li><li><p>
        Removed unwanted new <code class="literal">Throwable()</code> in
        <code class="literal">ResultSet</code> constructor due to bad merge
        (caused a new object instance that was never used for every
        result set created). Found while profiling for Bug#6359.
       (Bug #6225)</p></li><li><p>
        <code class="literal">ServerSidePreparedStatement</code> allocating
        short-lived objects unnecessarily.
       (Bug #6225)</p></li><li><p>
        Use null-safe-equals for key comparisons in updatable result
        sets.
       (Bug #6225)</p></li><li><p>
        Fixed too-early creation of <code class="literal">StringBuffer</code> in
        <code class="literal">EscapeProcessor.escapeSQL()</code>, also return
        <code class="literal">String</code> when escaping not needed (to avoid
        unnecessary object allocations). Found while profiling for Bug
        #6359.
       (Bug #6225)</p></li><li><p>
        <code class="literal">UNSIGNED BIGINT</code> unpacked incorrectly from
        server-side prepared statement result sets.
       (Bug #5729)</p></li><li><p>
        Added experimental configuration property
        <code class="literal">dontUnpackBinaryResults</code>, which delays
        unpacking binary result set values until they're asked for, and
        only creates object instances for nonnumeric values (it is set
        to <code class="literal">false</code> by default). For some usecase/jvm
        combinations, this is friendlier on the garbage collector.
       (Bug #5706)</p></li><li><p>
        Don't throw exceptions for
        <code class="literal">Connection.releaseSavepoint()</code>.
       (Bug #5706)</p></li><li><p>
        Inefficient detection of pre-existing string instances in
        <code class="literal">ResultSet.getNativeString()</code>.
       (Bug #5706)</p></li><li><p>
        Use a per-session <code class="literal">Calendar</code> instance by
        default when decoding dates from
        <code class="literal">ServerPreparedStatements</code> (set to old, less
        performant behavior by setting property
        <code class="literal">dynamicCalendars=true</code>).
       (Bug #5706)</p></li><li><p>
        Fixed batched updates with server prepared statements weren't
        looking if the types had changed for a given batched set of
        parameters compared to the previous set, causing the server to
        return the error “<span class="quote">Wrong arguments to
        mysql_stmt_execute()</span>”.
       (Bug #5235)</p></li><li><p>
        Handle case when string representation of timestamp contains
        trailing “<span class="quote"><code class="literal">.</code></span>” with no numbers
        following it.
       (Bug #5235)</p></li><li><p>
        Server-side prepared statements did not honor
        <code class="literal">zeroDateTimeBehavior</code> property, and would
        cause class-cast exceptions when using
        <code class="literal">ResultSet.getObject()</code>, as the all-zero string
        was always returned.
       (Bug #5235)</p></li><li><p>
        Fix comparisons made between string constants and dynamic
        strings that are converted with either
        <code class="literal">toUpperCase()</code> or
        <code class="literal">toLowerCase()</code> to use
        <code class="literal">Locale.ENGLISH</code>, as some locales
        “<span class="quote">override</span>” case rules for English. Also use
        <code class="literal">StringUtils.indexOfIgnoreCase()</code> instead of
        <code class="literal">.toUpperCase().indexOf()</code>, avoids creating a
        very short-lived transient <code class="literal">String</code> instance.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-4"></a>A.3.12. Changes in MySQL Connector/J 3.1.4 (04 September 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed <code class="literal">ServerPreparedStatement</code> to read
        prepared statement metadata off the wire, even though it is
        currently a placeholder instead of using
        <code class="literal">MysqlIO.clearInputStream()</code> which didn't work
        at various times because data wasn't available to read from the
        server yet. This fixes sporadic errors users were having with
        <code class="literal">ServerPreparedStatements</code> throwing
        <code class="literal">ArrayIndexOutOfBoundExceptions</code>.
       (Bug #5032)</p></li><li><p>
        Added three ways to deal with all-zero datetimes when reading
        them from a <code class="literal">ResultSet</code>:
        <code class="literal">exception</code> (the default), which throws an
        <code class="literal">SQLException</code> with an SQLState of
        <code class="literal">S1009</code>; <code class="literal">convertToNull</code>,
        which returns <code class="literal">NULL</code> instead of the date; and
        <code class="literal">round</code>, which rounds the date to the nearest
        closest value which is <code class="literal">'0001-01-01'</code>.
       (Bug #5032)</p></li><li><p>
        The driver is more strict about truncation of numerics on
        <code class="literal">ResultSet.get*()</code>, and will throw an
        <code class="literal">SQLException</code> when truncation is detected. You
        can disable this by setting
        <code class="literal">jdbcCompliantTruncation</code> to
        <code class="literal">false</code> (it is enabled by default, as this
        functionality is required for JDBC compliance).
       (Bug #5032)</p></li><li><p>
        You can now use URLs in
        <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
        INFILE</code></a> statements, and the driver will use Java's
        built-in handlers for retrieving the data and sending it to the
        server. This feature is not enabled by default, you must set the
        <code class="literal">allowUrlInLocalInfile</code> connection property to
        <code class="literal">true</code>.
       (Bug #5032)</p></li><li><p>
        <code class="literal">ResultSet.getObject()</code> doesn't return type
        <code class="literal">Boolean</code> for pseudo-bit types from prepared
        statements on 4.1.x (shortcut for avoiding extra type conversion
        when using binary-encoded result sets obscured test in
        <code class="literal">getObject()</code> for “<span class="quote">pseudo</span>” bit
        type).
       (Bug #5032)</p></li><li><p>
        Use <code class="literal">com.mysql.jdbc.Message</code>'s classloader when
        loading resource bundle, should fix sporadic issues when the
        caller's classloader can't locate the resource bundle.
       (Bug #5032)</p></li><li><p>
        <code class="literal">ServerPreparedStatements</code> dealing with return
        of <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DECIMAL</code></a> type don't work.
       (Bug #5012)</p></li><li><p>
        Track packet sequence numbers if
        <code class="literal">enablePacketDebug=true</code>, and throw an
        exception if packets received out-of-order.
       (Bug #4689)</p></li><li><p>
        <code class="literal">ResultSet.wasNull()</code> does not work for
        primatives if a previous <code class="literal">null</code> was returned.
       (Bug #4689)</p></li><li><p>
        Optimized integer number parsing, enable “<span class="quote">old</span>”
        slower integer parsing using JDK classes using
        <code class="literal">useFastIntParsing=false</code> property.
       (Bug #4642)</p></li><li><p>
        Added <code class="literal">useOnlyServerErrorMessages</code> property,
        which causes message text in exceptions generated by the server
        to only contain the text sent by the server (as opposed to the
        SQLState's “<span class="quote">standard</span>” description, followed by the
        server's error message). This property is set to
        <code class="literal">true</code> by default.
       (Bug #4642)</p></li><li><p>
        <code class="literal">ServerPreparedStatement.execute*()</code> sometimes
        threw <code class="literal">ArrayIndexOutOfBoundsException</code> when
        unpacking field metadata.
       (Bug #4642)</p></li><li><p>
        Connector/J 3.1.3 beta does not handle integers correctly
        (caused by changes to support unsigned reads in
        <code class="literal">Buffer.readInt()</code> -&gt;
        <code class="literal">Buffer.readShort()</code>).
       (Bug #4510)</p></li><li><p>
        Added support in <code class="literal">DatabaseMetaData.getTables()</code>
        and <code class="literal">getTableTypes()</code> for views, which are now
        available in MySQL server 5.0.x.
       (Bug #4510)</p></li><li><p>
        <code class="literal">ResultSet.getObject()</code> returns wrong type for
        strings when using prepared statements.
       (Bug #4482)</p></li><li><p>
        Calling <code class="literal">MysqlPooledConnection.close()</code> twice
        (even though an application error), caused NPE. Fixed.
       (Bug #4482)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-3"></a>A.3.13. Changes in MySQL Connector/J 3.1.3 (07 July 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Support new time zone variables in MySQL-4.1.3 when
        <code class="literal">useTimezone=true</code>.
       (Bug #4311)</p></li><li><p>
        Error in retrieval of <code class="literal">mediumint</code> column with
        prepared statements and binary protocol.
       (Bug #4311)</p></li><li><p>
        Support for unsigned numerics as return types from prepared
        statements. This also causes a change in
        <code class="literal">ResultSet.getObject()</code> for the <code class="literal">bigint
        unsigned</code> type, which used to return
        <code class="literal">BigDecimal</code> instances, it now returns
        instances of <code class="literal">java.lang.BigInteger</code>.
       (Bug #4311)</p></li><li><p>
        Externalized more messages (on-going effort).
       (Bug #4119)</p></li><li><p>
        Null bitmask sent for server-side prepared statements was
        incorrect.
       (Bug #4119)</p></li><li><p>
        Added constants for MySQL error numbers (publicly accessible,
        see <code class="literal">com.mysql.jdbc.MysqlErrorNumbers</code>), and
        the ability to generate the mappings of vendor error codes to
        SQLStates that the driver uses (for documentation purposes).
       (Bug #4119)</p></li><li><p>
        Added packet debugging code (see the
        <code class="literal">enablePacketDebug</code> property documentation).
       (Bug #4119)</p></li><li><p>
        Use SQL Standard SQL states by default, unless
        <code class="literal">useSqlStateCodes</code> property is set to
        <code class="literal">false</code>.
       (Bug #4119)</p></li><li><p>
        Mangle output parameter names for
        <code class="literal">CallableStatements</code> so they will not clash
        with user variable names.
      </p></li><li><p>
        Added support for <code class="literal">INOUT</code> parameters in
        <code class="literal">CallableStatements</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-2"></a>A.3.14. Changes in MySQL Connector/J 3.1.2 (09 June 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Don't enable server-side prepared statements for server version
        5.0.0 or 5.0.1, as they aren't compatible with the '4.1.2+'
        style that the driver uses (the driver expects information to
        come back that isn't there, so it hangs).
       (Bug #3804)</p></li><li><p>
        <code class="literal">getWarnings()</code> returns
        <code class="literal">SQLWarning</code> instead of
        <code class="literal">DataTruncation</code>.
       (Bug #3804)</p></li><li><p>
        <code class="literal">getProcedureColumns()</code> doesn't work with
        wildcards for procedure name.
       (Bug #3540)</p></li><li><p>
        <code class="literal">getProcedures()</code> does not return any
        procedures in result set.
       (Bug #3539)</p></li><li><p>
        Fixed <code class="literal">DatabaseMetaData.getProcedures()</code> when
        run on MySQL-5.0.0 (output of <a href="http://dev.mysql.com/doc/refman/5.5/en/show-procedure-status.html" target="_top"><code class="literal">SHOW
        PROCEDURE STATUS</code></a> changed between 5.0.0 and 5.0.1.
       (Bug #3520)</p></li><li><p>
        Added <code class="literal">connectionCollation</code> property to cause
        driver to issue <code class="literal">set collation_connection=...</code>
        query on connection init if default collation for given charset
        is not appropriate.
       (Bug #3520)</p></li><li><p>
        <code class="literal">DBMD.getSQLStateType()</code> returns incorrect
        value.
       (Bug #3520)</p></li><li><p>
        Correctly map output parameters to position given in
        <code class="literal">prepareCall()</code> versus. order implied during
        <code class="literal">registerOutParameter()</code>.
       (Bug #3146)</p></li><li><p>
        Cleaned up detection of server properties.
       (Bug #3146)</p></li><li><p>
        Correctly detect initial character set for servers &gt;= 4.1.0.
       (Bug #3146)</p></li><li><p>
        Support placeholder for parameter metadata for server &gt;=
        4.1.2.
       (Bug #3146)</p></li><li><p>
        Added <code class="literal">gatherPerformanceMetrics</code> property,
        along with properties to control when/where this info gets
        logged (see docs for more info).
      </p></li><li><p>
        Fixed case when no parameters could cause a
        <code class="literal">NullPointerException</code> in
        <code class="literal">CallableStatement.setOutputParameters()</code>.
      </p></li><li><p>
        Enabled callable statement caching using
        <code class="literal">cacheCallableStmts</code> property.
      </p></li><li><p>
        Fixed sending of split packets for large queries, enabled nio
        ability to send large packets as well.
      </p></li><li><p>
        Added <code class="literal">.toString()</code> functionality to
        <code class="literal">ServerPreparedStatement</code>, which should help if
        you're trying to debug a query that is a prepared statement (it
        shows SQL as the server would process).
      </p></li><li><p>
        Added <code class="literal">logSlowQueries</code> property, along with
        <code class="literal">slowQueriesThresholdMillis</code> property to
        control when a query should be considered “<span class="quote">slow.</span>”
      </p></li><li><p>
        Removed wrapping of exceptions in
        <code class="literal">MysqlIO.changeUser()</code>.
      </p></li><li><p>
        Fixed stored procedure parameter parsing info when size was
        specified for a parameter (for example,
        <code class="literal">char()</code>, <code class="literal">varchar()</code>).
      </p></li><li><p>
        <code class="literal">ServerPreparedStatements</code> weren't actually
        de-allocating server-side resources when
        <code class="literal">.close()</code> was called.
      </p></li><li><p>
        Fixed case when no output parameters specified for a stored
        procedure caused a bogus query to be issued to retrieve out
        parameters, leading to a syntax error from the server.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-1"></a>A.3.15. Changes in MySQL Connector/J 3.1.1 (14 February 2004 alpha)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Use DocBook version of docs for shipped versions of drivers.
       (Bug #2671)</p></li><li><p>
        <code class="literal">NULL</code> fields were not being encoded correctly
        in all cases in server-side prepared statements.
       (Bug #2671)</p></li><li><p>
        Fixed rare buffer underflow when writing numbers into buffers
        for sending prepared statement execution requests.
       (Bug #2671)</p></li><li><p>
        Fixed <code class="literal">ConnectionProperties</code> that weren't
        properly exposed through accessors, cleaned up
        <code class="literal">ConnectionProperties</code> code.
       (Bug #2623)</p></li><li><p>
        Class-cast exception when using scrolling result sets and
        server-side prepared statements.
       (Bug #2623)</p></li><li><p>
        Merged unbuffered input code from 3.0.
       (Bug #2623)</p></li><li><p>
        Enabled streaming of result sets from server-side prepared
        statements.
       (Bug #2606)</p></li><li><p>
        Server-side prepared statements were not returning data type
        <a href="http://dev.mysql.com/doc/refman/5.5/en/year.html" target="_top"><code class="literal">YEAR</code></a> correctly.
       (Bug #2606)</p></li><li><p>
        Fixed charset conversion issue in
        <code class="literal">getTables()</code>.
       (Bug #2502)</p></li><li><p>
        Implemented multiple result sets returned from a statement or
        stored procedure.
       (Bug #2502)</p></li><li><p>
        Implemented <code class="literal">Connection.prepareCall()</code>, and
        <code class="literal">DatabaseMetaData</code>.
        <code class="literal">getProcedures()</code> and
        <code class="literal">getProcedureColumns()</code>.
       (Bug #2359)</p></li><li><p>
        Merged prepared statement caching, and
        <code class="literal">.getMetaData()</code> support from 3.0 branch.
       (Bug #2359)</p></li><li><p>
        Fixed off-by-1900 error in some cases for years in
        <code class="literal">TimeUtil.fastDate</code>/<code class="literal">TimeCreate()</code>
        when unpacking results from server-side prepared statements.
       (Bug #2359)</p></li><li><p>
        Reset <code class="literal">long binary</code> parameters in
        <code class="literal">ServerPreparedStatement</code> when
        <code class="literal">clearParameters()</code> is called, by sending
        <code class="literal">COM_RESET_STMT</code> to the server.
       (Bug #2359)</p></li><li><p>
        <code class="literal">NULL</code> values for numeric types in binary
        encoded result sets causing
        <code class="literal">NullPointerExceptions</code>.
       (Bug #2359)</p></li><li><p>
        Display where/why a connection was implicitly closed (to aid
        debugging).
       (Bug #1673)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> is not
        returning correct column ordinal info for
        non-<code class="literal">'%'</code> column name patterns.
       (Bug #1673)</p></li><li><p>
        Fixed <code class="literal">NullPointerException</code> in
        <code class="literal">ServerPreparedStatement.setTimestamp()</code>, as
        well as year and month descrepencies in
        <code class="literal">ServerPreparedStatement.setTimestamp()</code>,
        <code class="literal">setDate()</code>.
       (Bug #1673)</p></li><li><p>
        Added ability to have multiple database/JVM targets for
        compliance and regression/unit tests in
        <code class="filename">build.xml</code>.
       (Bug #1673)</p></li><li><p>
        Fixed sending of queries larger than 16M.
       (Bug #1673)</p></li><li><p>
        Merged fix of data type mapping from MySQL type
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a> to
        <code class="literal">java.sql.Types.REAL</code> from 3.0 branch.
       (Bug #1673)</p></li><li><p>
        Fixed NPE and year/month bad conversions when accessing some
        datetime functionality in
        <code class="literal">ServerPreparedStatements</code> and their resultant
        result sets.
       (Bug #1673)</p></li><li><p>
        Added named and indexed input/output parameter support to
        <code class="literal">CallableStatement</code>. MySQL-5.0.x or newer.
       (Bug #1673)</p></li><li><p>
        <code class="literal">CommunicationsException</code> implemented, that
        tries to determine why communications was lost with a server,
        and displays possible reasons when
        <code class="literal">.getMessage()</code> is called.
       (Bug #1673)</p></li><li><p>
        Detect collation of column for
        <code class="literal">RSMD.isCaseSensitive()</code>.
       (Bug #1673)</p></li><li><p>
        Optimized <code class="literal">Buffer.readLenByteArray()</code> to return
        shared empty byte array when length is 0.
      </p></li><li><p>
        Fix support for table aliases when checking for all primary keys
        in <code class="literal">UpdatableResultSet</code>.
      </p></li><li><p>
        Unpack “<span class="quote">unknown</span>” data types from server prepared
        statements as <code class="literal">Strings</code>.
      </p></li><li><p>
        Implemented <code class="literal">Statement.getWarnings()</code> for
        MySQL-4.1 and newer (using <a href="http://dev.mysql.com/doc/refman/5.5/en/show-warnings.html" target="_top"><code class="literal">SHOW
        WARNINGS</code></a>).
      </p></li><li><p>
        Ensure that warnings are cleared before executing queries on
        prepared statements, as-per JDBC spec (now that we support
        warnings).
      </p></li><li><p>
        Correctly initialize datasource properties from JNDI Refs,
        including explicitly specified URLs.
      </p></li><li><p>
        Implemented long data (Blobs, Clobs, InputStreams, Readers) for
        server prepared statements.
      </p></li><li><p>
        Deal with 0-length tokens in <code class="literal">EscapeProcessor</code>
        (caused by callable statement escape syntax).
      </p></li><li><p>
        <code class="literal">DatabaseMetaData</code> now reports
        <code class="literal">supportsStoredProcedures()</code> for MySQL versions
        &gt;= 5.0.0
      </p></li><li><p>
        Support for <a href="http://dev.mysql.com/doc/refman/5.5/en/mysql-change-user.html" target="_top"><code class="literal">mysql_change_user()</code></a>.
        See the <code class="literal">changeUser()</code> method in
        <code class="literal">com.mysql.jdbc.Connection</code>.
      </p></li><li><p>
        Removed <code class="literal">useFastDates</code> connection property.
      </p></li><li><p>
        Support for NIO. Use <code class="literal">useNIO=true</code> on platforms
        that support NIO.
      </p></li><li><p>
        Check for closed connection on delete/update/insert row
        operations in <code class="literal">UpdatableResultSet</code>.
      </p></li><li><p>
        Support for transaction savepoints (MySQL &gt;= 4.0.14 or
        4.1.1).
      </p></li><li><p>
        Support “<span class="quote">old</span>” <code class="literal">profileSql</code>
        capitalization in <code class="literal">ConnectionProperties</code>. This
        property is deprecated, you should use
        <code class="literal">profileSQL</code> if possible.
      </p></li><li><p>
        Fixed character encoding issues when converting bytes to ASCII
        when MySQL doesn't provide the character set, and the JVM is set
        to a multi-byte encoding (usually affecting retrieval of numeric
        values).
      </p></li><li><p>
        Centralized setting of result set type and concurrency.
      </p></li><li><p>
        Fixed bug with <code class="literal">UpdatableResultSets</code> not using
        client-side prepared statements.
      </p></li><li><p>
        Default result set type changed to
        <code class="literal">TYPE_FORWARD_ONLY</code> (JDBC compliance).
      </p></li><li><p>
        Fixed <code class="literal">IllegalAccessError</code> to
        <code class="literal">Calendar.getTimeInMillis()</code> in
        <code class="literal">DateTimeValue</code> (for JDK &lt; 1.4).
      </p></li><li><p>
        Allow contents of <code class="literal">PreparedStatement.setBlob()</code>
        to be retained between calls to <code class="literal">.execute*()</code>.
      </p></li><li><p>
        Fixed stack overflow in
        <code class="literal">Connection.prepareCall()</code> (bad merge).
      </p></li><li><p>
        Refactored how connection properties are set and exposed as
        <code class="literal">DriverPropertyInfo</code> as well as
        <code class="literal">Connection</code> and <code class="literal">DataSource</code>
        properties.
      </p></li><li><p>
        Reduced number of methods called in average query to be more
        efficient.
      </p></li><li><p>
        Prepared <code class="literal">Statements</code> will be re-prepared on
        auto-reconnect. Any errors encountered are postponed until first
        attempt to re-execute the re-prepared statement.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-1-0"></a>A.3.16. Changes in MySQL Connector/J 3.1.0 (18 February 2003 alpha)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Added <code class="literal">useServerPrepStmts</code> property (default
        <code class="literal">false</code>). The driver will use server-side
        prepared statements when the server version supports them (4.1
        and newer) when this property is set to <code class="literal">true</code>.
        It is currently set to <code class="literal">false</code> by default until
        all bind/fetch functionality has been implemented. Currently
        only DML prepared statements are implemented for 4.1 server-side
        prepared statements.
      </p></li><li><p>
        Added <code class="literal">requireSSL</code> property.
      </p></li><li><p>
        Track open <code class="literal">Statements</code>, close all when
        <code class="literal">Connection.close()</code> is called (JDBC
        compliance).
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cg-news-3-0"></a>A.4. Changes in MySQL Connector/J 3.0.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-3-0-17">A.4.1. Changes in MySQL Connector/J 3.0.17 (23 June 2005)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-16">A.4.2. Changes in MySQL Connector/J 3.0.16 (15 November 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-15">A.4.3. Changes in MySQL Connector/J 3.0.15 (04 September 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-14">A.4.4. Changes in MySQL Connector/J 3.0.14 (28 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-13">A.4.5. Changes in MySQL Connector/J 3.0.13 (27 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-12">A.4.6. Changes in MySQL Connector/J 3.0.12 (18 May 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-11">A.4.7. Changes in MySQL Connector/J 3.0.11 (19 February 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-10">A.4.8. Changes in MySQL Connector/J 3.0.10 (13 January 2004)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-9">A.4.9. Changes in MySQL Connector/J 3.0.9 (07 October 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-8">A.4.10. Changes in MySQL Connector/J 3.0.8 (23 May 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-7">A.4.11. Changes in MySQL Connector/J 3.0.7 (08 April 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-6">A.4.12. Changes in MySQL Connector/J 3.0.6 (18 February 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-5">A.4.13. Changes in MySQL Connector/J 3.0.5 (22 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-4">A.4.14. Changes in MySQL Connector/J 3.0.4 (06 January 2003)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-3">A.4.15. Changes in MySQL Connector/J 3.0.3 (17 December 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-2">A.4.16. Changes in MySQL Connector/J 3.0.2 (08 November 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-1">A.4.17. Changes in MySQL Connector/J 3.0.1 (21 September 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-3-0-0">A.4.18. Changes in MySQL Connector/J 3.0.0 (31 July 2002)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-17"></a>A.4.1. Changes in MySQL Connector/J 3.0.17 (23 June 2005)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Workaround for server Bug#9098: Default values of
        <code class="literal">CURRENT_*</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATE</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/time.html" target="_top"><code class="literal">TIME</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATETIME</code></a>, and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a> columns can't be
        distinguished from <code class="literal">string</code> values, so
        <code class="literal">UpdatableResultSet.moveToInsertRow()</code>
        generates bad SQL for inserting default values.
       (Bug #8812)</p></li><li><p>
        <code class="literal">NON_UNIQUE</code> column from
        <code class="literal">DBMD.getIndexInfo()</code> returned inverted value.
       (Bug #8812)</p></li><li><p>
        <code class="literal">EUCKR</code> charset is sent as <code class="literal">SET NAMES
        euc_kr</code> which MySQL-4.1 and newer doesn't understand.
       (Bug #8629)</p></li><li><p>
        Added support for the <code class="literal">EUC_JP_Solaris</code>
        character encoding, which maps to a MySQL encoding of
        <code class="literal">eucjpms</code> (backported from 3.1 branch). This
        only works on servers that support <code class="literal">eucjpms</code>,
        namely 5.0.3 or later.
       (Bug #8629)</p></li><li><p>
        Use hex escapes for
        <code class="literal">PreparedStatement.setBytes()</code> for double-byte
        charsets including “<span class="quote">aliases</span>”
        <code class="literal">Windows-31J</code>, <code class="literal">CP934</code>,
        <code class="literal">MS932</code>.
       (Bug #8629)</p></li><li><p>
        <code class="literal">DatabaseMetaData.supportsSelectForUpdate()</code>
        returns correct value based on server version.
       (Bug #8629)</p></li><li><p>
        Which requires hex escaping of binary data when using multi-byte
        charsets with prepared statements.
       (Bug #8064)</p></li><li><p>
        Fixed duplicated code in
        <code class="literal">configureClientCharset()</code> that prevented
        <code class="literal">useOldUTF8Behavior=true</code> from working
        properly.
       (Bug #7952)</p></li><li><p>
        Backported SQLState codes mapping from Connector/J 3.1, enable
        with <code class="literal">useSqlStateCodes=true</code> as a connection
        property, it defaults to <code class="literal">false</code> in this
        release, so that we don't break legacy applications (it defaults
        to <code class="literal">true</code> starting with Connector/J 3.1).
       (Bug #7686)</p></li><li><p>
        Timestamp key column data needed <code class="literal">_binary</code>
        stripped for <code class="literal">UpdatableResultSet.refreshRow()</code>.
       (Bug #7686)</p></li><li><p>
        <code class="literal">MS932</code>, <code class="literal">SHIFT_JIS</code>, and
        <code class="literal">Windows_31J</code> not recognized as aliases for
        <code class="literal">sjis</code>.
       (Bug #7607)</p></li><li><p>
        Handle streaming result sets with more than 2 billion rows
        properly by fixing wraparound of row number counter.
       (Bug #7601)</p></li><li><p>
        <code class="literal">PreparedStatement.fixDecimalExponent()</code> adding
        extra <code class="literal">+</code>, making number unparseable by MySQL
        server.
       (Bug #7601)</p></li><li><p>
        Escape sequence {fn convert(..., type)} now supports ODBC-style
        types that are prepended by <code class="literal">SQL_</code>.
       (Bug #7601)</p></li><li><p>
        Statements created from a pooled connection were returning
        physical connection instead of logical connection when
        <code class="literal">getConnection()</code> was called.
       (Bug #7316)</p></li><li><p>
        Support new protocol type <code class="literal">MYSQL_TYPE_VARCHAR</code>.
       (Bug #7081)</p></li><li><p>
        Added <code class="literal">useOldUTF8Behavior</code>' configuration
        property, which causes JDBC driver to act like it did with
        MySQL-4.0.x and earlier when the character encoding is
        <code class="literal">utf-8</code> when connected to MySQL-4.1 or newer.
       (Bug #7081)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getIndexInfo()</code> ignored
        <code class="literal">unique</code> parameter.
       (Bug #7081)</p></li><li><p>
        <code class="literal">PreparedStatement.fixDecimalExponent()</code> adding
        extra <code class="literal">+</code>, making number unparseable by MySQL
        server.
       (Bug #7061)</p></li><li><p>
        <code class="literal">PreparedStatements</code> don't encode Big5 (and
        other multi-byte) character sets correctly in static SQL
        strings.
       (Bug #7033)</p></li><li><p>
        Connections starting up failed-over (due to down master) never
        retry master.
       (Bug #6966)</p></li><li><p>
        Adding <code class="literal">CP943</code> to aliases for
        <code class="literal">sjis</code>.
       (Bug #6549, Bug #7607)</p></li><li><p>
        <code class="literal">Timestamp</code>/<code class="literal">Time</code> conversion
        goes in the wrong “<span class="quote">direction</span>” when
        <code class="literal">useTimeZone=true</code> and server time zone differs
        from client time zone.
       (Bug #5874)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-16"></a>A.4.2. Changes in MySQL Connector/J 3.0.16 (15 November 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Made <code class="literal">TINYINT(1)</code> -&gt;
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a>/<code class="literal">Boolean</code>
        conversion configurable using <code class="literal">tinyInt1isBit</code>
        property (default <code class="literal">true</code> to be JDBC compliant
        out of the box).
       (Bug #5664)</p></li><li><p>
        Off-by-one bug in
        <code class="literal">Buffer.readString(<em class="replaceable"><code>string</code></em>)</code>.
       (Bug #5664)</p></li><li><p>
        <code class="literal">ResultSet.updateByte()</code> when on insert row
        throws <code class="literal">ArrayOutOfBoundsException</code>.
       (Bug #5664)</p></li><li><p>
        Fixed regression where <code class="literal">useUnbufferedInput</code> was
        defaulting to <code class="literal">false</code>.
       (Bug #5664)</p></li><li><p>
        <code class="literal">ResultSet.getTimestamp()</code> on a column with
        <a href="http://dev.mysql.com/doc/refman/5.5/en/time.html" target="_top"><code class="literal">TIME</code></a> in it fails.
       (Bug #5664)</p></li><li><p>
        Fixed <code class="literal">DatabaseMetaData.getTypes()</code> returning
        incorrect (this is, nonnegative) scale for the
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">NUMERIC</code></a> type.
       (Bug #5664)</p></li><li><p>
        Only set <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_results" target="_top"><code class="literal">character_set_results</code></a>
        during connection establishment if server version &gt;= 4.1.1.
       (Bug #5664)</p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.isReadOnly()</code> to
        detect nonwritable columns when connected to MySQL-4.1 or newer,
        based on existence of “<span class="quote">original</span>” table and column
        names.
      </p></li><li><p>
        Re-issue character set configuration commands when re-using
        pooled connections or <code class="literal">Connection.changeUser()</code>
        when connected to MySQL-4.1 or newer.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-15"></a>A.4.3. Changes in MySQL Connector/J 3.0.15 (04 September 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">ResultSet.getMetaData()</code> should not return
        incorrectly initialized metadata if the result set has been
        closed, but should instead throw an
        <code class="literal">SQLException</code>. Also fixed for
        <code class="literal">getRow()</code> and <code class="literal">getWarnings()</code>
        and traversal methods by calling
        <code class="literal">checkClosed()</code> before operating on
        instance-level fields that are nullified during
        <code class="literal">.close()</code>.
       (Bug #5069)</p></li><li><p>
        Use <code class="literal">_binary</code> introducer for
        <code class="literal">PreparedStatement.setBytes()</code> and
        <code class="literal">set*Stream()</code> when connected to MySQL-4.1.x or
        newer to avoid misinterpretation during character conversion.
       (Bug #5069)</p></li><li><p>
        Parse new time zone variables from 4.1.x servers.
       (Bug #5069)</p></li><li><p>
        <code class="literal">ResultSet</code> should release
        <code class="literal">Field[]</code> instance in
        <code class="literal">.close()</code>.
       (Bug #5022)</p></li><li><p>
        <code class="literal">RSMD.getPrecision()</code> returning 0 for
        nonnumeric types (should return max length in chars for
        nonbinary types, max length in bytes for binary types). This fix
        also fixes mapping of <code class="literal">RSMD.getColumnType()</code>
        and <code class="literal">RSMD.getColumnTypeName()</code> for the
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> types based on the length
        sent from the server (the server doesn't distinguish between
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TINYBLOB</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">MEDIUMBLOB</code></a> or
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">LONGBLOB</code></a> at the network protocol
        level).
       (Bug #4880)</p></li><li><p>
        “<span class="quote">Production</span>” is now “<span class="quote">GA</span>” (General
        Availability) in naming scheme of distributions.
       (Bug #4860, Bug #4138)</p></li><li><p>
        <code class="literal">DBMD.getColumns()</code> returns incorrect JDBC type
        for unsigned columns. This affects type mappings for all numeric
        types in the <code class="literal">RSMD.getColumnType()</code> and
        <code class="literal">RSMD.getColumnTypeNames()</code> methods as well, to
        ensure that “<span class="quote">like</span>” types from
        <code class="literal">DBMD.getColumns()</code> match up with what
        <code class="literal">RSMD.getColumnType()</code> and
        <code class="literal">getColumnTypeNames()</code> return.
       (Bug #4860, Bug #4138)</p></li><li><p>
        Calling <code class="literal">.close()</code> twice on a
        <code class="literal">PooledConnection</code> causes NPE.
       (Bug #4808)</p></li><li><p>
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">DOUBLE</code></a> mapped twice in
        <code class="literal">DBMD.getTypeInfo()</code>.
       (Bug #4742)</p></li><li><p>
        Added FLOSS license exemption.
       (Bug #4742)</p></li><li><p>
        Removed redundant calls to <code class="literal">checkRowPos()</code> in
        <code class="literal">ResultSet</code>.
       (Bug #4334)</p></li><li><p>
        Failover for <code class="literal">autoReconnect</code> not using port
        numbers for any hosts, and not retrying all hosts.
      </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><div class="admon-title">Warning</div><p>
          This required a change to the <code class="literal">SocketFactory</code>
          <code class="literal">connect()</code> method signature, which is now
          <code class="literal">public Socket connect(String host, int portNumber,
          Properties props)</code>; therefore, any third-party socket
          factories will have to be changed to support this signature.
        </p></div><p>(Bug #4334)</p></li><li><p>
        Logical connections created by
        <code class="literal">MysqlConnectionPoolDataSource</code> will now issue
        a <code class="literal">rollback()</code> when they are closed and sent
        back to the pool. If your application server/connection pool
        already does this for you, you can set the
        <code class="literal">rollbackOnPooledClose</code> property to
        <code class="literal">false</code> to avoid the overhead of an extra
        <code class="literal">rollback()</code>.
       (Bug #4334)</p></li><li><p>
        <code class="literal">StringUtils.escapeEasternUnicodeByteStream</code>
        was still broken for GBK.
       (Bug #4010)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-14"></a>A.4.4. Changes in MySQL Connector/J 3.0.14 (28 May 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed URL parsing error.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-13"></a>A.4.5. Changes in MySQL Connector/J 3.0.13 (27 May 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">No Database Selected</code> when using
        <code class="literal">MysqlConnectionPoolDataSource</code>.
       (Bug #3920)</p></li><li><p>
        <code class="literal">PreparedStatement.getGeneratedKeys()</code> method
        returns only 1 result for batched insertions.
       (Bug #3873)</p></li><li><p>
        Using a <code class="literal">MySQLDatasource</code> without server name
        fails.
       (Bug #3848)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-12"></a>A.4.6. Changes in MySQL Connector/J 3.0.12 (18 May 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Inconsistent reporting of data type. The server still doesn't
        return all types for *BLOBs *TEXT correctly, so the driver won't
        return those correctly.
       (Bug #3570)</p></li><li><p>
        <code class="literal">UpdatableResultSet</code> not picking up default
        values for <code class="literal">moveToInsertRow()</code>.
       (Bug #3557)</p></li><li><p>
        Not specifying database in URL caused
        <code class="literal">MalformedURL</code> exception.
       (Bug #3554)</p></li><li><p>
        Auto-convert MySQL encoding names to Java encoding names if used
        for <code class="literal">characterEncoding</code> property.
       (Bug #3554)</p></li><li><p>
        Use <code class="literal">junit.textui.TestRunner</code> for all unit
        tests (to enable them to be run from the command line outside of
        Ant or Eclipse).
       (Bug #3554)</p></li><li><p>
        Added encoding names that are recognized on some JVMs to fix
        case where they were reverse-mapped to MySQL encoding names
        incorrectly.
       (Bug #3554)</p></li><li><p>
        Made <code class="literal">StringRegressionTest</code> 4.1-unicode aware.
       (Bug #3520)</p></li><li><p>
        Fixed regression in
        <code class="literal">PreparedStatement.setString()</code> and eastern
        character encodings.
       (Bug #3520)</p></li><li><p>
        <code class="literal">DBMD.getSQLStateType()</code> returns incorrect
        value.
       (Bug #3520)</p></li><li><p>
        Renamed <code class="literal">StringUtils.escapeSJISByteStream()</code> to
        more appropriate
        <code class="literal">escapeEasternUnicodeByteStream()</code>.
       (Bug #3511)</p></li><li><p>
        <code class="literal">StringUtils.escapeSJISByteStream()</code> not
        covering all eastern double-byte charsets correctly.
       (Bug #3511)</p></li><li><p>
        Return creating statement for <code class="literal">ResultSets</code>
        created by <code class="literal">getGeneratedKeys()</code>.
       (Bug #2957)</p></li><li><p>
        Use <code class="literal">SET character_set_results</code> during
        initialization to enable any charset to be returned to the
        driver for result sets.
       (Bug #2670)</p></li><li><p>
        Don't truncate <code class="literal">BLOB</code> or
        <code class="literal">CLOB</code> values when using
        <code class="literal">setBytes()</code> and
        <code class="literal">setBinary/CharacterStream()</code>.
       (Bug #2670)</p></li><li><p>
        Dynamically configure character set mappings for field-level
        character sets on MySQL-4.1.0 and newer using
        <a href="http://dev.mysql.com/doc/refman/5.5/en/show-collation.html" target="_top"><code class="literal">SHOW COLLATION</code></a> when connecting.
       (Bug #2670)</p></li><li><p>
        Map <code class="literal">binary</code> character set to
        <code class="literal">US-ASCII</code> to support
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATETIME</code></a> charset recognition for
        servers &gt;= 4.1.2.
       (Bug #2670)</p></li><li><p>
        Use <code class="literal">charsetnr</code> returned during connect to
        encode queries before issuing <code class="literal">SET NAMES</code> on
        MySQL &gt;= 4.1.0.
       (Bug #2670)</p></li><li><p>
        Add helper methods to <code class="literal">ResultSetMetaData</code>
        (<code class="literal">getColumnCharacterEncoding()</code> and
        <code class="literal">getColumnCharacterSet()</code>) to permit end users
        to see what charset the driver thinks it should be using for the
        column.
       (Bug #2670)</p></li><li><p>
        Only set <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_results" target="_top"><code class="literal">character_set_results</code></a>
        for MySQL &gt;= 4.1.0.
       (Bug #2670)</p></li><li><p>
        Allow <code class="literal">url</code> parameter for
        <code class="literal">MysqlDataSource</code> and
        <code class="literal">MysqlConnectionPool</code>
        <code class="literal">DataSource</code> so that passing of other
        properties is possible from inside appservers.
      </p></li><li><p>
        Don't escape SJIS/GBK/BIG5 when using MySQL-4.1 or newer.
      </p></li><li><p>
        Backport documentation tooling from 3.1 branch.
      </p></li><li><p>
        Added <code class="literal">failOverReadOnly</code> property, to enable
        the user to configure the state of the connection
        (read-only/writable) when failed over.
      </p></li><li><p>
        Allow <code class="literal">java.util.Date</code> to be sent in as
        parameter to <code class="literal">PreparedStatement.setObject()</code>,
        converting it to a <code class="literal">Timestamp</code> to maintain full
        precision. .
       (Bug #103)</p></li><li><p>
        Add unsigned attribute to
        <code class="literal">DatabaseMetaData.getColumns()</code> output in the
        <code class="literal">TYPE_NAME</code> column.
      </p></li><li><p>
        Map duplicate key and foreign key errors to SQLState of
        <code class="literal">23000</code>.
      </p></li><li><p>
        Backported “<span class="quote">change user</span>” and “<span class="quote">reset server
        state</span>” functionality from 3.1 branch, to enable clients
        of <code class="literal">MysqlConnectionPoolDataSource</code> to reset
        server state on <code class="literal">getConnection()</code> on a pooled
        connection.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-11"></a>A.4.7. Changes in MySQL Connector/J 3.0.11 (19 February 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Return <code class="literal">java.lang.Double</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">FLOAT</code></a> type from
        <code class="literal">ResultSetMetaData.getColumnClassName()</code>.
       (Bug #2855)</p></li><li><p>
        Return <code class="literal">[B</code> instead of
        <code class="literal">java.lang.Object</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">BINARY</code></a>,
        <a href="http://dev.mysql.com/doc/refman/5.5/en/binary-varbinary.html" target="_top"><code class="literal">VARBINARY</code></a> and
        <code class="literal">LONGVARBINARY</code> types from
        <code class="literal">ResultSetMetaData.getColumnClassName()</code> (JDBC
        compliance).
       (Bug #2855)</p></li><li><p>
        Issue connection events on all instances created from a
        <code class="literal">ConnectionPoolDataSource</code>.
       (Bug #2855)</p></li><li><p>
        Return <code class="literal">java.lang.Integer</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">TINYINT</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">SMALLINT</code></a> types from
        <code class="literal">ResultSetMetaData.getColumnClassName()</code>.
       (Bug #2852)</p></li><li><p>
        Added <code class="literal">useUnbufferedInput</code> parameter, and now
        use it by default (due to JVM issue
        <a href="http://developer.java.sun.com/developer/bugParade/bugs/4401235.html" target="_top">http://developer.java.sun.com/developer/bugParade/bugs/4401235.html</a>)
       (Bug #2578)</p></li><li><p>
        Fixed failover always going to last host in list.
       (Bug #2578)</p></li><li><p>
        Detect <code class="literal">on</code>/<code class="literal">off</code> or
        <code class="literal">1</code>, <code class="literal">2</code>, <code class="literal">3</code>
        form of <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_lower_case_table_names" target="_top"><code class="literal">lower_case_table_names</code></a>
        value on server.
       (Bug #2578)</p></li><li><p>
        <code class="literal">AutoReconnect</code> time was growing faster than
        exponentially.
       (Bug #2447)</p></li><li><p>
        Trigger a <code class="literal">SET NAMES utf8</code> when encoding is
        forced to <code class="literal">utf8</code> <span class="emphasis"><em>or</em></span>
        <code class="literal">utf-8</code> using the
        <code class="literal">characterEncoding</code> property. Previously, only
        the Java-style encoding name of <code class="literal">utf-8</code> would
        trigger this.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-10"></a>A.4.8. Changes in MySQL Connector/J 3.0.10 (13 January 2004)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Enable caching of the parsing stage of prepared statements using
        the <code class="literal">cachePrepStmts</code>,
        <code class="literal">prepStmtCacheSize</code>, and
        <code class="literal">prepStmtCacheSqlLimit</code> properties (disabled by
        default).
       (Bug #2006)</p></li><li><p>
        Fixed security exception when used in Applets (applets can't
        read the system property <code class="literal">file.encoding</code> which
        is needed for <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD
        DATA LOCAL INFILE</code></a>).
       (Bug #2006)</p></li><li><p>
        Speed up parsing of <code class="literal">PreparedStatements</code>, try
        to use one-pass whenever possible.
       (Bug #2006)</p></li><li><p>
        Fixed exception <code class="literal">Unknown character set
        'danish'</code> on connect with JDK-1.4.0
       (Bug #2006)</p></li><li><p>
        Fixed mappings in SQLError to report deadlocks with SQLStates of
        <code class="literal">41000</code>.
       (Bug #2006)</p></li><li><p>
        Removed static synchronization bottleneck from instance factory
        method of <code class="literal">SingleByteCharsetConverter</code>.
       (Bug #2006)</p></li><li><p>
        Removed static synchronization bottleneck from
        <code class="literal">PreparedStatement.setTimestamp()</code>.
       (Bug #2006)</p></li><li><p>
        <code class="literal">ResultSet.findColumn()</code> should use first
        matching column name when there are duplicate column names in
        <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a> query (JDBC-compliance).
       (Bug #2006)</p></li><li><p>
        <code class="literal">maxRows</code> property would affect internal
        statements, so check it for all statement creation internal to
        the driver, and set to 0 when it is not.
       (Bug #2006)</p></li><li><p>
        Use constants for SQLStates.
       (Bug #2006)</p></li><li><p>
        Map charset <code class="literal">ko18_ru</code> to
        <code class="literal">ko18r</code> when connected to MySQL-4.1.0 or newer.
       (Bug #2006)</p></li><li><p>
        Ensure that <code class="literal">Buffer.writeString()</code> saves room
        for the <code class="literal">\0</code>.
       (Bug #2006)</p></li><li><p>
        <code class="literal">ArrayIndexOutOfBounds</code> when parameter number
        == number of parameters + 1.
       (Bug #1958)</p></li><li><p>
        Connection property <code class="literal">maxRows</code> not honored.
       (Bug #1933)</p></li><li><p>
        Statements being created too many times in
        <code class="literal">DBMD.extractForeignKeyFromCreateTable()</code>.
       (Bug #1925)</p></li><li><p>
        Support escape sequence {fn convert ... }.
       (Bug #1914)</p></li><li><p>
        Implement <code class="literal">ResultSet.updateClob()</code>.
       (Bug #1913)</p></li><li><p>
        Autoreconnect code didn't set catalog upon reconnect if it had
        been changed.
       (Bug #1913)</p></li><li><p>
        <code class="literal">ResultSet.getObject()</code> on
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">TINYINT</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">SMALLINT</code></a> columns should return
        Java type <code class="literal">Integer</code>.
       (Bug #1913)</p></li><li><p>
        Added more descriptive error message <code class="literal">Server
        Configuration Denies Access to DataSource</code>, as well as
        retrieval of message from server.
       (Bug #1913)</p></li><li><p>
        <code class="literal">ResultSetMetaData.isCaseSensitive()</code> returned
        wrong value for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">CHAR</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/char.html" target="_top"><code class="literal">VARCHAR</code></a>
        columns.
       (Bug #1913)</p></li><li><p>
        Added <code class="literal">alwaysClearStream</code> connection property,
        which causes the driver to always empty any remaining data on
        the input stream before each query.
       (Bug #1913)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getSystemFunction()</code>
        returning bad function <code class="literal">VResultsSion</code>.
       (Bug #1775)</p></li><li><p>
        Foreign Keys column sequence is not consistent in
        <code class="literal">DatabaseMetaData.getImported/Exported/CrossReference()</code>.
       (Bug #1731)</p></li><li><p>
        Fix for <code class="literal">ArrayIndexOutOfBounds</code> exception when
        using <code class="literal">Statement.setMaxRows()</code>.
       (Bug #1695)</p></li><li><p>
        Subsequent call to <code class="literal">ResultSet.updateFoo()</code>
        causes NPE if result set is not updatable.
       (Bug #1630)</p></li><li><p>
        Fix for 4.1.1-style authentication with no password.
       (Bug #1630)</p></li><li><p>
        Cross-database updatable result sets are not checked for
        updatability correctly.
       (Bug #1592)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> should return
        <code class="literal">Types.LONGVARCHAR</code> for MySQL
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">LONGTEXT</code></a> type.
       (Bug #1592)</p></li><li><p>
        Fixed regression of
        <code class="literal">Statement.getGeneratedKeys()</code> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/replace.html" target="_top"><code class="literal">REPLACE</code></a> statements.
       (Bug #1576)</p></li><li><p>
        Barge blobs and split packets not being read correctly.
       (Bug #1576)</p></li><li><p>
        Backported fix for aliased tables and
        <code class="literal">UpdatableResultSets</code> in
        <code class="literal">checkUpdatability()</code> method from 3.1 branch.
       (Bug #1534)</p></li><li><p>
        “<span class="quote">Friendlier</span>” exception message for
        <code class="literal">PacketTooLargeException</code>.
       (Bug #1534)</p></li><li><p>
        Don't count quoted IDs when inside a 'string' in
        <code class="literal">PreparedStatement</code> parsing.
       (Bug #1511)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-9"></a>A.4.9. Changes in MySQL Connector/J 3.0.9 (07 October 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">ResultSet.get/setString</code> mashing char 127.
       (Bug #1247)</p></li><li><p>
        Added property to “<span class="quote">clobber</span>” streaming results, by
        setting the <code class="literal">clobberStreamingResults</code> property
        to <code class="literal">true</code> (the default is
        <code class="literal">false</code>). This will cause a
        “<span class="quote">streaming</span>” <code class="literal">ResultSet</code> to be
        automatically closed, and any outstanding data still streaming
        from the server to be discarded if another query is executed
        before all the data has been read from the server.
       (Bug #1247)</p></li><li><p>
        Added <code class="literal">com.mysql.jdbc.util.BaseBugReport</code> to
        help creation of testcases for bug reports.
       (Bug #1247)</p></li><li><p>
        Backported authentication changes for 4.1.1 and newer from 3.1
        branch.
       (Bug #1247)</p></li><li><p>
        Made <code class="literal">databaseName</code>,
        <code class="literal">portNumber</code>, and <code class="literal">serverName</code>
        optional parameters for
        <code class="literal">MysqlDataSourceFactory</code>.
       (Bug #1246)</p></li><li><p>
        Optimized <code class="literal">CLOB.setChracterStream()</code>.
       (Bug #1131)</p></li><li><p>
        Fixed <code class="literal">CLOB.truncate()</code>.
       (Bug #1130)</p></li><li><p>
        Fixed deadlock issue with
        <code class="literal">Statement.setMaxRows()</code>.
       (Bug #1099)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> getting
        confused about the keyword “<span class="quote">set</span>” in character
        columns.
       (Bug #1099)</p></li><li><p>
        Clip +/- INF (to smallest and largest representative values for
        the type in MySQL) and NaN (to 0) for
        <code class="literal">setDouble</code>/<code class="literal">setFloat()</code>, and
        issue a warning on the statement when the server does not
        support +/- INF or NaN.
       (Bug #884)</p></li><li><p>
        Don't fire connection closed events when closing pooled
        connections, or on
        <code class="literal">PooledConnection.getConnection()</code> with already
        open connections.
       (Bug #884)</p></li><li><p>
        Double-escaping of <code class="literal">'\'</code> when charset is SJIS
        or GBK and <code class="literal">'\'</code> appears in nonescaped input.
       (Bug #879)</p></li><li><p>
        When emptying input stream of unused rows for
        “<span class="quote">streaming</span>” result sets, have the current thread
        <code class="literal">yield()</code> every 100 rows to not monopolize CPU
        time.
       (Bug #879)</p></li><li><p>
        Issue exception on
        <code class="literal">ResultSet.get<em class="replaceable"><code>XXX</code></em>()</code>
        on empty result set (wasn't caught in some cases).
       (Bug #848)</p></li><li><p>
        Don't hide messages from exceptions thrown in I/O layers.
       (Bug #848)</p></li><li><p>
        Fixed regression in large split-packet handling.
       (Bug #848)</p></li><li><p>
        Better diagnostic error messages in exceptions for
        “<span class="quote">streaming</span>” result sets.
       (Bug #848)</p></li><li><p>
        Don't change timestamp TZ twice if
        <code class="literal">useTimezone==true</code>.
       (Bug #774)</p></li><li><p>
        Don't wrap <code class="literal">SQLExceptions</code> in
        <code class="literal">RowDataDynamic</code>.
       (Bug #688)</p></li><li><p>
        Don't try and reset isolation level on reconnect if MySQL
        doesn't support them.
       (Bug #688)</p></li><li><p>
        The <code class="literal">insertRow</code> in an
        <code class="literal">UpdatableResultSet</code> is now loaded with the
        default column values when <code class="literal">moveToInsertRow()</code>
        is called.
       (Bug #688)</p></li><li><p>
        <code class="literal">DatabaseMetaData.getColumns()</code> wasn't
        returning <code class="literal">NULL</code> for default values that are
        specified as <code class="literal">NULL</code>.
       (Bug #688)</p></li><li><p>
        Change default statement type/concurrency to
        <code class="literal">TYPE_FORWARD_ONLY</code> and
        <code class="literal">CONCUR_READ_ONLY</code> (spec compliance).
       (Bug #688)</p></li><li><p>
        Fix <code class="literal">UpdatableResultSet</code> to return values for
        <code class="literal">get<em class="replaceable"><code>XXX</code></em>()</code> when on
        insert row.
       (Bug #675)</p></li><li><p>
        Support <code class="literal">InnoDB</code> constraint names when
        extracting foreign key information in
        <code class="literal">DatabaseMetaData</code> (implementing ideas from
        Parwinder Sekhon).
       (Bug #664, Bug #517)</p></li><li><p>
        Backported 4.1 protocol changes from 3.1 branch (server-side SQL
        states, new field information, larger client capability flags,
        connect-with-database, and so forth).
       (Bug #664, Bug #517)</p></li><li><p>
        <code class="literal">refreshRow</code> didn't work when primary key
        values contained values that needed to be escaped (they ended up
        being doubly escaped).
       (Bug #661)</p></li><li><p>
        Fixed <code class="literal">ResultSet.previous()</code> behavior to move
        current position to before result set when on first row of
        result set.
       (Bug #496)</p></li><li><p>
        Fixed <code class="literal">Statement</code> and
        <code class="literal">PreparedStatement</code> issuing bogus queries when
        <code class="literal">setMaxRows()</code> had been used and a
        <code class="literal">LIMIT</code> clause was present in the query.
       (Bug #496)</p></li><li><p>
        Faster date handling code in <code class="literal">ResultSet</code> and
        <code class="literal">PreparedStatement</code> (no longer uses
        <code class="literal">Date</code> methods that synchronize on static
        calendars).
      </p></li><li><p>
        Fixed test for end of buffer in
        <code class="literal">Buffer.readString()</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-8"></a>A.4.10. Changes in MySQL Connector/J 3.0.8 (23 May 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed SJIS encoding bug, thanks to Naoto Sato.
       (Bug #378)</p></li><li><p>
        Fix problem detecting server character set in some cases.
       (Bug #378)</p></li><li><p>
        Allow multiple calls to <code class="literal">Statement.close()</code>.
       (Bug #378)</p></li><li><p>
        Return correct number of generated keys when using
        <a href="http://dev.mysql.com/doc/refman/5.5/en/replace.html" target="_top"><code class="literal">REPLACE</code></a> statements.
       (Bug #378)</p></li><li><p>
        Unicode character 0xFFFF in a string would cause the driver to
        throw an <code class="literal">ArrayOutOfBoundsException</code>. .
       (Bug #378)</p></li><li><p>
        Fix row data decoding error when using <span class="emphasis"><em>very</em></span>
        large packets.
       (Bug #378)</p></li><li><p>
        Optimized row data decoding.
       (Bug #378)</p></li><li><p>
        Issue exception when operating on an already closed prepared
        statement.
       (Bug #378)</p></li><li><p>
        Optimized usage of <code class="literal">EscapeProcessor</code>.
       (Bug #378)</p></li><li><p>
        Use JVM charset with file names and <code class="literal">LOAD DATA [LOCAL]
        INFILE</code>.
      </p></li><li><p>
        Fix infinite loop with <code class="literal">Connection.cleanup()</code>.
      </p></li><li><p>
        Changed Ant target <code class="literal">compile-core</code> to
        <code class="literal">compile-driver</code>, and made testsuite
        compilation a separate target.
      </p></li><li><p>
        Fixed result set not getting set for
        <code class="literal">Statement.executeUpdate()</code>, which affected
        <code class="literal">getGeneratedKeys()</code> and
        <code class="literal">getUpdateCount()</code> in some cases.
      </p></li><li><p>
        Return list of generated keys when using multi-value
        <code class="literal">INSERTS</code> with
        <code class="literal">Statement.getGeneratedKeys()</code>.
      </p></li><li><p>
        Allow bogus URLs in <code class="literal">Driver.getPropertyInfo()</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-7"></a>A.4.11. Changes in MySQL Connector/J 3.0.7 (08 April 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed charset issues with database metadata (charset was not
        getting set correctly).
      </p></li><li><p>
        You can now toggle profiling on/off using
        <code class="literal">Connection.setProfileSql(boolean)</code>.
      </p></li><li><p>
        4.1 Column Metadata fixes.
      </p></li><li><p>
        Fixed <code class="literal">MysqlPooledConnection.close()</code> calling
        wrong event type.
      </p></li><li><p>
        Fixed <code class="literal">StringIndexOutOfBoundsException</code> in
        <code class="literal">PreparedStatement.setClob()</code>.
      </p></li><li><p>
        <code class="literal">IOExceptions</code> during a transaction now cause
        the <code class="literal">Connection</code> to be closed.
      </p></li><li><p>
        Remove synchronization from <code class="literal">Driver.connect()</code>
        and <code class="literal">Driver.acceptsUrl()</code>.
      </p></li><li><p>
        Fixed missing conversion for <a href="http://dev.mysql.com/doc/refman/5.5/en/year.html" target="_top"><code class="literal">YEAR</code></a>
        type in
        <code class="literal">ResultSetMetaData.getColumnTypeName()</code>.
      </p></li><li><p>
        Updatable <code class="literal">ResultSets</code> can now be created for
        aliased tables/columns when connected to MySQL-4.1 or newer.
      </p></li><li><p>
        Fixed <a href="http://dev.mysql.com/doc/refman/5.5/en/load-data.html" target="_top"><code class="literal">LOAD DATA LOCAL
        INFILE</code></a> bug when file &gt;
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a>.
      </p></li><li><p>
        Don't pick up indexes that start with <code class="literal">pri</code> as
        primary keys for <code class="literal">DBMD.getPrimaryKeys()</code>.
      </p></li><li><p>
        Ensure that packet size from
        <code class="literal">alignPacketSize()</code> does not exceed
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_max_allowed_packet" target="_top"><code class="literal">max_allowed_packet</code></a> (JVM bug)
      </p></li><li><p>
        Don't reset <code class="literal">Connection.isReadOnly()</code> when
        autoReconnecting.
      </p></li><li><p>
        Fixed escaping of 0x5c (<code class="literal">'\'</code>) character for
        GBK and Big5 charsets.
      </p></li><li><p>
        Fixed <code class="literal">ResultSet.getTimestamp()</code> when
        underlying field is of type <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATE</code></a>.
      </p></li><li><p>
        Throw <code class="literal">SQLExceptions</code> when trying to do
        operations on a forcefully closed <code class="literal">Connection</code>
        (that is, when a communication link failure occurs).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-6"></a>A.4.12. Changes in MySQL Connector/J 3.0.6 (18 February 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Backported 4.1 charset field info changes from Connector/J 3.1.
      </p></li><li><p>
        Fixed <code class="literal">Statement.setMaxRows()</code> to stop sending
        <code class="literal">LIMIT</code> type queries when not needed
        (performance).
      </p></li><li><p>
        Fixed <code class="literal">DBMD.getTypeInfo()</code> and
        <code class="literal">DBMD.getColumns()</code> returning different value
        for precision in <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> types.
      </p></li><li><p>
        Fixed <code class="literal">SQLExceptions</code> getting swallowed on
        initial connect.
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData</code> to return
        <code class="literal">""</code> when catalog not known. Fixes
        <code class="literal">NullPointerExceptions</code> with Sun's
        <code class="literal">CachedRowSet</code>.
      </p></li><li><p>
        Allow ignoring of warning for “<span class="quote">non transactional
        tables</span>” during rollback (compliance/usability) by setting
        <code class="literal">ignoreNonTxTables</code> property to
        <code class="literal">true</code>.
      </p></li><li><p>
        Clean up <code class="literal">Statement</code> query/method mismatch
        tests (that is, <a href="http://dev.mysql.com/doc/refman/5.5/en/insert.html" target="_top"><code class="literal">INSERT</code></a> not
        permitted with <code class="literal">.executeQuery()</code>).
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.isWritable()</code> to
        return correct value.
      </p></li><li><p>
        More checks added in <code class="literal">ResultSet</code> traversal
        method to catch when in closed state.
      </p></li><li><p>
        Implemented <code class="literal">Blob.setBytes()</code>. You still need
        to pass the resultant <code class="literal">Blob</code> back into an
        updatable <code class="literal">ResultSet</code> or
        <code class="literal">PreparedStatement</code> to persist the changes,
        because MySQL does not support “<span class="quote">locators</span>”.
      </p></li><li><p>
        Add “<span class="quote">window</span>” of different <code class="literal">NULL</code>
        sorting behavior to
        <code class="literal">DBMD.nullsAreSortedAtStart</code> (4.0.2 to 4.0.10,
        true; otherwise, no).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-5"></a>A.4.13. Changes in MySQL Connector/J 3.0.5 (22 January 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed <code class="literal">ResultSet.isBeforeFirst()</code> for empty
        result sets.
      </p></li><li><p>
        Added missing
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">LONGTEXT</code></a> type to
        <code class="literal">DBMD.getColumns()</code>.
      </p></li><li><p>
        Implemented an empty <code class="literal">TypeMap</code> for
        <code class="literal">Connection.getTypeMap()</code> so that some
        third-party apps work with MySQL (IBM WebSphere 5.0 Connection
        pool).
      </p></li><li><p>
        Added update options for foreign key metadata.
      </p></li><li><p>
        Fixed <code class="literal">Buffer.fastSkipLenString()</code> causing
        <code class="literal">ArrayIndexOutOfBounds</code> exceptions with some
        queries when unpacking fields.
      </p></li><li><p>
        Quote table names in
        <code class="literal">DatabaseMetaData.getColumns()</code>,
        <code class="literal">getPrimaryKeys()</code>,
        <code class="literal">getIndexInfo()</code>,
        <code class="literal">getBestRowIdentifier()</code>.
      </p></li><li><p>
        Retrieve <code class="literal">TX_ISOLATION</code> from database for
        <code class="literal">Connection.getTransactionIsolation()</code> when the
        MySQL version supports it, instead of an instance variable.
      </p></li><li><p>
        Greatly reduce memory required for
        <code class="literal">setBinaryStream()</code> in
        <code class="literal">PreparedStatements</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-4"></a>A.4.14. Changes in MySQL Connector/J 3.0.4 (06 January 2003)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Streamlined character conversion and <code class="literal">byte[]</code>
        handling in <code class="literal">PreparedStatements</code> for
        <code class="literal">setByte()</code>.
      </p></li><li><p>
        Fixed <code class="literal">PreparedStatement.executeBatch()</code>
        parameter overwriting.
      </p></li><li><p>
        Added quoted identifiers to database names for
        <code class="literal">Connection.setCatalog</code>.
      </p></li><li><p>
        Added support for 4.0.8-style large packets.
      </p></li><li><p>
        Reduce memory footprint of <code class="literal">PreparedStatements</code>
        by sharing outbound packet with <code class="literal">MysqlIO</code>.
      </p></li><li><p>
        Added <code class="literal">strictUpdates</code> property to enable
        control of amount of checking for “<span class="quote">correctness</span>” of
        updatable result sets. Set this to <code class="literal">false</code> if
        you want faster updatable result sets and you know that you
        create them from <a href="http://dev.mysql.com/doc/refman/5.5/en/select.html" target="_top"><code class="literal">SELECT</code></a>
        statements on tables with primary keys and that you have
        selected all primary keys in your query.
      </p></li><li><p>
        Added support for quoted identifiers in
        <code class="literal">PreparedStatement</code> parser.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-3"></a>A.4.15. Changes in MySQL Connector/J 3.0.3 (17 December 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Allow user to alter behavior of <code class="literal">Statement</code>/
        <code class="literal">PreparedStatement.executeBatch()</code> using
        <code class="literal">continueBatchOnError</code> property (defaults to
        <code class="literal">true</code>).
      </p></li><li><p>
        More robust escape tokenizer: Recognize <code class="literal">--</code>
        comments, and permit nested escape sequences (see
        <code class="literal">testsuite.EscapeProcessingTest</code>).
      </p></li><li><p>
        Fixed <code class="literal">Buffer.isLastDataPacket()</code> for 4.1 and
        newer servers.
      </p></li><li><p>
        <code class="literal">NamedPipeSocketFactory</code> now works (only
        intended for Windows), see <code class="filename">README</code> for
        instructions.
      </p></li><li><p>
        Changed <code class="literal">charsToByte</code> in
        <code class="literal">SingleByteCharConverter</code> to be nonstatic.
      </p></li><li><p>
        Use nonaliased table/column names and database names to fully
        qualify tables and columns in
        <code class="literal">UpdatableResultSet</code> (requires MySQL-4.1 or
        newer).
      </p></li><li><p>
        <code class="literal">LOAD DATA LOCAL INFILE ...</code> now works, if your
        server is configured to permit it. Can be turned off with the
        <code class="literal">allowLoadLocalInfile</code> property (see the
        <code class="filename">README</code>).
      </p></li><li><p>
        Implemented <code class="literal">Connection.nativeSQL()</code>.
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.getColumnTypeName()</code>
        returning <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> types.
      </p></li><li><p>
        Fixed charset handling in <code class="literal">Fields.java</code>.
      </p></li><li><p>
        Because of above, implemented
        <code class="literal">ResultSetMetaData.isAutoIncrement()</code> to use
        <code class="literal">Field.isAutoIncrement()</code>.
      </p></li><li><p>
        Substitute <code class="literal">'?'</code> for unknown character
        conversions in single-byte character sets instead of
        <code class="literal">'\0'</code>.
      </p></li><li><p>
        Added <code class="literal">CLIENT_LONG_FLAG</code> to be able to get more
        column flags (<code class="literal">isAutoIncrement()</code> being the
        most important).
      </p></li><li><p>
        Honor <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_lower_case_table_names" target="_top"><code class="literal">lower_case_table_names</code></a>
        when enabled in the server when doing table name comparisons in
        <code class="literal">DatabaseMetaData</code> methods.
      </p></li><li><p>
        <code class="literal">DBMD.getImported/ExportedKeys()</code> now handles
        multiple foreign keys per table.
      </p></li><li><p>
        More robust implementation of updatable result sets. Checks that
        <span class="emphasis"><em>all</em></span> primary keys of the table have been
        selected.
      </p></li><li><p>
        Some MySQL-4.1 protocol support (extended field info from
        selects).
      </p></li><li><p>
        Check for connection closed in more
        <code class="literal">Connection</code> methods
        (<code class="literal">createStatement</code>,
        <code class="literal">prepareStatement</code>,
        <code class="literal">setTransactionIsolation</code>,
        <code class="literal">setAutoCommit</code>).
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.getPrecision()</code>
        returning incorrect values for some floating-point types.
      </p></li><li><p>
        Changed <code class="literal">SingleByteCharConverter</code> to use lazy
        initialization of each converter.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-2"></a>A.4.16. Changes in MySQL Connector/J 3.0.2 (08 November 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Implemented <code class="literal">Clob.setString()</code>.
      </p></li><li><p>
        Added <code class="literal">com.mysql.jdbc.MiniAdmin</code> class, which
        enables you to send <code class="literal">shutdown</code> command to MySQL
        server. This is intended to be used when
        “<span class="quote">embedding</span>” Java and MySQL server together in an
        end-user application.
      </p></li><li><p>
        Added SSL support. See <code class="filename">README</code> for
        information on how to use it.
      </p></li><li><p>
        All <code class="literal">DBMD</code> result set columns describing
        schemas now return <code class="literal">NULL</code> to be more compliant
        with the behavior of other JDBC drivers for other database
        systems (MySQL does not support schemas).
      </p></li><li><p>
        Use <a href="http://dev.mysql.com/doc/refman/5.5/en/show-create-table.html" target="_top"><code class="literal">SHOW CREATE TABLE</code></a> when
        possible for determining foreign key information for
        <code class="literal">DatabaseMetaData</code>. Also enables cascade
        options for <a href="http://dev.mysql.com/doc/refman/5.5/en/delete.html" target="_top"><code class="literal">DELETE</code></a> information to
        be returned.
      </p></li><li><p>
        Implemented <code class="literal">Clob.setCharacterStream()</code>.
      </p></li><li><p>
        Failover and <code class="literal">autoReconnect</code> work only when the
        connection is in an <code class="literal">autoCommit(false)</code> state,
        to stay transaction-safe.
      </p></li><li><p>
        Fixed <code class="literal">DBMD.supportsResultSetConcurrency()</code> so
        that it returns <code class="literal">true</code> for
        <code class="literal">ResultSet.TYPE_SCROLL_INSENSITIVE</code> and
        <code class="literal">ResultSet.CONCUR_READ_ONLY</code> or
        <code class="literal">ResultSet.CONCUR_UPDATABLE</code>.
      </p></li><li><p>
        Implemented <code class="literal">Clob.setAsciiStream()</code>.
      </p></li><li><p>
        Removed duplicate code from
        <code class="literal">UpdatableResultSet</code> (it can be inherited from
        <code class="literal">ResultSet</code>, the extra code for each method to
        handle updatability I thought might someday be necessary has not
        been needed).
      </p></li><li><p>
        Fixed <code class="literal">UnsupportedEncodingException</code> thrown
        when “<span class="quote">forcing</span>” a character encoding using
        properties.
      </p></li><li><p>
        Fixed incorrect conversion in
        <code class="literal">ResultSet.getLong()</code>.
      </p></li><li><p>
        Implemented <code class="literal">ResultSet.updateBlob()</code>.
      </p></li><li><p>
        Removed some not-needed temporary object creation by smarter use
        of <code class="literal">Strings</code> in
        <code class="literal">EscapeProcessor</code>,
        <code class="literal">Connection</code> and
        <code class="literal">DatabaseMetaData</code> classes.
      </p></li><li><p>
        Escape <code class="literal">0x5c</code> character in strings for the SJIS
        charset.
      </p></li><li><p>
        <code class="literal">PreparedStatement</code> now honors stream lengths
        in setBinary/Ascii/Character Stream() unless you set the
        connection property
        <code class="literal">useStreamLengthsInPrepStmts</code> to
        <code class="literal">false</code>.
      </p></li><li><p>
        Fixed issue with updatable result sets and
        <code class="literal">PreparedStatements</code> not working.
      </p></li><li><p>
        Fixed start position off-by-1 error in
        <code class="literal">Clob.getSubString()</code>.
      </p></li><li><p>
        Added <code class="literal">connectTimeout</code> parameter that enables
        users of JDK-1.4 and newer to specify a maximum time to wait to
        establish a connection.
      </p></li><li><p>
        Fixed various non-ASCII character encoding issues.
      </p></li><li><p>
        Fixed <code class="literal">ResultSet.isLast()</code> for empty result
        sets (should return <code class="literal">false</code>).
      </p></li><li><p>
        Added driver property <code class="literal">useHostsInPrivileges</code>.
        Defaults to <code class="literal">true</code>. Affects whether or not
        <code class="literal">@hostname</code> will be used in
        <code class="literal">DBMD.getColumn/TablePrivileges</code>.
      </p></li><li><p>
        Fixed
        <code class="literal">ResultSet.setFetchDirection(FETCH_UNKNOWN)</code>.
      </p></li><li><p>
        Added <code class="literal">queriesBeforeRetryMaster</code> property that
        specifies how many queries to issue when failed over before
        attempting to reconnect to the master (defaults to 50).
      </p></li><li><p>
        Fixed issue when calling
        <code class="literal">Statement.setFetchSize()</code> when using arbitrary
        values.
      </p></li><li><p>
        Properly restore connection properties when autoReconnecting or
        failing-over, including <code class="literal">autoCommit</code> state, and
        isolation level.
      </p></li><li><p>
        Implemented <code class="literal">Clob.truncate()</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-1"></a>A.4.17. Changes in MySQL Connector/J 3.0.1 (21 September 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Charsets now automatically detected. Optimized code for
        single-byte character set conversion.
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.isSigned()</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">TINYINT</code></a> and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIGINT</code></a>.
      </p></li><li><p>
        Fixed <code class="literal">RowDataStatic.getAt()</code> off-by-one bug.
      </p></li><li><p>
        Fixed <code class="literal">ResultSet.getRow()</code> off-by-one bug.
      </p></li><li><p>
        Massive code clean-up to follow Java coding conventions (the
        time had come).
      </p></li><li><p>
        Implemented <code class="literal">ResultSet.getCharacterStream()</code>.
      </p></li><li><p>
        Added limited <code class="literal">Clob</code> functionality
        (<code class="literal">ResultSet.getClob()</code>,
        <code class="literal">PreparedStatement.setClob()</code>,
        <code class="literal">PreparedStatement.setObject(Clob)</code>.
      </p></li><li><p>
        <code class="literal">Connection.isClosed()</code> no longer
        “<span class="quote">pings</span>” the server.
      </p></li><li><p>
        <code class="literal">Connection.close()</code> issues
        <code class="literal">rollback()</code> when
        <code class="literal">getAutoCommit()</code> is <code class="literal">false</code>.
      </p></li><li><p>
        Added <code class="literal">socketTimeout</code> parameter to URL.
      </p></li><li><p>
        Added <code class="literal">LOCAL TEMPORARY</code> to table types in
        <code class="literal">DatabaseMetaData.getTableTypes()</code>.
      </p></li><li><p>
        Added <code class="literal">paranoid</code> parameter, which sanitizes
        error messages by removing “<span class="quote">sensitive</span>” information
        from them (such as host names, ports, or user names), as well as
        clearing “<span class="quote">sensitive</span>” data structures when possible.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-3-0-0"></a>A.4.18. Changes in MySQL Connector/J 3.0.0 (31 July 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        General source-code cleanup.
      </p></li><li><p>
        The driver now only works with JDK-1.2 or newer.
      </p></li><li><p>
        Fix and sort primary key names in <code class="literal">DBMetaData</code>
        (SF bugs 582086 and 582086).
      </p></li><li><p>
        <code class="literal">ResultSet.getTimestamp()</code> now works for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">DATE</code></a> types (SF bug 559134).
      </p></li><li><p>
        Float types now reported as
        <code class="literal">java.sql.Types.FLOAT</code> (SF bug 579573).
      </p></li><li><p>
        Support for streaming (row-by-row) result sets (see
        <code class="filename">README</code>) Thanks to Doron.
      </p></li><li><p>
        Testsuite now uses Junit (which you can get from
        <a href="http://www.junit.org" target="_top">http://www.junit.org</a>.
      </p></li><li><p>
        JDBC Compliance: Passes all tests besides stored procedure
        tests.
      </p></li><li><p>
        <code class="literal">ResultSet.getDate/Time/Timestamp</code> now
        recognizes all forms of invalid values that have been set to all
        zeros by MySQL (SF bug 586058).
      </p></li><li><p>
        Added multi-host failover support (see
        <code class="filename">README</code>).
      </p></li><li><p>
        Repackaging: New driver name is
        <code class="literal">com.mysql.jdbc.Driver</code>, old name still works,
        though (the driver is now provided by MySQL-AB).
      </p></li><li><p>
        Support for large packets (new addition to MySQL-4.0 protocol),
        see <code class="filename">README</code> for more information.
      </p></li><li><p>
        Better checking for closed connections in
        <code class="literal">Statement</code> and
        <code class="literal">PreparedStatement</code>.
      </p></li><li><p>
        Performance improvements in string handling and field metadata
        creation (lazily instantiated) contributed by Alex
        Twisleton-Wykeham-Fiennes.
      </p></li><li><p>
        JDBC-3.0 functionality including
        <code class="literal">Statement/PreparedStatement.getGeneratedKeys()</code>
        and <code class="literal">ResultSet.getURL()</code>.
      </p></li><li><p>
        Overall speed improvements using controlling transient object
        creation in <code class="literal">MysqlIO</code> class when reading
        packets.
      </p></li><li><p>
        <span class="bold"><strong>!!! LICENSE CHANGE !!!</strong></span> The
        driver is now GPL. If you need non-GPL licenses, please contact
        me <code class="literal">&lt;mark@mysql.com&gt;</code>.
      </p></li><li><p>
        Performance enhancements: Driver is now 50–100% faster in
        most situations, and creates fewer temporary objects.
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cj-news-2-0"></a>A.5. Changes in MySQL Connector/J 2.0.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-2-0-14">A.5.1. Changes in MySQL Connector/J 2.0.14 (16 May 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-13">A.5.2. Changes in MySQL Connector/J 2.0.13 (24 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-12">A.5.3. Changes in MySQL Connector/J 2.0.12 (07 April 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-11">A.5.4. Changes in MySQL Connector/J 2.0.11 (27 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-10">A.5.5. Changes in MySQL Connector/J 2.0.10 (24 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-9">A.5.6. Changes in MySQL Connector/J 2.0.9 (13 January 2002)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-8">A.5.7. Changes in MySQL Connector/J 2.0.8 (25 November 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-7">A.5.8. Changes in MySQL Connector/J 2.0.7 (24 October 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-6">A.5.9. Changes in MySQL Connector/J 2.0.6 (16 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-5">A.5.10. Changes in MySQL Connector/J 2.0.5 (13 June 2001)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-3">A.5.11. Changes in MySQL Connector/J 2.0.3 (03 December 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0-1">A.5.12. Changes in MySQL Connector/J 2.0.1 (06 April 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre5">A.5.13. Changes in MySQL Connector/J 2.0.0pre5 (21 February 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre4">A.5.14. Changes in MySQL Connector/J 2.0.0pre4 (10 January 2000)</a></span></dt><dt><span class="section"><a href="#cj-news-2-0pre">A.5.15. Changes in MySQL Connector/J 2.0.0pre (17 August 1999)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-14"></a>A.5.1. Changes in MySQL Connector/J 2.0.14 (16 May 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">ResultSet.getDouble()</code> now uses code built
        into JDK to be more precise (but slower).
      </p></li><li><p>
        Fixed typo for <code class="literal">relaxAutoCommit</code> parameter.
      </p></li><li><p>
        <code class="literal">LogicalHandle.isClosed()</code> calls through to
        physical connection.
      </p></li><li><p>
        Added SQL profiling (to <code class="literal">STDERR</code>). Set
        <code class="literal">profileSql=true</code> in your JDBC URL. See
        <code class="filename">README</code> for more information.
      </p></li><li><p>
        <code class="literal">PreparedStatement</code> now releases resources on
        <code class="literal">.close()</code>. (SF bug 553268)
      </p></li><li><p>
        More code cleanup.
      </p></li><li><p>
        Quoted identifiers not used if server version does not support
        them. Also, if server started with
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_ansi" target="_top"><code class="option">--ansi</code></a> or
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_sql-mode" target="_top"><code class="option">--sql-mode=ANSI_QUOTES</code></a>,
        “<span class="quote"><code class="literal">"</code></span>” will be used as an
        identifier quote character, otherwise
        “<span class="quote"><code class="literal">'</code></span>” will be used.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-13"></a>A.5.2. Changes in MySQL Connector/J 2.0.13 (24 April 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed unicode chars being read incorrectly. (SF bug 541088)
      </p></li><li><p>
        Faster blob escaping for <code class="literal">PrepStmt</code>.
      </p></li><li><p>
        Added <code class="literal">setURL()</code> to
        <code class="literal">MySQLXADataSource</code>. (SF bug 546019)
      </p></li><li><p>
        Added <code class="literal">set</code>/<code class="literal">getPortNumber()</code>
        to <code class="literal">DataSource(s)</code>. (SF bug 548167)
      </p></li><li><p>
        <code class="literal">PreparedStatement.toString()</code> fixed. (SF bug
        534026)
      </p></li><li><p>
        More code cleanup.
      </p></li><li><p>
        Rudimentary version of
        <code class="literal">Statement.getGeneratedKeys()</code> from JDBC-3.0
        now implemented (you need to be using JDK-1.4 for this to work,
        I believe).
      </p></li><li><p>
        <code class="literal">DBMetaData.getIndexInfo()</code> - bad PAGES fixed.
        (SF BUG 542201)
      </p></li><li><p>
        <code class="literal">ResultSetMetaData.getColumnClassName()</code> now
        implemented.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-12"></a>A.5.3. Changes in MySQL Connector/J 2.0.12 (07 April 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed <code class="literal">testsuite.Traversal</code>
        <code class="literal">afterLast()</code> bug, thanks to Igor Lastric.
      </p></li><li><p>
        Added new types to <code class="literal">getTypeInfo()</code>, fixed
        existing types thanks to Al Davis and Kid Kalanon.
      </p></li><li><p>
        Fixed time zone off-by-1-hour bug in
        <code class="literal">PreparedStatement</code> (538286, 528785).
      </p></li><li><p>
        Added identifier quoting to all
        <code class="literal">DatabaseMetaData</code> methods that need them
        (should fix 518108).
      </p></li><li><p>
        Added support for <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">BIT</code></a> types
        (51870) to <code class="literal">PreparedStatement</code>.
      </p></li><li><p>
        <code class="literal">ResultSet.insertRow()</code> should now detect
        auto_increment fields in most cases and use that value in the
        new row. This detection will not work in multi-valued keys,
        however, due to the fact that the MySQL protocol does not return
        this information.
      </p></li><li><p>
        Relaxed synchronization in all classes, should fix 520615 and
        520393.
      </p></li><li><p>
        <code class="literal">DataSources</code> - fixed <code class="literal">setUrl</code>
        bug (511614, 525565), wrong datasource class name (532816,
        528767).
      </p></li><li><p>
        Added support for <a href="http://dev.mysql.com/doc/refman/5.5/en/year.html" target="_top"><code class="literal">YEAR</code></a> type
        (533556).
      </p></li><li><p>
        Fixes for <code class="literal">ResultSet</code> updatability in
        <code class="literal">PreparedStatement</code>.
      </p></li><li><p>
        <code class="literal">ResultSet</code>: Fixed updatability (values being
        set to <code class="literal">null</code> if not updated).
      </p></li><li><p>
        Added <code class="literal">getTable/ColumnPrivileges()</code> to DBMD
        (fixes 484502).
      </p></li><li><p>
        Added <code class="literal">getIdleFor()</code> method to
        <code class="literal">Connection</code> and
        <code class="literal">MysqlLogicalHandle</code>.
      </p></li><li><p>
        <code class="literal">ResultSet.refreshRow()</code> implemented.
      </p></li><li><p>
        Fixed <code class="literal">getRow()</code> bug (527165) in
        <code class="literal">ResultSet</code>.
      </p></li><li><p>
        General code cleanup.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-11"></a>A.5.4. Changes in MySQL Connector/J 2.0.11 (27 January 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Full synchronization of <code class="literal">Statement.java</code>.
      </p></li><li><p>
        Fixed missing <code class="literal">DELETE_RULE</code> value in
        <code class="literal">DBMD.getImported/ExportedKeys()</code> and
        <code class="literal">getCrossReference()</code>.
      </p></li><li><p>
        More changes to fix <code class="literal">Unexpected end of input
        stream</code> errors when reading
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> values. This should be the
        last fix.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-10"></a>A.5.5. Changes in MySQL Connector/J 2.0.10 (24 January 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed null-pointer-exceptions when using
        <code class="literal">MysqlConnectionPoolDataSource</code> with Websphere
        4 (bug 505839).
      </p></li><li><p>
        Fixed spurious <code class="literal">Unexpected end of input stream</code>
        errors in <code class="literal">MysqlIO</code> (bug 507456).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-9"></a>A.5.6. Changes in MySQL Connector/J 2.0.9 (13 January 2002)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed extra memory allocation in
        <code class="literal">MysqlIO.readPacket()</code> (bug 488663).
      </p></li><li><p>
        Added detection of network connection being closed when reading
        packets (thanks to Todd Lizambri).
      </p></li><li><p>
        Fixed casting bug in <code class="literal">PreparedStatement</code> (bug
        488663).
      </p></li><li><p>
        <code class="literal">DataSource</code> implementations moved to
        <code class="literal">org.gjt.mm.mysql.jdbc2.optional</code> package, and
        (initial) implementations of
        <code class="literal">PooledConnectionDataSource</code> and
        <code class="literal">XADataSource</code> are in place (thanks to Todd
        Wolff for the implementation and testing of
        <code class="literal">PooledConnectionDataSource</code> with IBM WebSphere
        4).
      </p></li><li><p>
        Fixed quoting error with escape processor (bug 486265).
      </p></li><li><p>
        Removed concatenation support from driver (the
        <code class="literal">||</code> operator), as older versions of VisualAge
        seem to be the only thing that use it, and it conflicts with the
        logical <code class="literal">||</code> operator. You will need to start
        <span><strong class="command">mysqld</strong></span> with the
        <a href="http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_ansi" target="_top"><code class="option">--ansi</code></a> flag to use the
        <code class="literal">||</code> operator as concatenation (bug 491680).
      </p></li><li><p>
        <span><strong class="command">Ant</strong></span> build was corrupting included
        <code class="filename">jar</code> files, fixed (bug 487669).
      </p></li><li><p>
        Report batch update support through
        <code class="literal">DatabaseMetaData</code> (bug 495101).
      </p></li><li><p>
        Implementation of
        <code class="literal">DatabaseMetaData.getExported/ImportedKeys()</code>
        and <code class="literal">getCrossReference()</code>.
      </p></li><li><p>
        Fixed off-by-one-hour error in
        <code class="literal">PreparedStatement.setTimestamp()</code> (bug
        491577).
      </p></li><li><p>
        Full synchronization on methods modifying instance and
        class-shared references, driver should be entirely thread-safe
        now (please let me know if you have problems).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-8"></a>A.5.7. Changes in MySQL Connector/J 2.0.8 (25 November 2001)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">XADataSource</code>/<code class="literal">ConnectionPoolDataSource</code>
        code (experimental)
      </p></li><li><p>
        <code class="literal">DatabaseMetaData.getPrimaryKeys()</code> and
        <code class="literal">getBestRowIdentifier()</code> are now more robust in
        identifying primary keys (matches regardless of case or
        abbreviation/full spelling of <code class="literal">Primary Key</code> in
        <code class="literal">Key_type</code> column).
      </p></li><li><p>
        Batch updates now supported (thanks to some inspiration from
        Daniel Rall).
      </p></li><li><p>
        <code class="literal">PreparedStatement.setAnyNumericType()</code> now
        handles positive exponents correctly (adds <code class="literal">+</code>
        so MySQL can understand it).
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-7"></a>A.5.8. Changes in MySQL Connector/J 2.0.7 (24 October 2001)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Character sets read from database if
        <code class="literal">useUnicode=true</code> and
        <code class="literal">characterEncoding</code> is not set. (thanks to
        Dmitry Vereshchagin)
      </p></li><li><p>
        Initial transaction isolation level read from database (if
        available). (thanks to Dmitry Vereshchagin)
      </p></li><li><p>
        Fixed <code class="literal">PreparedStatement</code> generating SQL that
        would end up with syntax errors for some queries.
      </p></li><li><p>
        <code class="literal">PreparedStatement.setCharacterStream()</code> now
        implemented
      </p></li><li><p>
        Captialize type names when
        <code class="literal">captializeTypeNames=true</code> is passed in URL or
        properties (for WebObjects. (thanks to Anjo Krank)
      </p></li><li><p>
        <code class="literal">ResultSet.getBlob()</code> now returns
        <code class="literal">null</code> if column value was
        <code class="literal">null</code>.
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.getPrecision()</code>
        returning one less than actual on newer versions of MySQL.
      </p></li><li><p>
        Fixed dangling socket problem when in high availability
        (<code class="literal">autoReconnect=true</code>) mode, and finalizer for
        <code class="literal">Connection</code> will close any dangling sockets on
        GC.
      </p></li><li><p>
        Fixed time zone issue in
        <code class="literal">PreparedStatement.setTimestamp()</code>. (thanks to
        Erik Olofsson)
      </p></li><li><p>
        PreparedStatement.setDouble() now uses full-precision doubles
        (reverting a fix made earlier to truncate them).
      </p></li><li><p>
        Fixed
        <code class="literal">DatabaseMetaData.supportsTransactions()</code>, and
        <code class="literal">supportsTransactionIsolationLevel()</code> and
        <code class="literal">getTypeInfo()</code>
        <code class="literal">SQL_DATETIME_SUB</code> and
        <code class="literal">SQL_DATA_TYPE</code> fields not being readable.
      </p></li><li><p>
        Updatable result sets now correctly handle
        <code class="literal">NULL</code> values in fields.
      </p></li><li><p>
        PreparedStatement.setBoolean() will use 1/0 for values if your
        MySQL version is 3.21.23 or higher.
      </p></li><li><p>
        Fixed <code class="literal">ResultSet.isAfterLast()</code> always
        returning <code class="literal">false</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-6"></a>A.5.9. Changes in MySQL Connector/J 2.0.6 (16 June 2001)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed <code class="literal">PreparedStatement</code> parameter checking.
      </p></li><li><p>
        Fixed case-sensitive column names in
        <code class="literal">ResultSet.java</code>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-5"></a>A.5.10. Changes in MySQL Connector/J 2.0.5 (13 June 2001)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">ResultSet.insertRow()</code> works now, even if not
        all columns are set (they will be set to
        <code class="literal">NULL</code>).
      </p></li><li><p>
        Added <code class="literal">Byte</code> to
        <code class="literal">PreparedStatement.setObject()</code>.
      </p></li><li><p>
        Fixed data parsing of <a href="http://dev.mysql.com/doc/refman/5.5/en/datetime.html" target="_top"><code class="literal">TIMESTAMP</code></a>
        values with 2-digit years.
      </p></li><li><p>
        Added <code class="literal">ISOLATION</code> level support to
        <code class="literal">Connection.setIsolationLevel()</code>
      </p></li><li><p>
        <code class="literal">DataBaseMetaData.getCrossReference()</code> no
        longer <code class="literal">ArrayIndexOOB</code>.
      </p></li><li><p>
        <code class="literal">ResultSet.getBoolean()</code> now recognizes
        <code class="literal">-1</code> as <code class="literal">true</code>.
      </p></li><li><p>
        <code class="literal">ResultSet</code> has +/-Inf/inf support.
      </p></li><li><p>
        <code class="literal">getObject()</code> on <code class="literal">ResultSet</code>
        correctly does
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">TINYINT</code></a>-&gt;<code class="literal">Byte</code>
        and
        <a href="http://dev.mysql.com/doc/refman/5.5/en/numeric-types.html" target="_top"><code class="literal">SMALLINT</code></a>-&gt;<code class="literal">Short</code>.
      </p></li><li><p>
        Fixed <code class="literal">ResultSetMetaData.getColumnTypeName</code> for
        <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a>/<a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a>.
      </p></li><li><p>
        Fixed <code class="literal">ArrayIndexOutOfBounds</code> when sending
        large <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">BLOB</code></a> queries. (Max size
        packet was not being set)
      </p></li><li><p>
        Fixed NPE on
        <code class="literal">PreparedStatement.executeUpdate()</code> when all
        columns have not been set.
      </p></li><li><p>
        Fixed <code class="literal">ResultSet.getBlob()</code>
        <code class="literal">ArrayIndex</code> out-of-bounds.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-3"></a>A.5.11. Changes in MySQL Connector/J 2.0.3 (03 December 2000)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Fixed composite key problem with updatable result sets.
      </p></li><li><p>
        Faster ASCII string operations.
      </p></li><li><p>
        Fixed off-by-one error in <code class="literal">java.sql.Blob</code>
        implementation code.
      </p></li><li><p>
        Fixed incorrect detection of
        <code class="literal">MAX_ALLOWED_PACKET</code>, so sending large blobs
        should work now.
      </p></li><li><p>
        Added detection of -/+INF for doubles.
      </p></li><li><p>
        Added <code class="literal">ultraDevHack</code> URL parameter, set to
        <code class="literal">true</code> to enable (broken) Macromedia UltraDev
        to use the driver.
      </p></li><li><p>
        Implemented <code class="literal">getBigDecimal()</code> without scale
        component for JDBC2.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0-1"></a>A.5.12. Changes in MySQL Connector/J 2.0.1 (06 April 2000)</h3></div></div></div><p><span class="bold"><strong>Bugs fixed:</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p>
        Columns that are of type <a href="http://dev.mysql.com/doc/refman/5.5/en/blob.html" target="_top"><code class="literal">TEXT</code></a> now
        return as <code class="literal">Strings</code> when you use
        <code class="literal">getObject()</code>.
      </p></li><li><p>
        Cleaned up exception handling when driver connects.
      </p></li><li><p>
        Fixed <code class="literal">RSMD.isWritable()</code> returning wrong
        value. Thanks to Moritz Maass.
      </p></li><li><p>
        <code class="literal">DatabaseMetaData.getPrimaryKeys()</code> now works
        correctly with respect to <code class="literal">key_seq</code>. Thanks to
        Brian Slesinsky.
      </p></li><li><p>
        Fixed many JDBC-2.0 traversal, positioning bugs, especially with
        respect to empty result sets. Thanks to Ron Smits, Nick Brook,
        Cessar Garcia and Carlos Martinez.
      </p></li><li><p>
        No escape processing is done on
        <code class="literal">PreparedStatements</code> anymore per JDBC spec.
      </p></li><li><p>
        Fixed some issues with updatability support in
        <code class="literal">ResultSet</code> when using multiple primary keys.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0pre5"></a>A.5.13. Changes in MySQL Connector/J 2.0.0pre5 (21 February 2000)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed Bad Handshake problem.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0pre4"></a>A.5.14. Changes in MySQL Connector/J 2.0.0pre4 (10 January 2000)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixes to ResultSet for insertRow() - Thanks to Cesar Garcia
          </p></li><li><p>
            Fix to Driver to recognize JDBC-2.0 by loading a JDBC-2.0
            class, instead of relying on JDK version numbers. Thanks to
            John Baker.
          </p></li><li><p>
            Fixed ResultSet to return correct row numbers
          </p></li><li><p>
            Statement.getUpdateCount() now returns rows matched, instead
            of rows actually updated, which is more SQL-92 like.
          </p></li></ul></div><p>
        10-29-99
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Statement/PreparedStatement.getMoreResults() bug fixed.
            Thanks to Noel J. Bergman.
          </p></li><li><p>
            Added Short as a type to PreparedStatement.setObject().
            Thanks to Jeff Crowder
          </p></li><li><p>
            Driver now automagically configures maximum/preferred packet
            sizes by querying server.
          </p></li><li><p>
            Autoreconnect code uses fast ping command if server supports
            it.
          </p></li><li><p>
            Fixed various bugs with respect to packet sizing when
            reading from the server and when alloc'ing to write to the
            server.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-2-0pre"></a>A.5.15. Changes in MySQL Connector/J 2.0.0pre (17 August 1999)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Now compiles under JDK-1.2. The driver supports both JDK-1.1
            and JDK-1.2 at the same time through a core set of classes.
            The driver will load the appropriate interface classes at
            runtime by figuring out which JVM version you are using.
          </p></li><li><p>
            Fixes for result sets with all nulls in the first row.
            (Pointed out by Tim Endres)
          </p></li><li><p>
            Fixes to column numbers in SQLExceptions in ResultSet
            (Thanks to Blas Rodriguez Somoza)
          </p></li><li><p>
            The database no longer needs to specified to connect.
            (Thanks to Christian Motschke)
          </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cj-news-1-2b"></a>A.6. Changes in MySQL Connector/J 1.2b (04 July 1999)</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
          Better Documentation (in progress), in doc/mm.doc/book1.html
        </p></li><li><p>
          DBMD now permits null for a column name pattern (not in spec),
          which it changes to '%'.
        </p></li><li><p>
          DBMD now has correct types/lengths for getXXX().
        </p></li><li><p>
          ResultSet.getDate(), getTime(), and getTimestamp() fixes.
          (contributed by Alan Wilken)
        </p></li><li><p>
          EscapeProcessor now handles \{ \} and { or } inside quotation
          marks correctly. (thanks to Alik for some ideas on how to fix
          it)
        </p></li><li><p>
          Fixes to properties handling in Connection. (contributed by
          Juho Tikkala)
        </p></li><li><p>
          ResultSet.getObject() now returns null for NULL columns in the
          table, rather than bombing out. (thanks to Ben Grosman)
        </p></li><li><p>
          ResultSet.getObject() now returns Strings for types from MySQL
          that it doesn't know about. (Suggested by Chris Perdue)
        </p></li><li><p>
          Removed DataInput/Output streams, not needed, 1/2 number of
          method calls per IO operation.
        </p></li><li><p>
          Use default character encoding if one is not specified. This
          is a work-around for broken JVMs, because according to spec,
          EVERY JVM must support "ISO8859_1", but they do not.
        </p></li><li><p>
          Fixed Connection to use the platform character encoding
          instead of "ISO8859_1" if one isn't explicitly set. This fixes
          problems people were having loading the character- converter
          classes that didn't always exist (JVM bug). (thanks to Fritz
          Elfert for pointing out this problem)
        </p></li><li><p>
          Changed MysqlIO to re-use packets where possible to reduce
          memory usage.
        </p></li><li><p>
          Fixed escape-processor bugs pertaining to {} inside quotation
          marks.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cg-news-1-0"></a>A.7. Changes in MySQL Connector/J 1.2.x and lower</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#cj-news-1-2a">A.7.1. Changes in MySQL Connector/J 1.2a (14 April 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1i">A.7.2. Changes in MySQL Connector/J 1.1i (24 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1h">A.7.3. Changes in MySQL Connector/J 1.1h (08 March 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1g">A.7.4. Changes in MySQL Connector/J 1.1g (19 February 1999)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1f">A.7.5. Changes in MySQL Connector/J 1.1f (31 December 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1b">A.7.6. Changes in MySQL Connector/J 1.1b (03 November 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-1">A.7.7. Changes in MySQL Connector/J 1.1 (02 September 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-1-0">A.7.8. Changes in MySQL Connector/J 1.0 (24 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9d">A.7.9. Changes in MySQL Connector/J 0.9d (04 August 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-9">A.7.10. Changes in MySQL Connector/J 0.9 (28 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-8">A.7.11. Changes in MySQL Connector/J 0.8 (06 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-7">A.7.12. Changes in MySQL Connector/J 0.7 (01 July 1998)</a></span></dt><dt><span class="section"><a href="#cj-news-0-6">A.7.13. Changes in MySQL Connector/J 0.6 (21 May 1998)</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-2a"></a>A.7.1. Changes in MySQL Connector/J 1.2a (14 April 1999)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed character-set support for non-Javasoft JVMs (thanks to
            many people for pointing it out)
          </p></li><li><p>
            Fixed ResultSet.getBoolean() to recognize 'y' &amp; 'n' as
            well as '1' &amp; '0' as boolean flags. (thanks to Tim
            Pizey)
          </p></li><li><p>
            Fixed ResultSet.getTimestamp() to give better performance.
            (thanks to Richard Swift)
          </p></li><li><p>
            Fixed getByte() for numeric types. (thanks to Ray Bellis)
          </p></li><li><p>
            Fixed DatabaseMetaData.getTypeInfo() for DATE type. (thanks
            to Paul Johnston)
          </p></li><li><p>
            Fixed EscapeProcessor for "fn" calls. (thanks to Piyush Shah
            at locomotive.org)
          </p></li><li><p>
            Fixed EscapeProcessor to not do extraneous work if there are
            no escape codes. (thanks to Ryan Gustafson)
          </p></li><li><p>
            Fixed Driver to parse URLs of the form
            "jdbc:mysql://host:port" (thanks to Richard Lobb)
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1i"></a>A.7.2. Changes in MySQL Connector/J 1.1i (24 March 1999)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed Timestamps for PreparedStatements
          </p></li><li><p>
            Fixed null pointer exceptions in RSMD and RS
          </p></li><li><p>
            Re-compiled with jikes for valid class files (thanks ms!)
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1h"></a>A.7.3. Changes in MySQL Connector/J 1.1h (08 March 1999)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed escape processor to deal with unmatched { and }
            (thanks to Craig Coles)
          </p></li><li><p>
            Fixed escape processor to create more portable (between
            DATETIME and TIMESTAMP types) representations so that it
            will work with BETWEEN clauses. (thanks to Craig Longman)
          </p></li><li><p>
            MysqlIO.quit() now closes the socket connection. Before,
            after many failed connections some OS's would run out of
            file descriptors. (thanks to Michael Brinkman)
          </p></li><li><p>
            Fixed NullPointerException in Driver.getPropertyInfo.
            (thanks to Dave Potts)
          </p></li><li><p>
            Fixes to MysqlDefs to allow all *text fields to be retrieved
            as Strings. (thanks to Chris at Leverage)
          </p></li><li><p>
            Fixed setDouble in PreparedStatement for large numbers to
            avoid sending scientific notation to the database. (thanks
            to J.S. Ferguson)
          </p></li><li><p>
            Fixed getScale() and getPrecision() in RSMD. (contrib'd by
            James Klicman)
          </p></li><li><p>
            Fixed getObject() when field was DECIMAL or NUMERIC (thanks
            to Bert Hobbs)
          </p></li><li><p>
            DBMD.getTables() bombed when passed a null table-name
            pattern. Fixed. (thanks to Richard Lobb)
          </p></li><li><p>
            Added check for "client not authorized" errors during
            connect. (thanks to Hannes Wallnoefer)
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1g"></a>A.7.4. Changes in MySQL Connector/J 1.1g (19 February 1999)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Result set rows are now byte arrays. Blobs and Unicode work
            bidriectonally now. The useUnicode and encoding options are
            implemented now.
          </p></li><li><p>
            Fixes to PreparedStatement to send binary set by
            setXXXStream to be sent untouched to the MySQL server.
          </p></li><li><p>
            Fixes to getDriverPropertyInfo().
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1f"></a>A.7.5. Changes in MySQL Connector/J 1.1f (31 December 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Changed all ResultSet fields to Strings, this should allow
            Unicode to work, but your JVM must be able to convert
            between the character sets. This should also make reading
            data from the server be a bit quicker, because there is now
            no conversion from StringBuffer to String.
          </p></li><li><p>
            Changed PreparedStatement.streamToString() to be more
            efficient (code from Uwe Schaefer).
          </p></li><li><p>
            URL parsing is more robust (throws SQL exceptions on errors
            rather than NullPointerExceptions)
          </p></li><li><p>
            PreparedStatement now can convert Strings to Time/Date
            values using setObject() (code from Robert Currey).
          </p></li><li><p>
            IO no longer hangs in Buffer.readInt(), that bug was
            introduced in 1.1d when changing to all byte-arrays for
            result sets. (Pointed out by Samo Login)
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1b"></a>A.7.6. Changes in MySQL Connector/J 1.1b (03 November 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixes to DatabaseMetaData to allow both IBM VA and J-Builder
            to work. Let me know how it goes. (thanks to Jac Kersing)
          </p></li><li><p>
            Fix to ResultSet.getBoolean() for NULL strings (thanks to
            Barry Lagerweij)
          </p></li><li><p>
            Beginning of code cleanup, and formatting. Getting ready to
            branch this off to a parallel JDBC-2.0 source tree.
          </p></li><li><p>
            Added "final" modifier to critical sections in MysqlIO and
            Buffer to allow compiler to inline methods for speed.
          </p></li></ul></div><p>
        9-29-98
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            If object references passed to setXXX() in PreparedStatement
            are null, setNull() is automatically called for you. (Thanks
            for the suggestion goes to Erik Ostrom)
          </p></li><li><p>
            setObject() in PreparedStatement will now attempt to write a
            serialized representation of the object to the database for
            objects of Types.OTHER and objects of unknown type.
          </p></li><li><p>
            Util now has a static method readObject() which given a
            ResultSet and a column index will re-instantiate an object
            serialized in the above manner.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-1"></a>A.7.7. Changes in MySQL Connector/J 1.1 (02 September 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Got rid of "ugly hack" in MysqlIO.nextRow(). Rather than
            catch an exception, Buffer.isLastDataPacket() was fixed.
          </p></li><li><p>
            Connection.getCatalog() and Connection.setCatalog() should
            work now.
          </p></li><li><p>
            Statement.setMaxRows() works, as well as setting by property
            maxRows. Statement.setMaxRows() overrides maxRows set using
            properties or url parameters.
          </p></li><li><p>
            Automatic re-connection is available. Because it has to
            "ping" the database before each query, it is turned off by
            default. To use it, pass in "autoReconnect=true" in the
            connection URL. You may also change the number of reconnect
            tries, and the initial timeout value using "maxReconnects=n"
            (default 3) and "initialTimeout=n" (seconds, default 2)
            parameters. The timeout is an exponential backoff type of
            timeout; for example, if you have initial timeout of 2
            seconds, and maxReconnects of 3, then the driver will
            timeout 2 seconds, 4 seconds, then 16 seconds between each
            re-connection attempt.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-1-0"></a>A.7.8. Changes in MySQL Connector/J 1.0 (24 August 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed handling of blob data in Buffer.java
          </p></li><li><p>
            Fixed bug with authentication packet being sized too small.
          </p></li><li><p>
            The JDBC Driver is now under the LGPL
          </p></li></ul></div><p>
        8-14-98
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed Buffer.readLenString() to correctly read data for
            BLOBS.
          </p></li><li><p>
            Fixed PreparedStatement.stringToStream to correctly read
            data for BLOBS.
          </p></li><li><p>
            Fixed PreparedStatement.setDate() to not add a day. (above
            fixes thanks to Vincent Partington)
          </p></li><li><p>
            Added URL parameter parsing (?user=... and so forth).
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-0-9d"></a>A.7.9. Changes in MySQL Connector/J 0.9d (04 August 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Big news! New package name. Tim Endres from ICE Engineering
            is starting a new source tree for GNU GPL'd Java software.
            He's graciously given me the org.gjt.mm package directory to
            use, so now the driver is in the org.gjt.mm.mysql package
            scheme. I'm "legal" now. Look for more information on Tim's
            project soon.
          </p></li><li><p>
            Now using dynamically sized packets to reduce memory usage
            when sending commands to the DB.
          </p></li><li><p>
            Small fixes to getTypeInfo() for parameters, and so forth.
          </p></li><li><p>
            DatabaseMetaData is now fully implemented. Let me know if
            these drivers work with the various IDEs out there. I've
            heard that they're working with JBuilder right now.
          </p></li><li><p>
            Added JavaDoc documentation to the package.
          </p></li><li><p>
            Package now available in .zip or .tar.gz.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-0-9"></a>A.7.10. Changes in MySQL Connector/J 0.9 (28 July 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Implemented getTypeInfo(). Connection.rollback() now throws
            an SQLException per the JDBC spec.
          </p></li><li><p>
            Added PreparedStatement that supports all JDBC API methods
            for PreparedStatement including InputStreams. Please check
            this out and let me know if anything is broken.
          </p></li><li><p>
            Fixed a bug in ResultSet that would break some queries that
            only returned 1 row.
          </p></li><li><p>
            Fixed bugs in DatabaseMetaData.getTables(),
            DatabaseMetaData.getColumns() and
            DatabaseMetaData.getCatalogs().
          </p></li><li><p>
            Added functionality to Statement that enables
            executeUpdate() to store values for IDs that are
            automatically generated for AUTO_INCREMENT fields.
            Basically, after an executeUpdate(), look at the SQLWarnings
            for warnings like "LAST_INSERTED_ID = 'some number', COMMAND
            = 'your SQL query'". If you are using AUTO_INCREMENT fields
            in your tables and are executing a lot of executeUpdate()s
            on one Statement, be sure to clearWarnings() every so often
            to save memory.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-0-8"></a>A.7.11. Changes in MySQL Connector/J 0.8 (06 July 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Split MysqlIO and Buffer to separate classes. Some
            ClassLoaders gave an IllegalAccess error for some fields in
            those two classes. Now mm.mysql works in applets and all
            classloaders. Thanks to Joe Ennis &lt;jce@mail.boone.com&gt;
            for pointing out the problem and working on a fix with me.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-0-7"></a>A.7.12. Changes in MySQL Connector/J 0.7 (01 July 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Fixed DatabaseMetadata problems in getColumns() and bug in
            switch statement in the Field constructor. Thanks to Costin
            Manolache &lt;costin@tdiinc.com&gt; for pointing these out.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="cj-news-0-6"></a>A.7.13. Changes in MySQL Connector/J 0.6 (21 May 1998)</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
            Incorporated efficiency changes from Richard Swift
            &lt;Richard.Swift@kanatek.ca&gt; in
            <code class="literal">MysqlIO.java</code> and
            <code class="literal">ResultSet.java</code>:
          </p></li><li><p>
            We're now 15% faster than gwe's driver.
          </p></li><li><p>
            Started working on <code class="literal">DatabaseMetaData</code>.
          </p></li><li><p>
            The following methods are implemented:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="function">getTables()</code>
              </p></li><li><p>
                <code class="function">getTableTypes()</code>
              </p></li><li><p>
                <code class="function">getColumns()</code>
              </p></li><li><p>
                <code class="function">getCatalogs()</code>
              </p></li></ul></div></li></ul></div></div></div></div><div class="appendix" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="connector-j-third-party-licenses"></a>Appendix B. Licenses for Third-Party Components</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#license-ant-contrib">B.1. Ant-Contrib License</a></span></dt><dt><span class="section"><a href="#license-slf4j">B.2. Simple Logging Facade for Java (SLF4J) License</a></span></dt></dl></div><h2><a name="id270913"></a>MySQL Connector/J</h2><div class="itemizedlist"><ul type="disc"><li><p><a href="#license-ant-contrib" title="B.1. Ant-Contrib License">Section B.1, “Ant-Contrib License”</a></p></li><li><p><a href="#license-slf4j" title="B.2. Simple Logging Facade for Java (SLF4J) License">Section B.2, “Simple Logging Facade for Java (SLF4J) License”</a></p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="license-ant-contrib"></a>B.1. Ant-Contrib License</h2></div></div></div><p>
    The following software may be included in this product: Ant-Contrib 
  </p><pre class="programlisting">Ant-Contrib 
Copyright (c) 2001-2003 Ant-Contrib project. All rights reserved. 
Licensed under the Apache 1.1 License Agreement, a copy of which is reproduced below. 

The Apache Software License, Version 1.1 

Copyright (c) 2001-2003 Ant-Contrib project.  All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions
 are met:

 1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer. 

 2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

 3. The end-user documentation included with the redistribution, if
    any, must include the following acknowlegement:  
       "This product includes software developed by the 
        Ant-Contrib project (http://sourceforge.net/projects/ant-contrib)."
    Alternately, this acknowlegement may appear in the software itself,
    if and wherever such third-party acknowlegements normally appear.

 4. The name Ant-Contrib must not be used to endorse or promote
    products derived from this software without prior written
    permission. For written permission, please contact
    ant-contrib-developers@lists.sourceforge.net.

 5. Products derived from this software may not be called "Ant-Contrib"
    nor may "Ant-Contrib" appear in their names without prior written
    permission of the Ant-Contrib project.

 THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
 WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 DISCLAIMED.  IN NO EVENT SHALL THE ANT-CONTRIB PROJECT OR ITS
 CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
 USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
 OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 SUCH DAMAGE.
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="license-slf4j"></a>B.2. Simple Logging Facade for Java (SLF4J) License</h2></div></div></div><p>
    The following software may be included in this product:
  </p><pre class="programlisting">Simple Logging Facade for Java (SLF4J) 

Copyright (c) 2004-2008 QOS.ch 
All rights reserved. 

Permission is hereby granted, free of charge, 
to any person obtaining a copy of this software 
and associated documentation files (the "Software"), 
to deal in the Software without restriction, including 
without limitation the rights to use, copy, modify, 
merge, publish, distribute, sublicense, and/or sell 
copies of the Software, and to permit persons to whom 
the Software is furnished to do so, subject to the 
following conditions: 

The above copyright notice and this permission notice 
shall be included in all copies or substantial portions 
of the Software. 

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY 
OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT 
LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS 
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO 
EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE 
FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE 
OR OTHER DEALINGS IN THE SOFTWARE.
</pre></div></div></div></body></html>
